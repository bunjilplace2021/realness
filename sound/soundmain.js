/*! For license information please see soundmain.js.LICENSE.txt */
(()=>{var t,e,n={228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},858:t=>{t.exports=function(t){if(Array.isArray(t))return t}},575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}},884:t=>{t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n}}},521:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},38:(t,e,n)=>{var r=n(858),i=n(884),s=n(379),o=n(521);t.exports=function(t,e){return r(t)||i(t,e)||s(t,e)||o()}},379:(t,e,n)=>{var r=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},382:function(t,e,n){!function(t,e,n,r){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var s=i(e),o=i(n),a=i(r),u=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},c=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var r=n.startTime,i=n.target,s=n.timeConstant;return i+(e-i)*Math.exp((r-t)/s)},f=function(t){return"exponentialRampToValue"===t.type},d=function(t){return"linearRampToValue"===t.type},_=function(t){return f(t)||d(t)},m=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,r,i){var s=e[n];return void 0===s?i:_(s)||m(s)?s.value:g(s)?s.values[s.values.length-1]:p(r,t(e,n-1,s.startTime,i),s)},y=function(t,e,n,r,i){return void 0===n?[r.insertTime,i]:_(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,i)]},w=function(t){return"cancelAndHold"===t.type},b=function(t){return"cancelScheduledValues"===t.type},x=function(t){return w(t)||b(t)?t.cancelTime:f(t)||d(t)?t.endTime:t.startTime},T=function(t,e,n,r){var i=r.endTime,s=r.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(i-e)):0},k=function(t,e,n,r){return n+(t-e)/(r.endTime-e)*(r.value-n)},C=function(t,e){var n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},S=function(t,e){var n=e.duration,r=e.startTime,i=e.values,s=(t-r)/n*(i.length-1);return C(i,s)},A=function(t){return"setTarget"===t.type},O=function(){function t(e){o.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=x(t);if(w(t)||b(t)){var n=this._automationEvents.findIndex((function(n){return b(t)&&g(n)?n.startTime+n.duration>=e:x(n)>=e})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),w(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&_(r)){if(A(i))throw new Error("The internal list is malformed.");var s=g(i)?i.startTime+i.duration:x(i),o=g(i)?i.values[i.values.length-1]:i.value,a=f(r)?T(e,s,o,r):k(e,s,o,r),p=f(r)?u(a,e,this._currenTime):c(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==i&&A(i)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==i&&g(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return x(t)>e})),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&x(v)+v.duration>e)return!1;var y=f(t)?u(t.value,t.endTime,this._currenTime):d(t)?c(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>x(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return x(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),r=n[0];A(r)&&n.unshift(l(v(this._automationEvents,e-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(e){return x(e)>t})),r=this._automationEvents[n],i=x(e)<=t?e:this._automationEvents[n-1];if(void 0!==i&&A(i)&&(void 0===r||!_(r)||r.insertTime>t))return p(t,v(this._automationEvents,n-2,i.startTime,this._defaultValue),i);if(void 0!==i&&m(i)&&(void 0===r||!_(r)))return i.value;if(void 0!==i&&g(i)&&(void 0===r||!_(r)||i.startTime+i.duration>t))return t<i.startTime+i.duration?S(t,i):i.values[i.values.length-1];if(void 0!==i&&_(i)&&(void 0===r||!_(r)))return i.value;if(void 0!==r&&f(r)){var o=y(this._automationEvents,n-1,i,r,this._defaultValue),a=s.default(o,2),u=a[0],c=a[1];return T(t,u,c,r)}if(void 0!==r&&d(r)){var l=y(this._automationEvents,n-1,i,r,this._defaultValue),h=s.default(l,2),w=h[0],b=h[1];return k(t,w,b,r)}return this._defaultValue}}]),t}(),E=function(t){return{cancelTime:t,type:"cancelAndHold"}},R=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},D=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},M=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},I=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=O,t.createCancelAndHoldAutomationEvent=E,t.createCancelScheduledValuesAutomationEvent=R,t.createExponentialRampToValueAutomationEvent=D,t.createLinearRampToValueAutomationEvent=M,t.createSetTargetAutomationEvent=I,t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(38),n(575),n(913))},486:function(t,e,n){var r;t=n.nmd(t),function(){var i,s="Expected a function",o="__lodash_hash_undefined__",a="__lodash_placeholder__",u=16,c=32,l=64,h=128,p=256,f=1/0,d=9007199254740991,_=NaN,m=4294967295,g=[["ary",h],["bind",1],["bindKey",2],["curry",8],["curryRight",u],["flip",512],["partial",c],["partialRight",l],["rearg",p]],v="[object Arguments]",y="[object Array]",w="[object Boolean]",b="[object Date]",x="[object Error]",T="[object Function]",k="[object GeneratorFunction]",C="[object Map]",S="[object Number]",A="[object Object]",O="[object Promise]",E="[object RegExp]",R="[object Set]",D="[object String]",M="[object Symbol]",I="[object WeakMap]",P="[object ArrayBuffer]",N="[object DataView]",V="[object Float32Array]",q="[object Float64Array]",j="[object Int8Array]",L="[object Int16Array]",F="[object Int32Array]",B="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",W="[object Uint32Array]",G=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,Z=/[&<>"']/g,Y=RegExp(X.source),Q=RegExp(Z.source),K=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,tt=/<%=([\s\S]+?)%>/g,et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nt=/^\w*$/,rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/[\\^$.*+?()[\]{}|]/g,st=RegExp(it.source),ot=/^\s+|\s+$/g,at=/^\s+/,ut=/\s+$/,ct=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,ht=/,? & /,pt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ft=/\\(\\)?/g,dt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_t=/\w*$/,mt=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,vt=/^\[object .+?Constructor\]$/,yt=/^0o[0-7]+$/i,wt=/^(?:0|[1-9]\d*)$/,bt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xt=/($^)/,Tt=/['\n\r\u2028\u2029\\]/g,kt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ct="\\u2700-\\u27bf",St="a-z\\xdf-\\xf6\\xf8-\\xff",At="A-Z\\xc0-\\xd6\\xd8-\\xde",Ot="\\ufe0e\\ufe0f",Et="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Rt="['’]",Dt="[\\ud800-\\udfff]",Mt="["+Et+"]",It="["+kt+"]",Pt="\\d+",Nt="[\\u2700-\\u27bf]",Vt="["+St+"]",qt="[^\\ud800-\\udfff"+Et+Pt+Ct+St+At+"]",jt="\\ud83c[\\udffb-\\udfff]",Lt="[^\\ud800-\\udfff]",Ft="(?:\\ud83c[\\udde6-\\uddff]){2}",Bt="[\\ud800-\\udbff][\\udc00-\\udfff]",Ut="["+At+"]",zt="(?:"+Vt+"|"+qt+")",Wt="(?:"+Ut+"|"+qt+")",Gt="(?:['’](?:d|ll|m|re|s|t|ve))?",Ht="(?:['’](?:D|LL|M|RE|S|T|VE))?",$t="(?:"+It+"|"+jt+")"+"?",Xt="[\\ufe0e\\ufe0f]?",Zt=Xt+$t+("(?:\\u200d(?:"+[Lt,Ft,Bt].join("|")+")"+Xt+$t+")*"),Yt="(?:"+[Nt,Ft,Bt].join("|")+")"+Zt,Qt="(?:"+[Lt+It+"?",It,Ft,Bt,Dt].join("|")+")",Kt=RegExp(Rt,"g"),Jt=RegExp(It,"g"),te=RegExp(jt+"(?="+jt+")|"+Qt+Zt,"g"),ee=RegExp([Ut+"?"+Vt+"+"+Gt+"(?="+[Mt,Ut,"$"].join("|")+")",Wt+"+"+Ht+"(?="+[Mt,Ut+zt,"$"].join("|")+")",Ut+"?"+zt+"+"+Gt,Ut+"+"+Ht,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pt,Yt].join("|"),"g"),ne=RegExp("[\\u200d\\ud800-\\udfff"+kt+Ot+"]"),re=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],se=-1,oe={};oe[V]=oe[q]=oe[j]=oe[L]=oe[F]=oe[B]=oe[U]=oe[z]=oe[W]=!0,oe[v]=oe[y]=oe[P]=oe[w]=oe[N]=oe[b]=oe[x]=oe[T]=oe[C]=oe[S]=oe[A]=oe[E]=oe[R]=oe[D]=oe[I]=!1;var ae={};ae[v]=ae[y]=ae[P]=ae[N]=ae[w]=ae[b]=ae[V]=ae[q]=ae[j]=ae[L]=ae[F]=ae[C]=ae[S]=ae[A]=ae[E]=ae[R]=ae[D]=ae[M]=ae[B]=ae[U]=ae[z]=ae[W]=!0,ae[x]=ae[T]=ae[I]=!1;var ue={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ce=parseFloat,le=parseInt,he="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,pe="object"==typeof self&&self&&self.Object===Object&&self,fe=he||pe||Function("return this")(),de=e&&!e.nodeType&&e,_e=de&&t&&!t.nodeType&&t,me=_e&&_e.exports===de,ge=me&&he.process,ve=function(){try{var t=_e&&_e.require&&_e.require("util").types;return t||ge&&ge.binding&&ge.binding("util")}catch(t){}}(),ye=ve&&ve.isArrayBuffer,we=ve&&ve.isDate,be=ve&&ve.isMap,xe=ve&&ve.isRegExp,Te=ve&&ve.isSet,ke=ve&&ve.isTypedArray;function Ce(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Se(t,e,n,r){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(r,o,n(o),t)}return r}function Ae(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Oe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ee(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Re(t,e){for(var n=-1,r=null==t?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}function De(t,e){return!!(null==t?0:t.length)&&Be(t,e,0)>-1}function Me(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Ie(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Ne(t,e,n,r){var i=-1,s=null==t?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function Ve(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function qe(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var je=Ge("length");function Le(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function Fe(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function Be(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Fe(t,ze,n)}function Ue(t,e,n,r){for(var i=n-1,s=t.length;++i<s;)if(r(t[i],e))return i;return-1}function ze(t){return t!=t}function We(t,e){var n=null==t?0:t.length;return n?Xe(t,e)/n:_}function Ge(t){return function(e){return null==e?i:e[t]}}function He(t){return function(e){return null==t?i:t[e]}}function $e(t,e,n,r,i){return i(t,(function(t,i,s){n=r?(r=!1,t):e(n,t,i,s)})),n}function Xe(t,e){for(var n,r=-1,s=t.length;++r<s;){var o=e(t[r]);o!==i&&(n=n===i?o:n+o)}return n}function Ze(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ye(t){return function(e){return t(e)}}function Qe(t,e){return Ie(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Je(t,e){for(var n=-1,r=t.length;++n<r&&Be(e,t[n],0)>-1;);return n}function tn(t,e){for(var n=t.length;n--&&Be(e,t[n],0)>-1;);return n}function en(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var nn=He({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),rn=He({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function sn(t){return"\\"+ue[t]}function on(t){return ne.test(t)}function an(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function un(t,e){return function(n){return t(e(n))}}function cn(t,e){for(var n=-1,r=t.length,i=0,s=[];++n<r;){var o=t[n];o!==e&&o!==a||(t[n]=a,s[i++]=n)}return s}function ln(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function hn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function pn(t){return on(t)?function(t){var e=te.lastIndex=0;for(;te.test(t);)++e;return e}(t):je(t)}function fn(t){return on(t)?function(t){return t.match(te)||[]}(t):function(t){return t.split("")}(t)}var dn=He({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var _n=function t(e){var n,r=(e=null==e?fe:_n.defaults(fe.Object(),e,_n.pick(fe,ie))).Array,kt=e.Date,Ct=e.Error,St=e.Function,At=e.Math,Ot=e.Object,Et=e.RegExp,Rt=e.String,Dt=e.TypeError,Mt=r.prototype,It=St.prototype,Pt=Ot.prototype,Nt=e["__core-js_shared__"],Vt=It.toString,qt=Pt.hasOwnProperty,jt=0,Lt=(n=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Ft=Pt.toString,Bt=Vt.call(Ot),Ut=fe._,zt=Et("^"+Vt.call(qt).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=me?e.Buffer:i,Gt=e.Symbol,Ht=e.Uint8Array,$t=Wt?Wt.allocUnsafe:i,Xt=un(Ot.getPrototypeOf,Ot),Zt=Ot.create,Yt=Pt.propertyIsEnumerable,Qt=Mt.splice,te=Gt?Gt.isConcatSpreadable:i,ne=Gt?Gt.iterator:i,ue=Gt?Gt.toStringTag:i,he=function(){try{var t=ps(Ot,"defineProperty");return t({},"",{}),t}catch(t){}}(),pe=e.clearTimeout!==fe.clearTimeout&&e.clearTimeout,de=kt&&kt.now!==fe.Date.now&&kt.now,_e=e.setTimeout!==fe.setTimeout&&e.setTimeout,ge=At.ceil,ve=At.floor,je=Ot.getOwnPropertySymbols,He=Wt?Wt.isBuffer:i,mn=e.isFinite,gn=Mt.join,vn=un(Ot.keys,Ot),yn=At.max,wn=At.min,bn=kt.now,xn=e.parseInt,Tn=At.random,kn=Mt.reverse,Cn=ps(e,"DataView"),Sn=ps(e,"Map"),An=ps(e,"Promise"),On=ps(e,"Set"),En=ps(e,"WeakMap"),Rn=ps(Ot,"create"),Dn=En&&new En,Mn={},In=Ls(Cn),Pn=Ls(Sn),Nn=Ls(An),Vn=Ls(On),qn=Ls(En),jn=Gt?Gt.prototype:i,Ln=jn?jn.valueOf:i,Fn=jn?jn.toString:i;function Bn(t){if(ra(t)&&!Ho(t)&&!(t instanceof Gn)){if(t instanceof Wn)return t;if(qt.call(t,"__wrapped__"))return Fs(t)}return new Wn(t)}var Un=function(){function t(){}return function(e){if(!na(e))return{};if(Zt)return Zt(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function zn(){}function Wn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Gn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=m,this.__views__=[]}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Zn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Xn;++e<n;)this.add(t[e])}function Yn(t){var e=this.__data__=new $n(t);this.size=e.size}function Qn(t,e){var n=Ho(t),r=!n&&Go(t),i=!n&&!r&&Yo(t),s=!n&&!r&&!i&&ha(t),o=n||r||i||s,a=o?Ze(t.length,Rt):[],u=a.length;for(var c in t)!e&&!qt.call(t,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ys(c,u))||a.push(c);return a}function Kn(t){var e=t.length;return e?t[Zr(0,e-1)]:i}function Jn(t,e){return Vs(Ri(t),ur(e,0,t.length))}function tr(t){return Vs(Ri(t))}function er(t,e,n){(n!==i&&!Uo(t[e],n)||n===i&&!(e in t))&&or(t,e,n)}function nr(t,e,n){var r=t[e];qt.call(t,e)&&Uo(r,n)&&(n!==i||e in t)||or(t,e,n)}function rr(t,e){for(var n=t.length;n--;)if(Uo(t[n][0],e))return n;return-1}function ir(t,e,n,r){return fr(t,(function(t,i,s){e(r,t,n(t),s)})),r}function sr(t,e){return t&&Di(e,Ia(e),t)}function or(t,e,n){"__proto__"==e&&he?he(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ar(t,e){for(var n=-1,s=e.length,o=r(s),a=null==t;++n<s;)o[n]=a?i:Oa(t,e[n]);return o}function ur(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function cr(t,e,n,r,s,o){var a,u=1&e,c=2&e,l=4&e;if(n&&(a=s?n(t,r,s,o):n(t)),a!==i)return a;if(!na(t))return t;var h=Ho(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&qt.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!u)return Ri(t,a)}else{var p=_s(t),f=p==T||p==k;if(Yo(t))return ki(t,u);if(p==A||p==v||f&&!s){if(a=c||f?{}:gs(t),!u)return c?function(t,e){return Di(t,ds(t),e)}(t,function(t,e){return t&&Di(e,Pa(e),t)}(a,t)):function(t,e){return Di(t,fs(t),e)}(t,sr(a,t))}else{if(!ae[p])return s?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case P:return Ci(t);case w:case b:return new r(+t);case N:return function(t,e){var n=e?Ci(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case V:case q:case j:case L:case F:case B:case U:case z:case W:return Si(t,n);case C:return new r;case S:case D:return new r(t);case E:return function(t){var e=new t.constructor(t.source,_t.exec(t));return e.lastIndex=t.lastIndex,e}(t);case R:return new r;case M:return i=t,Ln?Ot(Ln.call(i)):{}}var i}(t,p,u)}}o||(o=new Yn);var d=o.get(t);if(d)return d;o.set(t,a),ua(t)?t.forEach((function(r){a.add(cr(r,e,n,r,t,o))})):ia(t)&&t.forEach((function(r,i){a.set(i,cr(r,e,n,i,t,o))}));var _=h?i:(l?c?ss:is:c?Pa:Ia)(t);return Ae(_||t,(function(r,i){_&&(r=t[i=r]),nr(a,i,cr(r,e,n,i,t,o))})),a}function lr(t,e,n){var r=n.length;if(null==t)return!r;for(t=Ot(t);r--;){var s=n[r],o=e[s],a=t[s];if(a===i&&!(s in t)||!o(a))return!1}return!0}function hr(t,e,n){if("function"!=typeof t)throw new Dt(s);return Ms((function(){t.apply(i,n)}),e)}function pr(t,e,n,r){var i=-1,s=De,o=!0,a=t.length,u=[],c=e.length;if(!a)return u;n&&(e=Ie(e,Ye(n))),r?(s=Me,o=!1):e.length>=200&&(s=Ke,o=!1,e=new Zn(e));t:for(;++i<a;){var l=t[i],h=null==n?l:n(l);if(l=r||0!==l?l:0,o&&h==h){for(var p=c;p--;)if(e[p]===h)continue t;u.push(l)}else s(e,h,r)||u.push(l)}return u}Bn.templateSettings={escape:K,evaluate:J,interpolate:tt,variable:"",imports:{_:Bn}},Bn.prototype=zn.prototype,Bn.prototype.constructor=Bn,Wn.prototype=Un(zn.prototype),Wn.prototype.constructor=Wn,Gn.prototype=Un(zn.prototype),Gn.prototype.constructor=Gn,Hn.prototype.clear=function(){this.__data__=Rn?Rn(null):{},this.size=0},Hn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Hn.prototype.get=function(t){var e=this.__data__;if(Rn){var n=e[t];return n===o?i:n}return qt.call(e,t)?e[t]:i},Hn.prototype.has=function(t){var e=this.__data__;return Rn?e[t]!==i:qt.call(e,t)},Hn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Rn&&e===i?o:e,this},$n.prototype.clear=function(){this.__data__=[],this.size=0},$n.prototype.delete=function(t){var e=this.__data__,n=rr(e,t);return!(n<0)&&(n==e.length-1?e.pop():Qt.call(e,n,1),--this.size,!0)},$n.prototype.get=function(t){var e=this.__data__,n=rr(e,t);return n<0?i:e[n][1]},$n.prototype.has=function(t){return rr(this.__data__,t)>-1},$n.prototype.set=function(t,e){var n=this.__data__,r=rr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(Sn||$n),string:new Hn}},Xn.prototype.delete=function(t){var e=ls(this,t).delete(t);return this.size-=e?1:0,e},Xn.prototype.get=function(t){return ls(this,t).get(t)},Xn.prototype.has=function(t){return ls(this,t).has(t)},Xn.prototype.set=function(t,e){var n=ls(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Zn.prototype.add=Zn.prototype.push=function(t){return this.__data__.set(t,o),this},Zn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.clear=function(){this.__data__=new $n,this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Yn.prototype.get=function(t){return this.__data__.get(t)},Yn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof $n){var r=n.__data__;if(!Sn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Xn(r)}return n.set(t,e),this.size=n.size,this};var fr=Pi(br),dr=Pi(xr,!0);function _r(t,e){var n=!0;return fr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function mr(t,e,n){for(var r=-1,s=t.length;++r<s;){var o=t[r],a=e(o);if(null!=a&&(u===i?a==a&&!la(a):n(a,u)))var u=a,c=o}return c}function gr(t,e){var n=[];return fr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function vr(t,e,n,r,i){var s=-1,o=t.length;for(n||(n=vs),i||(i=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?vr(a,e-1,n,r,i):Pe(i,a):r||(i[i.length]=a)}return i}var yr=Ni(),wr=Ni(!0);function br(t,e){return t&&yr(t,e,Ia)}function xr(t,e){return t&&wr(t,e,Ia)}function Tr(t,e){return Re(e,(function(e){return Jo(t[e])}))}function kr(t,e){for(var n=0,r=(e=wi(e,t)).length;null!=t&&n<r;)t=t[js(e[n++])];return n&&n==r?t:i}function Cr(t,e,n){var r=e(t);return Ho(t)?r:Pe(r,n(t))}function Sr(t){return null==t?t===i?"[object Undefined]":"[object Null]":ue&&ue in Ot(t)?function(t){var e=qt.call(t,ue),n=t[ue];try{t[ue]=i;var r=!0}catch(t){}var s=Ft.call(t);r&&(e?t[ue]=n:delete t[ue]);return s}(t):function(t){return Ft.call(t)}(t)}function Ar(t,e){return t>e}function Or(t,e){return null!=t&&qt.call(t,e)}function Er(t,e){return null!=t&&e in Ot(t)}function Rr(t,e,n){for(var s=n?Me:De,o=t[0].length,a=t.length,u=a,c=r(a),l=1/0,h=[];u--;){var p=t[u];u&&e&&(p=Ie(p,Ye(e))),l=wn(p.length,l),c[u]=!n&&(e||o>=120&&p.length>=120)?new Zn(u&&p):i}p=t[0];var f=-1,d=c[0];t:for(;++f<o&&h.length<l;){var _=p[f],m=e?e(_):_;if(_=n||0!==_?_:0,!(d?Ke(d,m):s(h,m,n))){for(u=a;--u;){var g=c[u];if(!(g?Ke(g,m):s(t[u],m,n)))continue t}d&&d.push(m),h.push(_)}}return h}function Dr(t,e,n){var r=null==(t=Os(t,e=wi(e,t)))?t:t[js(Qs(e))];return null==r?i:Ce(r,t,n)}function Mr(t){return ra(t)&&Sr(t)==v}function Ir(t,e,n,r,s){return t===e||(null==t||null==e||!ra(t)&&!ra(e)?t!=t&&e!=e:function(t,e,n,r,s,o){var a=Ho(t),u=Ho(e),c=a?y:_s(t),l=u?y:_s(e),h=(c=c==v?A:c)==A,p=(l=l==v?A:l)==A,f=c==l;if(f&&Yo(t)){if(!Yo(e))return!1;a=!0,h=!1}if(f&&!h)return o||(o=new Yn),a||ha(t)?ns(t,e,n,r,s,o):function(t,e,n,r,i,s,o){switch(n){case N:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case P:return!(t.byteLength!=e.byteLength||!s(new Ht(t),new Ht(e)));case w:case b:case S:return Uo(+t,+e);case x:return t.name==e.name&&t.message==e.message;case E:case D:return t==e+"";case C:var a=an;case R:var u=1&r;if(a||(a=ln),t.size!=e.size&&!u)return!1;var c=o.get(t);if(c)return c==e;r|=2,o.set(t,e);var l=ns(a(t),a(e),r,i,s,o);return o.delete(t),l;case M:if(Ln)return Ln.call(t)==Ln.call(e)}return!1}(t,e,c,n,r,s,o);if(!(1&n)){var d=h&&qt.call(t,"__wrapped__"),_=p&&qt.call(e,"__wrapped__");if(d||_){var m=d?t.value():t,g=_?e.value():e;return o||(o=new Yn),s(m,g,n,r,o)}}if(!f)return!1;return o||(o=new Yn),function(t,e,n,r,s,o){var a=1&n,u=is(t),c=u.length,l=is(e).length;if(c!=l&&!a)return!1;var h=c;for(;h--;){var p=u[h];if(!(a?p in e:qt.call(e,p)))return!1}var f=o.get(t),d=o.get(e);if(f&&d)return f==e&&d==t;var _=!0;o.set(t,e),o.set(e,t);var m=a;for(;++h<c;){var g=t[p=u[h]],v=e[p];if(r)var y=a?r(v,g,p,e,t,o):r(g,v,p,t,e,o);if(!(y===i?g===v||s(g,v,n,r,o):y)){_=!1;break}m||(m="constructor"==p)}if(_&&!m){var w=t.constructor,b=e.constructor;w==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(_=!1)}return o.delete(t),o.delete(e),_}(t,e,n,r,s,o)}(t,e,n,r,Ir,s))}function Pr(t,e,n,r){var s=n.length,o=s,a=!r;if(null==t)return!o;for(t=Ot(t);s--;){var u=n[s];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++s<o;){var c=(u=n[s])[0],l=t[c],h=u[1];if(a&&u[2]){if(l===i&&!(c in t))return!1}else{var p=new Yn;if(r)var f=r(l,h,c,t,e,p);if(!(f===i?Ir(h,l,3,r,p):f))return!1}}return!0}function Nr(t){return!(!na(t)||(e=t,Lt&&Lt in e))&&(Jo(t)?zt:vt).test(Ls(t));var e}function Vr(t){return"function"==typeof t?t:null==t?su:"object"==typeof t?Ho(t)?Ur(t[0],t[1]):Br(t):du(t)}function qr(t){if(!ks(t))return vn(t);var e=[];for(var n in Ot(t))qt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function jr(t){if(!na(t))return function(t){var e=[];if(null!=t)for(var n in Ot(t))e.push(n);return e}(t);var e=ks(t),n=[];for(var r in t)("constructor"!=r||!e&&qt.call(t,r))&&n.push(r);return n}function Lr(t,e){return t<e}function Fr(t,e){var n=-1,i=Xo(t)?r(t.length):[];return fr(t,(function(t,r,s){i[++n]=e(t,r,s)})),i}function Br(t){var e=hs(t);return 1==e.length&&e[0][2]?Ss(e[0][0],e[0][1]):function(n){return n===t||Pr(n,t,e)}}function Ur(t,e){return bs(t)&&Cs(e)?Ss(js(t),e):function(n){var r=Oa(n,t);return r===i&&r===e?Ea(n,t):Ir(e,r,3)}}function zr(t,e,n,r,s){t!==e&&yr(e,(function(o,a){if(s||(s=new Yn),na(o))!function(t,e,n,r,s,o,a){var u=Rs(t,n),c=Rs(e,n),l=a.get(c);if(l)return void er(t,n,l);var h=o?o(u,c,n+"",t,e,a):i,p=h===i;if(p){var f=Ho(c),d=!f&&Yo(c),_=!f&&!d&&ha(c);h=c,f||d||_?Ho(u)?h=u:Zo(u)?h=Ri(u):d?(p=!1,h=ki(c,!0)):_?(p=!1,h=Si(c,!0)):h=[]:oa(c)||Go(c)?(h=u,Go(u)?h=ya(u):na(u)&&!Jo(u)||(h=gs(c))):p=!1}p&&(a.set(c,h),s(h,c,r,o,a),a.delete(c));er(t,n,h)}(t,e,a,n,zr,r,s);else{var u=r?r(Rs(t,a),o,a+"",t,e,s):i;u===i&&(u=o),er(t,a,u)}}),Pa)}function Wr(t,e){var n=t.length;if(n)return ys(e+=e<0?n:0,n)?t[e]:i}function Gr(t,e,n){e=e.length?Ie(e,(function(t){return Ho(t)?function(e){return kr(e,1===t.length?t[0]:t)}:t})):[su];var r=-1;return e=Ie(e,Ye(cs())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Fr(t,(function(t,n,i){return{criteria:Ie(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,s=e.criteria,o=i.length,a=n.length;for(;++r<o;){var u=Ai(i[r],s[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}))}function Hr(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var o=e[r],a=kr(t,o);n(a,o)&&ti(s,wi(o,t),a)}return s}function $r(t,e,n,r){var i=r?Ue:Be,s=-1,o=e.length,a=t;for(t===e&&(e=Ri(e)),n&&(a=Ie(t,Ye(n)));++s<o;)for(var u=0,c=e[s],l=n?n(c):c;(u=i(a,l,u,r))>-1;)a!==t&&Qt.call(a,u,1),Qt.call(t,u,1);return t}function Xr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==s){var s=i;ys(i)?Qt.call(t,i,1):pi(t,i)}}return t}function Zr(t,e){return t+ve(Tn()*(e-t+1))}function Yr(t,e){var n="";if(!t||e<1||e>d)return n;do{e%2&&(n+=t),(e=ve(e/2))&&(t+=t)}while(e);return n}function Qr(t,e){return Is(As(t,e,su),t+"")}function Kr(t){return Kn(Ua(t))}function Jr(t,e){var n=Ua(t);return Vs(n,ur(e,0,n.length))}function ti(t,e,n,r){if(!na(t))return t;for(var s=-1,o=(e=wi(e,t)).length,a=o-1,u=t;null!=u&&++s<o;){var c=js(e[s]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(s!=a){var h=u[c];(l=r?r(h,c,u):i)===i&&(l=na(h)?h:ys(e[s+1])?[]:{})}nr(u,c,l),u=u[c]}return t}var ei=Dn?function(t,e){return Dn.set(t,e),t}:su,ni=he?function(t,e){return he(t,"toString",{configurable:!0,enumerable:!1,value:nu(e),writable:!0})}:su;function ri(t){return Vs(Ua(t))}function ii(t,e,n){var i=-1,s=t.length;e<0&&(e=-e>s?0:s+e),(n=n>s?s:n)<0&&(n+=s),s=e>n?0:n-e>>>0,e>>>=0;for(var o=r(s);++i<s;)o[i]=t[i+e];return o}function si(t,e){var n;return fr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function oi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var s=r+i>>>1,o=t[s];null!==o&&!la(o)&&(n?o<=e:o<e)?r=s+1:i=s}return i}return ai(t,e,su,n)}function ai(t,e,n,r){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=n(e))!=e,u=null===e,c=la(e),l=e===i;s<o;){var h=ve((s+o)/2),p=n(t[h]),f=p!==i,d=null===p,_=p==p,m=la(p);if(a)var g=r||_;else g=l?_&&(r||f):u?_&&f&&(r||!d):c?_&&f&&!d&&(r||!m):!d&&!m&&(r?p<=e:p<e);g?s=h+1:o=h}return wn(o,4294967294)}function ui(t,e){for(var n=-1,r=t.length,i=0,s=[];++n<r;){var o=t[n],a=e?e(o):o;if(!n||!Uo(a,u)){var u=a;s[i++]=0===o?0:o}}return s}function ci(t){return"number"==typeof t?t:la(t)?_:+t}function li(t){if("string"==typeof t)return t;if(Ho(t))return Ie(t,li)+"";if(la(t))return Fn?Fn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function hi(t,e,n){var r=-1,i=De,s=t.length,o=!0,a=[],u=a;if(n)o=!1,i=Me;else if(s>=200){var c=e?null:Yi(t);if(c)return ln(c);o=!1,i=Ke,u=new Zn}else u=e?[]:a;t:for(;++r<s;){var l=t[r],h=e?e(l):l;if(l=n||0!==l?l:0,o&&h==h){for(var p=u.length;p--;)if(u[p]===h)continue t;e&&u.push(h),a.push(l)}else i(u,h,n)||(u!==a&&u.push(h),a.push(l))}return a}function pi(t,e){return null==(t=Os(t,e=wi(e,t)))||delete t[js(Qs(e))]}function fi(t,e,n,r){return ti(t,e,n(kr(t,e)),r)}function di(t,e,n,r){for(var i=t.length,s=r?i:-1;(r?s--:++s<i)&&e(t[s],s,t););return n?ii(t,r?0:s,r?s+1:i):ii(t,r?s+1:0,r?i:s)}function _i(t,e){var n=t;return n instanceof Gn&&(n=n.value()),Ne(e,(function(t,e){return e.func.apply(e.thisArg,Pe([t],e.args))}),n)}function mi(t,e,n){var i=t.length;if(i<2)return i?hi(t[0]):[];for(var s=-1,o=r(i);++s<i;)for(var a=t[s],u=-1;++u<i;)u!=s&&(o[s]=pr(o[s]||a,t[u],e,n));return hi(vr(o,1),e,n)}function gi(t,e,n){for(var r=-1,s=t.length,o=e.length,a={};++r<s;){var u=r<o?e[r]:i;n(a,t[r],u)}return a}function vi(t){return Zo(t)?t:[]}function yi(t){return"function"==typeof t?t:su}function wi(t,e){return Ho(t)?t:bs(t,e)?[t]:qs(wa(t))}var bi=Qr;function xi(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:ii(t,e,n)}var Ti=pe||function(t){return fe.clearTimeout(t)};function ki(t,e){if(e)return t.slice();var n=t.length,r=$t?$t(n):new t.constructor(n);return t.copy(r),r}function Ci(t){var e=new t.constructor(t.byteLength);return new Ht(e).set(new Ht(t)),e}function Si(t,e){var n=e?Ci(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ai(t,e){if(t!==e){var n=t!==i,r=null===t,s=t==t,o=la(t),a=e!==i,u=null===e,c=e==e,l=la(e);if(!u&&!l&&!o&&t>e||o&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!s)return 1;if(!r&&!o&&!l&&t<e||l&&n&&s&&!r&&!o||u&&n&&s||!a&&s||!c)return-1}return 0}function Oi(t,e,n,i){for(var s=-1,o=t.length,a=n.length,u=-1,c=e.length,l=yn(o-a,0),h=r(c+l),p=!i;++u<c;)h[u]=e[u];for(;++s<a;)(p||s<o)&&(h[n[s]]=t[s]);for(;l--;)h[u++]=t[s++];return h}function Ei(t,e,n,i){for(var s=-1,o=t.length,a=-1,u=n.length,c=-1,l=e.length,h=yn(o-u,0),p=r(h+l),f=!i;++s<h;)p[s]=t[s];for(var d=s;++c<l;)p[d+c]=e[c];for(;++a<u;)(f||s<o)&&(p[d+n[a]]=t[s++]);return p}function Ri(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function Di(t,e,n,r){var s=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],c=r?r(n[u],t[u],u,n,t):i;c===i&&(c=t[u]),s?or(n,u,c):nr(n,u,c)}return n}function Mi(t,e){return function(n,r){var i=Ho(n)?Se:ir,s=e?e():{};return i(n,t,cs(r,2),s)}}function Ii(t){return Qr((function(e,n){var r=-1,s=n.length,o=s>1?n[s-1]:i,a=s>2?n[2]:i;for(o=t.length>3&&"function"==typeof o?(s--,o):i,a&&ws(n[0],n[1],a)&&(o=s<3?i:o,s=1),e=Ot(e);++r<s;){var u=n[r];u&&t(e,u,r,o)}return e}))}function Pi(t,e){return function(n,r){if(null==n)return n;if(!Xo(n))return t(n,r);for(var i=n.length,s=e?i:-1,o=Ot(n);(e?s--:++s<i)&&!1!==r(o[s],s,o););return n}}function Ni(t){return function(e,n,r){for(var i=-1,s=Ot(e),o=r(e),a=o.length;a--;){var u=o[t?a:++i];if(!1===n(s[u],u,s))break}return e}}function Vi(t){return function(e){var n=on(e=wa(e))?fn(e):i,r=n?n[0]:e.charAt(0),s=n?xi(n,1).join(""):e.slice(1);return r[t]()+s}}function qi(t){return function(e){return Ne(Ja(Ga(e).replace(Kt,"")),t,"")}}function ji(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Un(t.prototype),r=t.apply(n,e);return na(r)?r:n}}function Li(t){return function(e,n,r){var s=Ot(e);if(!Xo(e)){var o=cs(n,3);e=Ia(e),n=function(t){return o(s[t],t,s)}}var a=t(e,n,r);return a>-1?s[o?e[a]:a]:i}}function Fi(t){return rs((function(e){var n=e.length,r=n,o=Wn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Dt(s);if(o&&!u&&"wrapper"==as(a))var u=new Wn([],!0)}for(r=u?r:n;++r<n;){var c=as(a=e[r]),l="wrapper"==c?os(a):i;u=l&&xs(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[as(l[0])].apply(u,l[3]):1==a.length&&xs(a)?u[c]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Ho(r))return u.plant(r).value();for(var i=0,s=n?e[i].apply(this,t):r;++i<n;)s=e[i].call(this,s);return s}}))}function Bi(t,e,n,s,o,a,u,c,l,p){var f=e&h,d=1&e,_=2&e,m=24&e,g=512&e,v=_?i:ji(t);return function i(){for(var h=arguments.length,y=r(h),w=h;w--;)y[w]=arguments[w];if(m)var b=us(i),x=en(y,b);if(s&&(y=Oi(y,s,o,m)),a&&(y=Ei(y,a,u,m)),h-=x,m&&h<p){var T=cn(y,b);return Xi(t,e,Bi,i.placeholder,n,y,T,c,l,p-h)}var k=d?n:this,C=_?k[t]:t;return h=y.length,c?y=Es(y,c):g&&h>1&&y.reverse(),f&&l<h&&(y.length=l),this&&this!==fe&&this instanceof i&&(C=v||ji(C)),C.apply(k,y)}}function Ui(t,e){return function(n,r){return function(t,e,n,r){return br(t,(function(t,i,s){e(r,n(t),i,s)})),r}(n,t,e(r),{})}}function zi(t,e){return function(n,r){var s;if(n===i&&r===i)return e;if(n!==i&&(s=n),r!==i){if(s===i)return r;"string"==typeof n||"string"==typeof r?(n=li(n),r=li(r)):(n=ci(n),r=ci(r)),s=t(n,r)}return s}}function Wi(t){return rs((function(e){return e=Ie(e,Ye(cs())),Qr((function(n){var r=this;return t(e,(function(t){return Ce(t,r,n)}))}))}))}function Gi(t,e){var n=(e=e===i?" ":li(e)).length;if(n<2)return n?Yr(e,t):e;var r=Yr(e,ge(t/pn(e)));return on(e)?xi(fn(r),0,t).join(""):r.slice(0,t)}function Hi(t){return function(e,n,s){return s&&"number"!=typeof s&&ws(e,n,s)&&(n=s=i),e=_a(e),n===i?(n=e,e=0):n=_a(n),function(t,e,n,i){for(var s=-1,o=yn(ge((e-t)/(n||1)),0),a=r(o);o--;)a[i?o:++s]=t,t+=n;return a}(e,n,s=s===i?e<n?1:-1:_a(s),t)}}function $i(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=va(e),n=va(n)),t(e,n)}}function Xi(t,e,n,r,s,o,a,u,h,p){var f=8&e;e|=f?c:l,4&(e&=~(f?l:c))||(e&=-4);var d=[t,e,s,f?o:i,f?a:i,f?i:o,f?i:a,u,h,p],_=n.apply(i,d);return xs(t)&&Ds(_,d),_.placeholder=r,Ps(_,t,e)}function Zi(t){var e=At[t];return function(t,n){if(t=va(t),(n=null==n?0:wn(ma(n),292))&&mn(t)){var r=(wa(t)+"e").split("e");return+((r=(wa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Yi=On&&1/ln(new On([,-0]))[1]==f?function(t){return new On(t)}:lu;function Qi(t){return function(e){var n=_s(e);return n==C?an(e):n==R?hn(e):function(t,e){return Ie(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Ki(t,e,n,o,f,d,_,m){var g=2&e;if(!g&&"function"!=typeof t)throw new Dt(s);var v=o?o.length:0;if(v||(e&=-97,o=f=i),_=_===i?_:yn(ma(_),0),m=m===i?m:ma(m),v-=f?f.length:0,e&l){var y=o,w=f;o=f=i}var b=g?i:os(t),x=[t,e,n,o,f,y,w,d,_,m];if(b&&function(t,e){var n=t[1],r=e[1],i=n|r,s=i<131,o=r==h&&8==n||r==h&&n==p&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!s&&!o)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?Oi(c,u,e[4]):u,t[4]=c?cn(t[3],a):e[4]}(u=e[5])&&(c=t[5],t[5]=c?Ei(c,u,e[6]):u,t[6]=c?cn(t[5],a):e[6]);(u=e[7])&&(t[7]=u);r&h&&(t[8]=null==t[8]?e[8]:wn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(x,b),t=x[0],e=x[1],n=x[2],o=x[3],f=x[4],!(m=x[9]=x[9]===i?g?0:t.length:yn(x[9]-v,0))&&24&e&&(e&=-25),e&&1!=e)T=8==e||e==u?function(t,e,n){var s=ji(t);return function o(){for(var a=arguments.length,u=r(a),c=a,l=us(o);c--;)u[c]=arguments[c];var h=a<3&&u[0]!==l&&u[a-1]!==l?[]:cn(u,l);return(a-=h.length)<n?Xi(t,e,Bi,o.placeholder,i,u,h,i,i,n-a):Ce(this&&this!==fe&&this instanceof o?s:t,this,u)}}(t,e,m):e!=c&&33!=e||f.length?Bi.apply(i,x):function(t,e,n,i){var s=1&e,o=ji(t);return function e(){for(var a=-1,u=arguments.length,c=-1,l=i.length,h=r(l+u),p=this&&this!==fe&&this instanceof e?o:t;++c<l;)h[c]=i[c];for(;u--;)h[c++]=arguments[++a];return Ce(p,s?n:this,h)}}(t,e,n,o);else var T=function(t,e,n){var r=1&e,i=ji(t);return function e(){return(this&&this!==fe&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return Ps((b?ei:Ds)(T,x),t,e)}function Ji(t,e,n,r){return t===i||Uo(t,Pt[n])&&!qt.call(r,n)?e:t}function ts(t,e,n,r,s,o){return na(t)&&na(e)&&(o.set(e,t),zr(t,e,i,ts,o),o.delete(e)),t}function es(t){return oa(t)?i:t}function ns(t,e,n,r,s,o){var a=1&n,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var l=o.get(t),h=o.get(e);if(l&&h)return l==e&&h==t;var p=-1,f=!0,d=2&n?new Zn:i;for(o.set(t,e),o.set(e,t);++p<u;){var _=t[p],m=e[p];if(r)var g=a?r(m,_,p,e,t,o):r(_,m,p,t,e,o);if(g!==i){if(g)continue;f=!1;break}if(d){if(!qe(e,(function(t,e){if(!Ke(d,e)&&(_===t||s(_,t,n,r,o)))return d.push(e)}))){f=!1;break}}else if(_!==m&&!s(_,m,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function rs(t){return Is(As(t,i,Hs),t+"")}function is(t){return Cr(t,Ia,fs)}function ss(t){return Cr(t,Pa,ds)}var os=Dn?function(t){return Dn.get(t)}:lu;function as(t){for(var e=t.name+"",n=Mn[e],r=qt.call(Mn,e)?n.length:0;r--;){var i=n[r],s=i.func;if(null==s||s==t)return i.name}return e}function us(t){return(qt.call(Bn,"placeholder")?Bn:t).placeholder}function cs(){var t=Bn.iteratee||ou;return t=t===ou?Vr:t,arguments.length?t(arguments[0],arguments[1]):t}function ls(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function hs(t){for(var e=Ia(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Cs(i)]}return e}function ps(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Nr(n)?n:i}var fs=je?function(t){return null==t?[]:(t=Ot(t),Re(je(t),(function(e){return Yt.call(t,e)})))}:gu,ds=je?function(t){for(var e=[];t;)Pe(e,fs(t)),t=Xt(t);return e}:gu,_s=Sr;function ms(t,e,n){for(var r=-1,i=(e=wi(e,t)).length,s=!1;++r<i;){var o=js(e[r]);if(!(s=null!=t&&n(t,o)))break;t=t[o]}return s||++r!=i?s:!!(i=null==t?0:t.length)&&ea(i)&&ys(o,i)&&(Ho(t)||Go(t))}function gs(t){return"function"!=typeof t.constructor||ks(t)?{}:Un(Xt(t))}function vs(t){return Ho(t)||Go(t)||!!(te&&t&&t[te])}function ys(t,e){var n=typeof t;return!!(e=null==e?d:e)&&("number"==n||"symbol"!=n&&wt.test(t))&&t>-1&&t%1==0&&t<e}function ws(t,e,n){if(!na(n))return!1;var r=typeof e;return!!("number"==r?Xo(n)&&ys(e,n.length):"string"==r&&e in n)&&Uo(n[e],t)}function bs(t,e){if(Ho(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!la(t))||(nt.test(t)||!et.test(t)||null!=e&&t in Ot(e))}function xs(t){var e=as(t),n=Bn[e];if("function"!=typeof n||!(e in Gn.prototype))return!1;if(t===n)return!0;var r=os(n);return!!r&&t===r[0]}(Cn&&_s(new Cn(new ArrayBuffer(1)))!=N||Sn&&_s(new Sn)!=C||An&&_s(An.resolve())!=O||On&&_s(new On)!=R||En&&_s(new En)!=I)&&(_s=function(t){var e=Sr(t),n=e==A?t.constructor:i,r=n?Ls(n):"";if(r)switch(r){case In:return N;case Pn:return C;case Nn:return O;case Vn:return R;case qn:return I}return e});var Ts=Nt?Jo:vu;function ks(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Pt)}function Cs(t){return t==t&&!na(t)}function Ss(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==i||t in Ot(n)))}}function As(t,e,n){return e=yn(e===i?t.length-1:e,0),function(){for(var i=arguments,s=-1,o=yn(i.length-e,0),a=r(o);++s<o;)a[s]=i[e+s];s=-1;for(var u=r(e+1);++s<e;)u[s]=i[s];return u[e]=n(a),Ce(t,this,u)}}function Os(t,e){return e.length<2?t:kr(t,ii(e,0,-1))}function Es(t,e){for(var n=t.length,r=wn(e.length,n),s=Ri(t);r--;){var o=e[r];t[r]=ys(o,n)?s[o]:i}return t}function Rs(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ds=Ns(ei),Ms=_e||function(t,e){return fe.setTimeout(t,e)},Is=Ns(ni);function Ps(t,e,n){var r=e+"";return Is(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(ct,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ae(g,(function(n){var r="_."+n[0];e&n[1]&&!De(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(lt);return e?e[1].split(ht):[]}(r),n)))}function Ns(t){var e=0,n=0;return function(){var r=bn(),s=16-(r-n);if(n=r,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Vs(t,e){var n=-1,r=t.length,s=r-1;for(e=e===i?r:e;++n<e;){var o=Zr(n,s),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var qs=function(t){var e=Vo(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(rt,(function(t,n,r,i){e.push(r?i.replace(ft,"$1"):n||t)})),e}));function js(t){if("string"==typeof t||la(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ls(t){if(null!=t){try{return Vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Fs(t){if(t instanceof Gn)return t.clone();var e=new Wn(t.__wrapped__,t.__chain__);return e.__actions__=Ri(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Bs=Qr((function(t,e){return Zo(t)?pr(t,vr(e,1,Zo,!0)):[]})),Us=Qr((function(t,e){var n=Qs(e);return Zo(n)&&(n=i),Zo(t)?pr(t,vr(e,1,Zo,!0),cs(n,2)):[]})),zs=Qr((function(t,e){var n=Qs(e);return Zo(n)&&(n=i),Zo(t)?pr(t,vr(e,1,Zo,!0),i,n):[]}));function Ws(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ma(n);return i<0&&(i=yn(r+i,0)),Fe(t,cs(e,3),i)}function Gs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=r-1;return n!==i&&(s=ma(n),s=n<0?yn(r+s,0):wn(s,r-1)),Fe(t,cs(e,3),s,!0)}function Hs(t){return(null==t?0:t.length)?vr(t,1):[]}function $s(t){return t&&t.length?t[0]:i}var Xs=Qr((function(t){var e=Ie(t,vi);return e.length&&e[0]===t[0]?Rr(e):[]})),Zs=Qr((function(t){var e=Qs(t),n=Ie(t,vi);return e===Qs(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Rr(n,cs(e,2)):[]})),Ys=Qr((function(t){var e=Qs(t),n=Ie(t,vi);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Rr(n,i,e):[]}));function Qs(t){var e=null==t?0:t.length;return e?t[e-1]:i}var Ks=Qr(Js);function Js(t,e){return t&&t.length&&e&&e.length?$r(t,e):t}var to=rs((function(t,e){var n=null==t?0:t.length,r=ar(t,e);return Xr(t,Ie(e,(function(t){return ys(t,n)?+t:t})).sort(Ai)),r}));function eo(t){return null==t?t:kn.call(t)}var no=Qr((function(t){return hi(vr(t,1,Zo,!0))})),ro=Qr((function(t){var e=Qs(t);return Zo(e)&&(e=i),hi(vr(t,1,Zo,!0),cs(e,2))})),io=Qr((function(t){var e=Qs(t);return e="function"==typeof e?e:i,hi(vr(t,1,Zo,!0),i,e)}));function so(t){if(!t||!t.length)return[];var e=0;return t=Re(t,(function(t){if(Zo(t))return e=yn(t.length,e),!0})),Ze(e,(function(e){return Ie(t,Ge(e))}))}function oo(t,e){if(!t||!t.length)return[];var n=so(t);return null==e?n:Ie(n,(function(t){return Ce(e,i,t)}))}var ao=Qr((function(t,e){return Zo(t)?pr(t,e):[]})),uo=Qr((function(t){return mi(Re(t,Zo))})),co=Qr((function(t){var e=Qs(t);return Zo(e)&&(e=i),mi(Re(t,Zo),cs(e,2))})),lo=Qr((function(t){var e=Qs(t);return e="function"==typeof e?e:i,mi(Re(t,Zo),i,e)})),ho=Qr(so);var po=Qr((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,oo(t,n)}));function fo(t){var e=Bn(t);return e.__chain__=!0,e}function _o(t,e){return e(t)}var mo=rs((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,s=function(e){return ar(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Gn&&ys(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:_o,args:[s],thisArg:i}),new Wn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(s)}));var go=Mi((function(t,e,n){qt.call(t,n)?++t[n]:or(t,n,1)}));var vo=Li(Ws),yo=Li(Gs);function wo(t,e){return(Ho(t)?Ae:fr)(t,cs(e,3))}function bo(t,e){return(Ho(t)?Oe:dr)(t,cs(e,3))}var xo=Mi((function(t,e,n){qt.call(t,n)?t[n].push(e):or(t,n,[e])}));var To=Qr((function(t,e,n){var i=-1,s="function"==typeof e,o=Xo(t)?r(t.length):[];return fr(t,(function(t){o[++i]=s?Ce(e,t,n):Dr(t,e,n)})),o})),ko=Mi((function(t,e,n){or(t,n,e)}));function Co(t,e){return(Ho(t)?Ie:Fr)(t,cs(e,3))}var So=Mi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var Ao=Qr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ws(t,e[0],e[1])?e=[]:n>2&&ws(e[0],e[1],e[2])&&(e=[e[0]]),Gr(t,vr(e,1),[])})),Oo=de||function(){return fe.Date.now()};function Eo(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,Ki(t,h,i,i,i,i,e)}function Ro(t,e){var n;if("function"!=typeof e)throw new Dt(s);return t=ma(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Do=Qr((function(t,e,n){var r=1;if(n.length){var i=cn(n,us(Do));r|=c}return Ki(t,r,e,n,i)})),Mo=Qr((function(t,e,n){var r=3;if(n.length){var i=cn(n,us(Mo));r|=c}return Ki(e,r,t,n,i)}));function Io(t,e,n){var r,o,a,u,c,l,h=0,p=!1,f=!1,d=!0;if("function"!=typeof t)throw new Dt(s);function _(e){var n=r,s=o;return r=o=i,h=e,u=t.apply(s,n)}function m(t){return h=t,c=Ms(v,e),p?_(t):u}function g(t){var n=t-l;return l===i||n>=e||n<0||f&&t-h>=a}function v(){var t=Oo();if(g(t))return y(t);c=Ms(v,function(t){var n=e-(t-l);return f?wn(n,a-(t-h)):n}(t))}function y(t){return c=i,d&&r?_(t):(r=o=i,u)}function w(){var t=Oo(),n=g(t);if(r=arguments,o=this,l=t,n){if(c===i)return m(l);if(f)return Ti(c),c=Ms(v,e),_(l)}return c===i&&(c=Ms(v,e)),u}return e=va(e)||0,na(n)&&(p=!!n.leading,a=(f="maxWait"in n)?yn(va(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d),w.cancel=function(){c!==i&&Ti(c),h=0,r=l=o=c=i},w.flush=function(){return c===i?u:y(Oo())},w}var Po=Qr((function(t,e){return hr(t,1,e)})),No=Qr((function(t,e,n){return hr(t,va(e)||0,n)}));function Vo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Dt(s);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(Vo.Cache||Xn),n}function qo(t){if("function"!=typeof t)throw new Dt(s);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Vo.Cache=Xn;var jo=bi((function(t,e){var n=(e=1==e.length&&Ho(e[0])?Ie(e[0],Ye(cs())):Ie(vr(e,1),Ye(cs()))).length;return Qr((function(r){for(var i=-1,s=wn(r.length,n);++i<s;)r[i]=e[i].call(this,r[i]);return Ce(t,this,r)}))})),Lo=Qr((function(t,e){var n=cn(e,us(Lo));return Ki(t,c,i,e,n)})),Fo=Qr((function(t,e){var n=cn(e,us(Fo));return Ki(t,l,i,e,n)})),Bo=rs((function(t,e){return Ki(t,p,i,i,i,e)}));function Uo(t,e){return t===e||t!=t&&e!=e}var zo=$i(Ar),Wo=$i((function(t,e){return t>=e})),Go=Mr(function(){return arguments}())?Mr:function(t){return ra(t)&&qt.call(t,"callee")&&!Yt.call(t,"callee")},Ho=r.isArray,$o=ye?Ye(ye):function(t){return ra(t)&&Sr(t)==P};function Xo(t){return null!=t&&ea(t.length)&&!Jo(t)}function Zo(t){return ra(t)&&Xo(t)}var Yo=He||vu,Qo=we?Ye(we):function(t){return ra(t)&&Sr(t)==b};function Ko(t){if(!ra(t))return!1;var e=Sr(t);return e==x||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!oa(t)}function Jo(t){if(!na(t))return!1;var e=Sr(t);return e==T||e==k||"[object AsyncFunction]"==e||"[object Proxy]"==e}function ta(t){return"number"==typeof t&&t==ma(t)}function ea(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=d}function na(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ra(t){return null!=t&&"object"==typeof t}var ia=be?Ye(be):function(t){return ra(t)&&_s(t)==C};function sa(t){return"number"==typeof t||ra(t)&&Sr(t)==S}function oa(t){if(!ra(t)||Sr(t)!=A)return!1;var e=Xt(t);if(null===e)return!0;var n=qt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Vt.call(n)==Bt}var aa=xe?Ye(xe):function(t){return ra(t)&&Sr(t)==E};var ua=Te?Ye(Te):function(t){return ra(t)&&_s(t)==R};function ca(t){return"string"==typeof t||!Ho(t)&&ra(t)&&Sr(t)==D}function la(t){return"symbol"==typeof t||ra(t)&&Sr(t)==M}var ha=ke?Ye(ke):function(t){return ra(t)&&ea(t.length)&&!!oe[Sr(t)]};var pa=$i(Lr),fa=$i((function(t,e){return t<=e}));function da(t){if(!t)return[];if(Xo(t))return ca(t)?fn(t):Ri(t);if(ne&&t[ne])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[ne]());var e=_s(t);return(e==C?an:e==R?ln:Ua)(t)}function _a(t){return t?(t=va(t))===f||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ma(t){var e=_a(t),n=e%1;return e==e?n?e-n:e:0}function ga(t){return t?ur(ma(t),0,m):0}function va(t){if("number"==typeof t)return t;if(la(t))return _;if(na(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=na(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ot,"");var n=gt.test(t);return n||yt.test(t)?le(t.slice(2),n?2:8):mt.test(t)?_:+t}function ya(t){return Di(t,Pa(t))}function wa(t){return null==t?"":li(t)}var ba=Ii((function(t,e){if(ks(e)||Xo(e))Di(e,Ia(e),t);else for(var n in e)qt.call(e,n)&&nr(t,n,e[n])})),xa=Ii((function(t,e){Di(e,Pa(e),t)})),Ta=Ii((function(t,e,n,r){Di(e,Pa(e),t,r)})),ka=Ii((function(t,e,n,r){Di(e,Ia(e),t,r)})),Ca=rs(ar);var Sa=Qr((function(t,e){t=Ot(t);var n=-1,r=e.length,s=r>2?e[2]:i;for(s&&ws(e[0],e[1],s)&&(r=1);++n<r;)for(var o=e[n],a=Pa(o),u=-1,c=a.length;++u<c;){var l=a[u],h=t[l];(h===i||Uo(h,Pt[l])&&!qt.call(t,l))&&(t[l]=o[l])}return t})),Aa=Qr((function(t){return t.push(i,ts),Ce(Va,i,t)}));function Oa(t,e,n){var r=null==t?i:kr(t,e);return r===i?n:r}function Ea(t,e){return null!=t&&ms(t,e,Er)}var Ra=Ui((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ft.call(e)),t[e]=n}),nu(su)),Da=Ui((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ft.call(e)),qt.call(t,e)?t[e].push(n):t[e]=[n]}),cs),Ma=Qr(Dr);function Ia(t){return Xo(t)?Qn(t):qr(t)}function Pa(t){return Xo(t)?Qn(t,!0):jr(t)}var Na=Ii((function(t,e,n){zr(t,e,n)})),Va=Ii((function(t,e,n,r){zr(t,e,n,r)})),qa=rs((function(t,e){var n={};if(null==t)return n;var r=!1;e=Ie(e,(function(e){return e=wi(e,t),r||(r=e.length>1),e})),Di(t,ss(t),n),r&&(n=cr(n,7,es));for(var i=e.length;i--;)pi(n,e[i]);return n}));var ja=rs((function(t,e){return null==t?{}:function(t,e){return Hr(t,e,(function(e,n){return Ea(t,n)}))}(t,e)}));function La(t,e){if(null==t)return{};var n=Ie(ss(t),(function(t){return[t]}));return e=cs(e),Hr(t,n,(function(t,n){return e(t,n[0])}))}var Fa=Qi(Ia),Ba=Qi(Pa);function Ua(t){return null==t?[]:Qe(t,Ia(t))}var za=qi((function(t,e,n){return e=e.toLowerCase(),t+(n?Wa(e):e)}));function Wa(t){return Ka(wa(t).toLowerCase())}function Ga(t){return(t=wa(t))&&t.replace(bt,nn).replace(Jt,"")}var Ha=qi((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),$a=qi((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Xa=Vi("toLowerCase");var Za=qi((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Ya=qi((function(t,e,n){return t+(n?" ":"")+Ka(e)}));var Qa=qi((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ka=Vi("toUpperCase");function Ja(t,e,n){return t=wa(t),(e=n?i:e)===i?function(t){return re.test(t)}(t)?function(t){return t.match(ee)||[]}(t):function(t){return t.match(pt)||[]}(t):t.match(e)||[]}var tu=Qr((function(t,e){try{return Ce(t,i,e)}catch(t){return Ko(t)?t:new Ct(t)}})),eu=rs((function(t,e){return Ae(e,(function(e){e=js(e),or(t,e,Do(t[e],t))})),t}));function nu(t){return function(){return t}}var ru=Fi(),iu=Fi(!0);function su(t){return t}function ou(t){return Vr("function"==typeof t?t:cr(t,1))}var au=Qr((function(t,e){return function(n){return Dr(n,t,e)}})),uu=Qr((function(t,e){return function(n){return Dr(t,n,e)}}));function cu(t,e,n){var r=Ia(e),i=Tr(e,r);null!=n||na(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=Tr(e,Ia(e)));var s=!(na(n)&&"chain"in n&&!n.chain),o=Jo(t);return Ae(i,(function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(s||e){var n=t(this.__wrapped__),i=n.__actions__=Ri(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Pe([this.value()],arguments))})})),t}function lu(){}var hu=Wi(Ie),pu=Wi(Ee),fu=Wi(qe);function du(t){return bs(t)?Ge(js(t)):function(t){return function(e){return kr(e,t)}}(t)}var _u=Hi(),mu=Hi(!0);function gu(){return[]}function vu(){return!1}var yu=zi((function(t,e){return t+e}),0),wu=Zi("ceil"),bu=zi((function(t,e){return t/e}),1),xu=Zi("floor");var Tu,ku=zi((function(t,e){return t*e}),1),Cu=Zi("round"),Su=zi((function(t,e){return t-e}),0);return Bn.after=function(t,e){if("function"!=typeof e)throw new Dt(s);return t=ma(t),function(){if(--t<1)return e.apply(this,arguments)}},Bn.ary=Eo,Bn.assign=ba,Bn.assignIn=xa,Bn.assignInWith=Ta,Bn.assignWith=ka,Bn.at=Ca,Bn.before=Ro,Bn.bind=Do,Bn.bindAll=eu,Bn.bindKey=Mo,Bn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ho(t)?t:[t]},Bn.chain=fo,Bn.chunk=function(t,e,n){e=(n?ws(t,e,n):e===i)?1:yn(ma(e),0);var s=null==t?0:t.length;if(!s||e<1)return[];for(var o=0,a=0,u=r(ge(s/e));o<s;)u[a++]=ii(t,o,o+=e);return u},Bn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var s=t[e];s&&(i[r++]=s)}return i},Bn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Pe(Ho(n)?Ri(n):[n],vr(e,1))},Bn.cond=function(t){var e=null==t?0:t.length,n=cs();return t=e?Ie(t,(function(t){if("function"!=typeof t[1])throw new Dt(s);return[n(t[0]),t[1]]})):[],Qr((function(n){for(var r=-1;++r<e;){var i=t[r];if(Ce(i[0],this,n))return Ce(i[1],this,n)}}))},Bn.conforms=function(t){return function(t){var e=Ia(t);return function(n){return lr(n,t,e)}}(cr(t,1))},Bn.constant=nu,Bn.countBy=go,Bn.create=function(t,e){var n=Un(t);return null==e?n:sr(n,e)},Bn.curry=function t(e,n,r){var s=Ki(e,8,i,i,i,i,i,n=r?i:n);return s.placeholder=t.placeholder,s},Bn.curryRight=function t(e,n,r){var s=Ki(e,u,i,i,i,i,i,n=r?i:n);return s.placeholder=t.placeholder,s},Bn.debounce=Io,Bn.defaults=Sa,Bn.defaultsDeep=Aa,Bn.defer=Po,Bn.delay=No,Bn.difference=Bs,Bn.differenceBy=Us,Bn.differenceWith=zs,Bn.drop=function(t,e,n){var r=null==t?0:t.length;return r?ii(t,(e=n||e===i?1:ma(e))<0?0:e,r):[]},Bn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ii(t,0,(e=r-(e=n||e===i?1:ma(e)))<0?0:e):[]},Bn.dropRightWhile=function(t,e){return t&&t.length?di(t,cs(e,3),!0,!0):[]},Bn.dropWhile=function(t,e){return t&&t.length?di(t,cs(e,3),!0):[]},Bn.fill=function(t,e,n,r){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&ws(t,e,n)&&(n=0,r=s),function(t,e,n,r){var s=t.length;for((n=ma(n))<0&&(n=-n>s?0:s+n),(r=r===i||r>s?s:ma(r))<0&&(r+=s),r=n>r?0:ga(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Bn.filter=function(t,e){return(Ho(t)?Re:gr)(t,cs(e,3))},Bn.flatMap=function(t,e){return vr(Co(t,e),1)},Bn.flatMapDeep=function(t,e){return vr(Co(t,e),f)},Bn.flatMapDepth=function(t,e,n){return n=n===i?1:ma(n),vr(Co(t,e),n)},Bn.flatten=Hs,Bn.flattenDeep=function(t){return(null==t?0:t.length)?vr(t,f):[]},Bn.flattenDepth=function(t,e){return(null==t?0:t.length)?vr(t,e=e===i?1:ma(e)):[]},Bn.flip=function(t){return Ki(t,512)},Bn.flow=ru,Bn.flowRight=iu,Bn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Bn.functions=function(t){return null==t?[]:Tr(t,Ia(t))},Bn.functionsIn=function(t){return null==t?[]:Tr(t,Pa(t))},Bn.groupBy=xo,Bn.initial=function(t){return(null==t?0:t.length)?ii(t,0,-1):[]},Bn.intersection=Xs,Bn.intersectionBy=Zs,Bn.intersectionWith=Ys,Bn.invert=Ra,Bn.invertBy=Da,Bn.invokeMap=To,Bn.iteratee=ou,Bn.keyBy=ko,Bn.keys=Ia,Bn.keysIn=Pa,Bn.map=Co,Bn.mapKeys=function(t,e){var n={};return e=cs(e,3),br(t,(function(t,r,i){or(n,e(t,r,i),t)})),n},Bn.mapValues=function(t,e){var n={};return e=cs(e,3),br(t,(function(t,r,i){or(n,r,e(t,r,i))})),n},Bn.matches=function(t){return Br(cr(t,1))},Bn.matchesProperty=function(t,e){return Ur(t,cr(e,1))},Bn.memoize=Vo,Bn.merge=Na,Bn.mergeWith=Va,Bn.method=au,Bn.methodOf=uu,Bn.mixin=cu,Bn.negate=qo,Bn.nthArg=function(t){return t=ma(t),Qr((function(e){return Wr(e,t)}))},Bn.omit=qa,Bn.omitBy=function(t,e){return La(t,qo(cs(e)))},Bn.once=function(t){return Ro(2,t)},Bn.orderBy=function(t,e,n,r){return null==t?[]:(Ho(e)||(e=null==e?[]:[e]),Ho(n=r?i:n)||(n=null==n?[]:[n]),Gr(t,e,n))},Bn.over=hu,Bn.overArgs=jo,Bn.overEvery=pu,Bn.overSome=fu,Bn.partial=Lo,Bn.partialRight=Fo,Bn.partition=So,Bn.pick=ja,Bn.pickBy=La,Bn.property=du,Bn.propertyOf=function(t){return function(e){return null==t?i:kr(t,e)}},Bn.pull=Ks,Bn.pullAll=Js,Bn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?$r(t,e,cs(n,2)):t},Bn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?$r(t,e,i,n):t},Bn.pullAt=to,Bn.range=_u,Bn.rangeRight=mu,Bn.rearg=Bo,Bn.reject=function(t,e){return(Ho(t)?Re:gr)(t,qo(cs(e,3)))},Bn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],s=t.length;for(e=cs(e,3);++r<s;){var o=t[r];e(o,r,t)&&(n.push(o),i.push(r))}return Xr(t,i),n},Bn.rest=function(t,e){if("function"!=typeof t)throw new Dt(s);return Qr(t,e=e===i?e:ma(e))},Bn.reverse=eo,Bn.sampleSize=function(t,e,n){return e=(n?ws(t,e,n):e===i)?1:ma(e),(Ho(t)?Jn:Jr)(t,e)},Bn.set=function(t,e,n){return null==t?t:ti(t,e,n)},Bn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:ti(t,e,n,r)},Bn.shuffle=function(t){return(Ho(t)?tr:ri)(t)},Bn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ws(t,e,n)?(e=0,n=r):(e=null==e?0:ma(e),n=n===i?r:ma(n)),ii(t,e,n)):[]},Bn.sortBy=Ao,Bn.sortedUniq=function(t){return t&&t.length?ui(t):[]},Bn.sortedUniqBy=function(t,e){return t&&t.length?ui(t,cs(e,2)):[]},Bn.split=function(t,e,n){return n&&"number"!=typeof n&&ws(t,e,n)&&(e=n=i),(n=n===i?m:n>>>0)?(t=wa(t))&&("string"==typeof e||null!=e&&!aa(e))&&!(e=li(e))&&on(t)?xi(fn(t),0,n):t.split(e,n):[]},Bn.spread=function(t,e){if("function"!=typeof t)throw new Dt(s);return e=null==e?0:yn(ma(e),0),Qr((function(n){var r=n[e],i=xi(n,0,e);return r&&Pe(i,r),Ce(t,this,i)}))},Bn.tail=function(t){var e=null==t?0:t.length;return e?ii(t,1,e):[]},Bn.take=function(t,e,n){return t&&t.length?ii(t,0,(e=n||e===i?1:ma(e))<0?0:e):[]},Bn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ii(t,(e=r-(e=n||e===i?1:ma(e)))<0?0:e,r):[]},Bn.takeRightWhile=function(t,e){return t&&t.length?di(t,cs(e,3),!1,!0):[]},Bn.takeWhile=function(t,e){return t&&t.length?di(t,cs(e,3)):[]},Bn.tap=function(t,e){return e(t),t},Bn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Dt(s);return na(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Io(t,e,{leading:r,maxWait:e,trailing:i})},Bn.thru=_o,Bn.toArray=da,Bn.toPairs=Fa,Bn.toPairsIn=Ba,Bn.toPath=function(t){return Ho(t)?Ie(t,js):la(t)?[t]:Ri(qs(wa(t)))},Bn.toPlainObject=ya,Bn.transform=function(t,e,n){var r=Ho(t),i=r||Yo(t)||ha(t);if(e=cs(e,4),null==n){var s=t&&t.constructor;n=i?r?new s:[]:na(t)&&Jo(s)?Un(Xt(t)):{}}return(i?Ae:br)(t,(function(t,r,i){return e(n,t,r,i)})),n},Bn.unary=function(t){return Eo(t,1)},Bn.union=no,Bn.unionBy=ro,Bn.unionWith=io,Bn.uniq=function(t){return t&&t.length?hi(t):[]},Bn.uniqBy=function(t,e){return t&&t.length?hi(t,cs(e,2)):[]},Bn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?hi(t,i,e):[]},Bn.unset=function(t,e){return null==t||pi(t,e)},Bn.unzip=so,Bn.unzipWith=oo,Bn.update=function(t,e,n){return null==t?t:fi(t,e,yi(n))},Bn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:fi(t,e,yi(n),r)},Bn.values=Ua,Bn.valuesIn=function(t){return null==t?[]:Qe(t,Pa(t))},Bn.without=ao,Bn.words=Ja,Bn.wrap=function(t,e){return Lo(yi(e),t)},Bn.xor=uo,Bn.xorBy=co,Bn.xorWith=lo,Bn.zip=ho,Bn.zipObject=function(t,e){return gi(t||[],e||[],nr)},Bn.zipObjectDeep=function(t,e){return gi(t||[],e||[],ti)},Bn.zipWith=po,Bn.entries=Fa,Bn.entriesIn=Ba,Bn.extend=xa,Bn.extendWith=Ta,cu(Bn,Bn),Bn.add=yu,Bn.attempt=tu,Bn.camelCase=za,Bn.capitalize=Wa,Bn.ceil=wu,Bn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=va(n))==n?n:0),e!==i&&(e=(e=va(e))==e?e:0),ur(va(t),e,n)},Bn.clone=function(t){return cr(t,4)},Bn.cloneDeep=function(t){return cr(t,5)},Bn.cloneDeepWith=function(t,e){return cr(t,5,e="function"==typeof e?e:i)},Bn.cloneWith=function(t,e){return cr(t,4,e="function"==typeof e?e:i)},Bn.conformsTo=function(t,e){return null==e||lr(t,e,Ia(e))},Bn.deburr=Ga,Bn.defaultTo=function(t,e){return null==t||t!=t?e:t},Bn.divide=bu,Bn.endsWith=function(t,e,n){t=wa(t),e=li(e);var r=t.length,s=n=n===i?r:ur(ma(n),0,r);return(n-=e.length)>=0&&t.slice(n,s)==e},Bn.eq=Uo,Bn.escape=function(t){return(t=wa(t))&&Q.test(t)?t.replace(Z,rn):t},Bn.escapeRegExp=function(t){return(t=wa(t))&&st.test(t)?t.replace(it,"\\$&"):t},Bn.every=function(t,e,n){var r=Ho(t)?Ee:_r;return n&&ws(t,e,n)&&(e=i),r(t,cs(e,3))},Bn.find=vo,Bn.findIndex=Ws,Bn.findKey=function(t,e){return Le(t,cs(e,3),br)},Bn.findLast=yo,Bn.findLastIndex=Gs,Bn.findLastKey=function(t,e){return Le(t,cs(e,3),xr)},Bn.floor=xu,Bn.forEach=wo,Bn.forEachRight=bo,Bn.forIn=function(t,e){return null==t?t:yr(t,cs(e,3),Pa)},Bn.forInRight=function(t,e){return null==t?t:wr(t,cs(e,3),Pa)},Bn.forOwn=function(t,e){return t&&br(t,cs(e,3))},Bn.forOwnRight=function(t,e){return t&&xr(t,cs(e,3))},Bn.get=Oa,Bn.gt=zo,Bn.gte=Wo,Bn.has=function(t,e){return null!=t&&ms(t,e,Or)},Bn.hasIn=Ea,Bn.head=$s,Bn.identity=su,Bn.includes=function(t,e,n,r){t=Xo(t)?t:Ua(t),n=n&&!r?ma(n):0;var i=t.length;return n<0&&(n=yn(i+n,0)),ca(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&Be(t,e,n)>-1},Bn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ma(n);return i<0&&(i=yn(r+i,0)),Be(t,e,i)},Bn.inRange=function(t,e,n){return e=_a(e),n===i?(n=e,e=0):n=_a(n),function(t,e,n){return t>=wn(e,n)&&t<yn(e,n)}(t=va(t),e,n)},Bn.invoke=Ma,Bn.isArguments=Go,Bn.isArray=Ho,Bn.isArrayBuffer=$o,Bn.isArrayLike=Xo,Bn.isArrayLikeObject=Zo,Bn.isBoolean=function(t){return!0===t||!1===t||ra(t)&&Sr(t)==w},Bn.isBuffer=Yo,Bn.isDate=Qo,Bn.isElement=function(t){return ra(t)&&1===t.nodeType&&!oa(t)},Bn.isEmpty=function(t){if(null==t)return!0;if(Xo(t)&&(Ho(t)||"string"==typeof t||"function"==typeof t.splice||Yo(t)||ha(t)||Go(t)))return!t.length;var e=_s(t);if(e==C||e==R)return!t.size;if(ks(t))return!qr(t).length;for(var n in t)if(qt.call(t,n))return!1;return!0},Bn.isEqual=function(t,e){return Ir(t,e)},Bn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?Ir(t,e,i,n):!!r},Bn.isError=Ko,Bn.isFinite=function(t){return"number"==typeof t&&mn(t)},Bn.isFunction=Jo,Bn.isInteger=ta,Bn.isLength=ea,Bn.isMap=ia,Bn.isMatch=function(t,e){return t===e||Pr(t,e,hs(e))},Bn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,Pr(t,e,hs(e),n)},Bn.isNaN=function(t){return sa(t)&&t!=+t},Bn.isNative=function(t){if(Ts(t))throw new Ct("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Nr(t)},Bn.isNil=function(t){return null==t},Bn.isNull=function(t){return null===t},Bn.isNumber=sa,Bn.isObject=na,Bn.isObjectLike=ra,Bn.isPlainObject=oa,Bn.isRegExp=aa,Bn.isSafeInteger=function(t){return ta(t)&&t>=-9007199254740991&&t<=d},Bn.isSet=ua,Bn.isString=ca,Bn.isSymbol=la,Bn.isTypedArray=ha,Bn.isUndefined=function(t){return t===i},Bn.isWeakMap=function(t){return ra(t)&&_s(t)==I},Bn.isWeakSet=function(t){return ra(t)&&"[object WeakSet]"==Sr(t)},Bn.join=function(t,e){return null==t?"":gn.call(t,e)},Bn.kebabCase=Ha,Bn.last=Qs,Bn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=r;return n!==i&&(s=(s=ma(n))<0?yn(r+s,0):wn(s,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,s):Fe(t,ze,s,!0)},Bn.lowerCase=$a,Bn.lowerFirst=Xa,Bn.lt=pa,Bn.lte=fa,Bn.max=function(t){return t&&t.length?mr(t,su,Ar):i},Bn.maxBy=function(t,e){return t&&t.length?mr(t,cs(e,2),Ar):i},Bn.mean=function(t){return We(t,su)},Bn.meanBy=function(t,e){return We(t,cs(e,2))},Bn.min=function(t){return t&&t.length?mr(t,su,Lr):i},Bn.minBy=function(t,e){return t&&t.length?mr(t,cs(e,2),Lr):i},Bn.stubArray=gu,Bn.stubFalse=vu,Bn.stubObject=function(){return{}},Bn.stubString=function(){return""},Bn.stubTrue=function(){return!0},Bn.multiply=ku,Bn.nth=function(t,e){return t&&t.length?Wr(t,ma(e)):i},Bn.noConflict=function(){return fe._===this&&(fe._=Ut),this},Bn.noop=lu,Bn.now=Oo,Bn.pad=function(t,e,n){t=wa(t);var r=(e=ma(e))?pn(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Gi(ve(i),n)+t+Gi(ge(i),n)},Bn.padEnd=function(t,e,n){t=wa(t);var r=(e=ma(e))?pn(t):0;return e&&r<e?t+Gi(e-r,n):t},Bn.padStart=function(t,e,n){t=wa(t);var r=(e=ma(e))?pn(t):0;return e&&r<e?Gi(e-r,n)+t:t},Bn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),xn(wa(t).replace(at,""),e||0)},Bn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ws(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=_a(t),e===i?(e=t,t=0):e=_a(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var s=Tn();return wn(t+s*(e-t+ce("1e-"+((s+"").length-1))),e)}return Zr(t,e)},Bn.reduce=function(t,e,n){var r=Ho(t)?Ne:$e,i=arguments.length<3;return r(t,cs(e,4),n,i,fr)},Bn.reduceRight=function(t,e,n){var r=Ho(t)?Ve:$e,i=arguments.length<3;return r(t,cs(e,4),n,i,dr)},Bn.repeat=function(t,e,n){return e=(n?ws(t,e,n):e===i)?1:ma(e),Yr(wa(t),e)},Bn.replace=function(){var t=arguments,e=wa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Bn.result=function(t,e,n){var r=-1,s=(e=wi(e,t)).length;for(s||(s=1,t=i);++r<s;){var o=null==t?i:t[js(e[r])];o===i&&(r=s,o=n),t=Jo(o)?o.call(t):o}return t},Bn.round=Cu,Bn.runInContext=t,Bn.sample=function(t){return(Ho(t)?Kn:Kr)(t)},Bn.size=function(t){if(null==t)return 0;if(Xo(t))return ca(t)?pn(t):t.length;var e=_s(t);return e==C||e==R?t.size:qr(t).length},Bn.snakeCase=Za,Bn.some=function(t,e,n){var r=Ho(t)?qe:si;return n&&ws(t,e,n)&&(e=i),r(t,cs(e,3))},Bn.sortedIndex=function(t,e){return oi(t,e)},Bn.sortedIndexBy=function(t,e,n){return ai(t,e,cs(n,2))},Bn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=oi(t,e);if(r<n&&Uo(t[r],e))return r}return-1},Bn.sortedLastIndex=function(t,e){return oi(t,e,!0)},Bn.sortedLastIndexBy=function(t,e,n){return ai(t,e,cs(n,2),!0)},Bn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=oi(t,e,!0)-1;if(Uo(t[n],e))return n}return-1},Bn.startCase=Ya,Bn.startsWith=function(t,e,n){return t=wa(t),n=null==n?0:ur(ma(n),0,t.length),e=li(e),t.slice(n,n+e.length)==e},Bn.subtract=Su,Bn.sum=function(t){return t&&t.length?Xe(t,su):0},Bn.sumBy=function(t,e){return t&&t.length?Xe(t,cs(e,2)):0},Bn.template=function(t,e,n){var r=Bn.templateSettings;n&&ws(t,e,n)&&(e=i),t=wa(t),e=Ta({},e,r,Ji);var s,o,a=Ta({},e.imports,r.imports,Ji),u=Ia(a),c=Qe(a,u),l=0,h=e.interpolate||xt,p="__p += '",f=Et((e.escape||xt).source+"|"+h.source+"|"+(h===tt?dt:xt).source+"|"+(e.evaluate||xt).source+"|$","g"),d="//# sourceURL="+(qt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++se+"]")+"\n";t.replace(f,(function(e,n,r,i,a,u){return r||(r=i),p+=t.slice(l,u).replace(Tt,sn),n&&(s=!0,p+="' +\n__e("+n+") +\n'"),a&&(o=!0,p+="';\n"+a+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e})),p+="';\n";var _=qt.call(e,"variable")&&e.variable;_||(p="with (obj) {\n"+p+"\n}\n"),p=(o?p.replace(G,""):p).replace(H,"$1").replace($,"$1;"),p="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var m=tu((function(){return St(u,d+"return "+p).apply(i,c)}));if(m.source=p,Ko(m))throw m;return m},Bn.times=function(t,e){if((t=ma(t))<1||t>d)return[];var n=m,r=wn(t,m);e=cs(e),t-=m;for(var i=Ze(r,e);++n<t;)e(n);return i},Bn.toFinite=_a,Bn.toInteger=ma,Bn.toLength=ga,Bn.toLower=function(t){return wa(t).toLowerCase()},Bn.toNumber=va,Bn.toSafeInteger=function(t){return t?ur(ma(t),-9007199254740991,d):0===t?t:0},Bn.toString=wa,Bn.toUpper=function(t){return wa(t).toUpperCase()},Bn.trim=function(t,e,n){if((t=wa(t))&&(n||e===i))return t.replace(ot,"");if(!t||!(e=li(e)))return t;var r=fn(t),s=fn(e);return xi(r,Je(r,s),tn(r,s)+1).join("")},Bn.trimEnd=function(t,e,n){if((t=wa(t))&&(n||e===i))return t.replace(ut,"");if(!t||!(e=li(e)))return t;var r=fn(t);return xi(r,0,tn(r,fn(e))+1).join("")},Bn.trimStart=function(t,e,n){if((t=wa(t))&&(n||e===i))return t.replace(at,"");if(!t||!(e=li(e)))return t;var r=fn(t);return xi(r,Je(r,fn(e))).join("")},Bn.truncate=function(t,e){var n=30,r="...";if(na(e)){var s="separator"in e?e.separator:s;n="length"in e?ma(e.length):n,r="omission"in e?li(e.omission):r}var o=(t=wa(t)).length;if(on(t)){var a=fn(t);o=a.length}if(n>=o)return t;var u=n-pn(r);if(u<1)return r;var c=a?xi(a,0,u).join(""):t.slice(0,u);if(s===i)return c+r;if(a&&(u+=c.length-u),aa(s)){if(t.slice(u).search(s)){var l,h=c;for(s.global||(s=Et(s.source,wa(_t.exec(s))+"g")),s.lastIndex=0;l=s.exec(h);)var p=l.index;c=c.slice(0,p===i?u:p)}}else if(t.indexOf(li(s),u)!=u){var f=c.lastIndexOf(s);f>-1&&(c=c.slice(0,f))}return c+r},Bn.unescape=function(t){return(t=wa(t))&&Y.test(t)?t.replace(X,dn):t},Bn.uniqueId=function(t){var e=++jt;return wa(t)+e},Bn.upperCase=Qa,Bn.upperFirst=Ka,Bn.each=wo,Bn.eachRight=bo,Bn.first=$s,cu(Bn,(Tu={},br(Bn,(function(t,e){qt.call(Bn.prototype,e)||(Tu[e]=t)})),Tu),{chain:!1}),Bn.VERSION="4.17.20",Ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Bn[t].placeholder=Bn})),Ae(["drop","take"],(function(t,e){Gn.prototype[t]=function(n){n=n===i?1:yn(ma(n),0);var r=this.__filtered__&&!e?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=wn(n,r.__takeCount__):r.__views__.push({size:wn(n,m),type:t+(r.__dir__<0?"Right":"")}),r},Gn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Ae(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Gn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:cs(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),Ae(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Gn.prototype[t]=function(){return this[n](1).value()[0]}})),Ae(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Gn.prototype[t]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(su)},Gn.prototype.find=function(t){return this.filter(t).head()},Gn.prototype.findLast=function(t){return this.reverse().find(t)},Gn.prototype.invokeMap=Qr((function(t,e){return"function"==typeof t?new Gn(this):this.map((function(n){return Dr(n,t,e)}))})),Gn.prototype.reject=function(t){return this.filter(qo(cs(t)))},Gn.prototype.slice=function(t,e){t=ma(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Gn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=ma(e))<0?n.dropRight(-e):n.take(e-t)),n)},Gn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Gn.prototype.toArray=function(){return this.take(m)},br(Gn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),s=Bn[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);s&&(Bn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof Gn,c=a[0],l=u||Ho(e),h=function(t){var e=s.apply(Bn,Pe([t],a));return r&&p?e[0]:e};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var p=this.__chain__,f=!!this.__actions__.length,d=o&&!p,_=u&&!f;if(!o&&l){e=_?e:new Gn(this);var m=t.apply(e,a);return m.__actions__.push({func:_o,args:[h],thisArg:i}),new Wn(m,p)}return d&&_?t.apply(this,a):(m=this.thru(h),d?r?m.value()[0]:m.value():m)})})),Ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Mt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Bn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ho(i)?i:[],t)}return this[n]((function(n){return e.apply(Ho(n)?n:[],t)}))}})),br(Gn.prototype,(function(t,e){var n=Bn[e];if(n){var r=n.name+"";qt.call(Mn,r)||(Mn[r]=[]),Mn[r].push({name:e,func:n})}})),Mn[Bi(i,2).name]=[{name:"wrapper",func:i}],Gn.prototype.clone=function(){var t=new Gn(this.__wrapped__);return t.__actions__=Ri(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ri(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ri(this.__views__),t},Gn.prototype.reverse=function(){if(this.__filtered__){var t=new Gn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Gn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ho(t),r=e<0,i=n?t.length:0,s=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var s=n[r],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=wn(e,t+o);break;case"takeRight":t=yn(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=s.start,a=s.end,u=a-o,c=r?a:o-1,l=this.__iteratees__,h=l.length,p=0,f=wn(u,this.__takeCount__);if(!n||!r&&i==u&&f==u)return _i(t,this.__actions__);var d=[];t:for(;u--&&p<f;){for(var _=-1,m=t[c+=e];++_<h;){var g=l[_],v=g.iteratee,y=g.type,w=v(m);if(2==y)m=w;else if(!w){if(1==y)continue t;break t}}d[p++]=m}return d},Bn.prototype.at=mo,Bn.prototype.chain=function(){return fo(this)},Bn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},Bn.prototype.next=function(){this.__values__===i&&(this.__values__=da(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},Bn.prototype.plant=function(t){for(var e,n=this;n instanceof zn;){var r=Fs(n);r.__index__=0,r.__values__=i,e?s.__wrapped__=r:e=r;var s=r;n=n.__wrapped__}return s.__wrapped__=t,e},Bn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Gn){var e=t;return this.__actions__.length&&(e=new Gn(this)),(e=e.reverse()).__actions__.push({func:_o,args:[eo],thisArg:i}),new Wn(e,this.__chain__)}return this.thru(eo)},Bn.prototype.toJSON=Bn.prototype.valueOf=Bn.prototype.value=function(){return _i(this.__wrapped__,this.__actions__)},Bn.prototype.first=Bn.prototype.head,ne&&(Bn.prototype[ne]=function(){return this}),Bn}();fe._=_n,(r=function(){return _n}.call(e,n,e,t))===i||(t.exports=r)}.call(this)},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,s=Object.create(i.prototype),o=new O(r||[]);return s._invoke=function(t,e,n){var r=h;return function(i,s){if(r===f)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw s;return R()}for(n.method=i,n.arg=s;;){var o=n.delegate;if(o){var a=C(o,n);if(a){if(a===_)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?d:p,u.arg===_)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(t,n,o),s}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",p="suspendedYield",f="executing",d="completed",_={};function m(){}function g(){}function v(){}var y={};y[s]=function(){return this};var w=Object.getPrototypeOf,b=w&&w(w(E([])));b&&b!==n&&r.call(b,s)&&(y=b);var x=v.prototype=m.prototype=Object.create(y);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,s,o,a){var u=l(t[i],t,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,a)}))}a(u.arg)}var i;this._invoke=function(t,r){function s(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(s,s):s()}}function C(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method))return _;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,_;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,_):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function E(t){if(t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:e,done:!0}}return g.prototype=x.constructor=v,v.constructor=g,g.displayName=u(v,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,a,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},T(k.prototype),k.prototype[o]=function(){return this},t.AsyncIterator=k,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var o=new k(c(e,n,r,i),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(x),u(x,a,"Generator"),x[s]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=E,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),_},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),_}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:E(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),_}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},877:(t,e,n)=>{var r=n(570),i=n(171),s=i;s.v1=r,s.v4=i,t.exports=s},327:t=>{for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var r=n||0,i=e;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}},217:t=>{var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},570:(t,e,n)=>{var r,i,s=n(217),o=n(327),a=0,u=0;t.exports=function(t,e,n){var c=e&&n||0,l=e||[],h=(t=t||{}).node||r,p=void 0!==t.clockseq?t.clockseq:i;if(null==h||null==p){var f=s();null==h&&(h=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=i=16383&(f[6]<<8|f[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),_=void 0!==t.nsecs?t.nsecs:u+1,m=d-a+(_-u)/1e4;if(m<0&&void 0===t.clockseq&&(p=p+1&16383),(m<0||d>a)&&void 0===t.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,u=_,i=p;var g=(1e4*(268435455&(d+=122192928e5))+_)%4294967296;l[c++]=g>>>24&255,l[c++]=g>>>16&255,l[c++]=g>>>8&255,l[c++]=255&g;var v=d/4294967296*1e4&268435455;l[c++]=v>>>8&255,l[c++]=255&v,l[c++]=v>>>24&15|16,l[c++]=v>>>16&255,l[c++]=p>>>8|128,l[c++]=255&p;for(var y=0;y<6;++y)l[c+y]=h[y];return e||o(l)}},171:(t,e,n)=>{var r=n(217),i=n(327);t.exports=function(t,e,n){var s=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var a=0;a<16;++a)e[s+a]=o[a];return e||i(o)}}},r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={id:t,loaded:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}i.m=n,i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>t+".soundmain.js",i.miniCssF=t=>"main."+{785:"7fa8d6c246d8473457bb",823:"081b026faa767298db28",865:"afc243ae62ac081c2c1b"}[t]+".css",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="realness:",i.l=(n,r,s)=>{if(t[n])t[n].push(r);else{var o,a;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var l=u[c];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+s){o=l;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",e+s),o.src=n),t[n]=[r];var h=(e,r)=>{o.onerror=o.onload=null,clearTimeout(p);var i=t[n];if(delete t[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((t=>t(r))),e)return e(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),a&&document.head.appendChild(o)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={179:0};i.f.j=(e,n)=>{var r=i.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise(((n,i)=>{r=t[e]=[n,i]}));n.push(r[2]=s);var o=i.p+i.u(e),a=new Error;i.l(o,(n=>{if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}}),"chunk-"+e)}};var e=self.webpackChunkrealness=self.webpackChunkrealness||[],n=e.push.bind(e);e.push=e=>{for(var r,s,[o,a,u]=e,c=0,l=[];c<o.length;c++)s=o[c],i.o(t,s)&&t[s]&&l.push(t[s][0]),t[s]=0;for(r in a)i.o(a,r)&&(i.m[r]=a[r]);for(u&&u(i),n(e);l.length;)l.shift()()}})(),(()=>{"use strict";const t="14.7.58";var e=i(382);const n=new WeakSet,r=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,u=new WeakMap,c=new WeakMap,l=new WeakMap,h=new WeakMap,p=new WeakMap,f={construct:()=>f},d=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,_=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(d);for(;null!==i;){const t=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(d)}return[n.join(";"),r]},m=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},g=t=>{if(!(t=>{try{new new Proxy(t,f)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},v=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},y=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[r]=n;return t.delete(r),r},w=(t,e,n,r)=>{const i=v(t,e),s=y(i,(t=>t[0]===n&&t[1]===r));return 0===i.size&&t.delete(e),s},b=t=>v(c,t),x=t=>{if(n.has(t))throw new Error("The AudioNode is already stored.");n.add(t),b(t).forEach((t=>t(!0)))},T=t=>"port"in t,k=t=>{if(!n.has(t))throw new Error("The AudioNode is not stored.");n.delete(t),b(t).forEach((t=>t(!1)))},C=(t,e)=>{!T(t)&&e.every((t=>0===t.size))&&k(t)},S={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},A=(t,e)=>t.context===e,O=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},E=()=>new DOMException("","IndexSizeError"),R=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw E();throw t}})},D={numberOfChannels:1},M=-34028234663852886e22,I=-M,P=t=>n.has(t),N={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},V=t=>v(r,t),q=t=>v(o,t),j=(t,e)=>{const{activeInputs:n}=V(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||j(n,[...e,t])}))));const r=(t=>"playbackRate"in t)(t)?[t.playbackRate]:T(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of r){const n=q(t);void 0!==n&&n.activeInputs.forEach((([t])=>j(t,e)))}P(t)&&k(t)},L=t=>{j(t.destination,[])},F=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),B=t=>"context"in t,U=t=>B(t[0]),z=(t,e,n,r)=>{for(const e of t)if(n(e)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},W=(t,e,[n,r],i)=>{z(t,[e,n,r],(t=>t[0]===e&&t[1]===n),i)},G=(t,[e,n,r],i)=>{const s=t.get(e);void 0===s?t.set(e,new Set([[n,r]])):z(s,[n,r],(t=>t[0]===n),i)},H=t=>"inputs"in t,$=(t,e,n,r)=>{if(H(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},X=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},Z=(t,e)=>{if(!b(t).delete(e))throw new Error("Missing the expected event listener.")},Y=(t,e,n)=>{const r=v(t,e),i=y(r,(t=>t[0]===n));return 0===r.size&&t.delete(e),i},Q=(t,e,n,r)=>{H(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},K=t=>v(s,t),J=t=>v(a,t),tt=t=>l.has(t),et=t=>!n.has(t),nt=t=>new Promise((e=>{const n=t.createScriptProcessor(256,1,1),r=t.createGain(),i=t.createBuffer(1,2,44100),s=i.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=i,o.loop=!0,o.connect(n).connect(t.destination),o.connect(r),o.disconnect(r),n.onaudioprocess=r=>{const i=r.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(t=>1===t))?e(!0):e(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(t.destination)},o.start()})),rt=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},it=t=>"context"in t,st=t=>{const e=new Map;t.connect=(t=>(n,r=0,i=0)=>{const s=it(n)?t(n,r,i):t(n,r),o=e.get(n);return void 0===o?e.set(n,[{input:i,output:r}]):o.every((t=>t.input!==i||t.output!==r))&&o.push({input:i,output:r}),s})(t.connect.bind(t)),t.disconnect=(n=>(r,i,s)=>{if(n.apply(t),void 0===r)e.clear();else if("number"==typeof r)for(const[t,n]of e){const i=n.filter((t=>t.output!==r));0===i.length?e.delete(t):e.set(t,i)}else if(e.has(r))if(void 0===i)e.delete(r);else{const t=e.get(r);if(void 0!==t){const n=t.filter((t=>t.output!==i&&(t.input!==s||void 0===s)));0===n.length?e.delete(r):e.set(r,n)}}for(const[n,r]of e)r.forEach((e=>{it(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},ot=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=q(e),{outputs:o}=V(t),a=b(t),u=o=>{const a=K(t),u=J(e);if(o){const e=Y(s,t,n);W(i,t,e,!1),r||tt(t)||a.connect(u,n)}else{const e=((t,e,n)=>y(t,(t=>t[0]===e&&t[1]===n)))(i,t,n);G(s,e,!1),r||tt(t)||a.disconnect(u,n)}};return!!z(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(u),P(t)?W(i,t,[n,u],!0):G(s,[t,n,u],!0),!0)},at=(t,e,n,r,i)=>{const[s,o]=((t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=V(e),o=X(i[r],t,n);if(null===o)return[w(s,t,n,r)[2],!1];return[o[2],!0]})(t,n,r,i);if(null!==s&&(Z(t,s),!o||e||tt(t)||Q(K(t),K(n),r,i)),P(n)){const{activeInputs:t}=V(n);C(n,t)}},ut=(t,e,n,r)=>{const[i,s]=((t,e,n)=>{const{activeInputs:r,passiveInputs:i}=q(e),s=X(r,t,n);if(null===s)return[Y(i,t,n)[1],!1];return[s[2],!0]})(t,n,r);null!==i&&(Z(t,i),!s||e||tt(t)||K(t).disconnect(J(n),r))};class ct{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,r)=>t.call(e,n,r,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const lt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function ht(t,e,n,r,i){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const s=t.getChannelData(r);if(0===e[n].byteLength)e[n]=s.slice(i,i+128);else{const t=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const pt=(t,e,n,r,i)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],r,i):0!==e[n].byteLength&&t.getChannelData(r).set(e[n],i)},ft=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const t=[],i="number"==typeof e?e:e[r];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));n.push(t)}return n},dt=async(t,e,n,r,i,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,u=r.channelCount*r.numberOfInputs,c=i.reduce(((t,e)=>t+e),0),l=0===c?null:n.createBuffer(c,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const h=V(t),f=await((t,e)=>{const n=v(p,t),r=K(e);return v(n,r)})(n,t),d=ft(r.numberOfInputs,r.channelCount),_=ft(r.numberOfOutputs,i),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let c=0;c<a;c+=128){if(r.numberOfInputs>0&&null!==e)for(let t=0;t<r.numberOfInputs;t+=1)for(let n=0;n<r.channelCount;n+=1)ht(e,d[t],n,n,c);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach((({name:t},n)=>{ht(e,m,t,u+n,c)}));for(let t=0;t<r.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===_[t][e].byteLength&&(_[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(c/n.sampleRate,n.sampleRate,(()=>f.process(t,_,m)));if(null!==l)for(let t=0,e=0;t<r.numberOfOutputs;t+=1){for(let n=0;n<i[t];n+=1)pt(l,_[t],n,e+n,c);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},_t={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},mt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},gt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},vt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},yt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},wt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},bt=(t,e,n)=>{const r=e[n];if(void 0===r)throw t();return r},xt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Tt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},kt=()=>new DOMException("","InvalidStateError"),Ct=()=>new DOMException("","InvalidAccessError"),St={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},At=(t,e,n,r,i,s,o,a,u,c,l)=>{const h=c.length;let p=a;for(let a=0;a<h;a+=1){let h=n[0]*c[a];for(let e=1;e<i;e+=1){const r=p-e&u-1;h+=n[e]*s[r],h-=t[e]*o[r]}for(let t=i;t<r;t+=1)h+=n[t]*s[p-t&u-1];for(let n=i;n<e;n+=1)h-=t[n]*o[p-n&u-1];s[p]=c[a],o[p]=h,p=p+1&u-1,l[a]=h}return p},Ot={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Et=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Rt={numberOfChannels:1},Dt=(t,e,n)=>{const r=e[n];void 0!==r&&r!==t[n]&&(t[n]=r)},Mt=(t,e)=>{Dt(t,e,"channelCount"),Dt(t,e,"channelCountMode"),Dt(t,e,"channelInterpretation")},It=t=>"function"==typeof t.getFloatTimeDomainData,Pt=(t,e,n)=>{const r=e[n];void 0!==r&&r!==t[n].value&&(t[n].value=r)},Nt=t=>{t.start=(e=>(n=0,r=0,i)=>{if("number"==typeof i&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},Vt=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},qt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),jt=async(t,e)=>new t(await(t=>new Promise(((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:t})=>{r.close(),i.close(),e(t)},r.onmessageerror=({data:t})=>{r.close(),i.close(),n(t)},i.postMessage(t)})))(e)),Lt=(t,e)=>{const n=t.createBiquadFilter();return Mt(n,e),Pt(n,e,"Q"),Pt(n,e,"detune"),Pt(n,e,"frequency"),Pt(n,e,"gain"),Dt(n,e,"type"),n},Ft=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Mt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw kt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw kt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw kt()}})})(n),n},Bt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ut=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Mt(n,e),Pt(n,e,"delayTime"),n},zt=(t,e)=>{const n=t.createGain();return Mt(n,e),Pt(n,e,"gain"),n};function Wt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Gt(t,e){let n=[0,0];for(let s=t.length-1;s>=0;s-=1)i=e,n=[(r=n)[0]*i[0]-r[1]*i[1],r[0]*i[1]+r[1]*i[0]],n[0]+=t[s];var r,i;return n}const Ht=(t,e,n,r)=>t.createScriptProcessor(e,n,r),$t=()=>new DOMException("","NotSupportedError"),Xt={numberOfChannels:1},Zt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Yt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Qt={disableNormalization:!1},Kt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Jt=()=>new DOMException("","UnknownError"),te={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ee=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ne=(t,e,n,r)=>{let i=Object.getPrototypeOf(t);for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(s),set:r(o)})},re=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ie=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},se=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},oe=(t,e)=>{const n=e.createGain();t.connect(n);const r=(e=>()=>{e.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Bt(t,n),t.stop=(e=>{let r=!1;return(i=0)=>{if(r)try{e.call(t,i)}catch{n.gain.setValueAtTime(0,i)}else e.call(t,i),r=!0}})(t.stop)},ae=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},ue=(t=>(e,n,[r,i,s],o)=>{t(e[i],[n,r,s],(t=>t[0]===n&&t[1]===r),o)})(z),ce=(t=>(e,n,[r,i,s],o)=>{const a=e.get(r);void 0===a?e.set(r,new Set([[i,n,s]])):t(a,[i,n,s],(t=>t[0]===i&&t[1]===n),o)})(z),le=(t=>(e,n,r,i)=>t(e[i],(t=>t[0]===n&&t[1]===r)))(y),he=new WeakMap,pe=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(he),fe=(de=new Map,_e=new WeakMap,(t,e)=>{const n=_e.get(t);if(void 0!==n)return n;const r=de.get(t);if(void 0!==r)return r;try{const n=e();return n instanceof Promise?(de.set(t,n),n.catch((()=>!1)).then((e=>(de.delete(t),_e.set(t,e),e)))):(_e.set(t,n),n)}catch{return _e.set(t,!1),!1}});var de,_e;const me="undefined"==typeof window?null:window,ge=((t,e)=>(n,r)=>{const i=n.createAnalyser();if(Mt(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Dt(i,r,"fftSize"),Dt(i,r,"maxDecibels"),Dt(i,r,"minDecibels"),Dt(i,r,"smoothingTimeConstant"),t(It,(()=>It(i)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let t=0;t<r;t+=1)e[t]=.0078125*(n[t]-128);return e}})(i),i})(fe,E),ve=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(V),ye=((t,e,n)=>async(r,i,s,o)=>{const a=t(r),u=[...o,r];await Promise.all(a.activeInputs.map(((t,o)=>Array.from(t).filter((([t])=>!u.includes(t))).map((async([t,a])=>{const c=e(t),l=await c.render(t,i,u),h=r.context.destination;n(t)||r===h&&n(r)||l.connect(s,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(V,ve,tt),we=((t,e,n)=>()=>{const r=new WeakMap;return{render(i,s,o){const a=r.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=e(i);if(!A(a,s)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(s,e)}return r.set(s,a),await n(i,s,a,o),a})(i,s,o)}}})(ge,K,ye),be=(xe=u,t=>{const e=xe.get(t);if(void 0===e)throw kt();return e});var xe;const Te=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(me),ke=(t=>e=>null!==t&&e instanceof t)(Te),Ce=new WeakMap,Se=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,r){if(null!==n){let i=this._listeners.get(n);void 0===i&&(i=t(this,n),"function"==typeof n&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(e,i,r)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const r=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===r?null:r,n)}})(ae),Ae=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(me),Oe=(t=>e=>null!==t&&e instanceof t)(Ae),Ee=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(me),Re=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(me),De=((t,e,n,r,i,o,a,u,l,h,p,f,d,_,m)=>class extends h{constructor(e,r,i,o){super(i),this._context=e,this._nativeAudioNode=i;const a=p(e);f(a)&&!0!==n(nt,(()=>nt(a)))&&st(i),s.set(this,i),c.set(this,new Set),"closed"!==e.state&&r&&x(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,s=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw i();const u=p(this._context),c=m(u);if(d(t)||_(t))throw o();if(B(t)){const i=K(t);try{const e=$(this._nativeAudioNode,i,n,s),r=et(this);(c||r)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!r&&et(t)&&x(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,n,s,c)){const e=l([this],t);rt(e,r(c))}return t}const h=J(t);if("playbackRate"===h.name)throw a();try{this._nativeAudioNode.connect(h,n),(c||et(this))&&this._nativeAudioNode.disconnect(h,n)}catch(t){if(12===t.code)throw o();throw t}if(ot(this,t,n,c)){const e=l([this],t);rt(e,r(c))}}disconnect(t,e,n){let r;const s=p(this._context),a=m(s);if(void 0===t)r=((t,e)=>{const n=V(t),r=[];for(const i of n.outputs)U(i)?at(t,e,...i):ut(t,e,...i),r.push(i[0]);return n.outputs.clear(),r})(this,a);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();r=((t,e,n)=>{const r=V(t),i=[];for(const s of r.outputs)s[1]===n&&(U(s)?at(t,e,...s):ut(t,e,...s),i.push(s[0]),r.outputs.delete(s));return i})(this,a,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(B(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw i();if(r=((t,e,n,r,i)=>{const s=V(t);return Array.from(s.outputs).filter((t=>!(t[0]!==n||void 0!==r&&t[1]!==r||void 0!==i&&t[2]!==i))).map((n=>(U(n)?at(t,e,...n):ut(t,e,...n),s.outputs.delete(n),n[0])))})(this,a,t,e,n),0===r.length)throw o()}for(const t of r){const e=l([this],t);rt(e,u)}}})((Me=r,(t,e,n)=>{const r=[];for(let t=0;t<n.numberOfInputs;t+=1)r.push(new Set);Me.set(t,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,r,i,s,o,a,u,c,l,h,p)=>(f,d,_,m,g)=>{const{activeInputs:v,passiveInputs:y}=s(d),{outputs:b}=s(f),T=a(f),k=s=>{const a=u(d),c=u(f);if(s){const e=w(y,f,_,m);t(v,f,e,!1),g||h(f)||n(c,a,_,m),p(d)&&x(d)}else{const t=r(v,f,_,m);e(y,m,t,!1),g||h(f)||i(c,a,_,m);const n=o(d);0===n?l(d)&&C(d,v):setTimeout((()=>{l(d)&&C(d,v)}),1e3*n)}};return!!c(b,[d,_,m],(t=>t[0]===d&&t[1]===_&&t[2]===m),!0)&&(T.add(k),l(f)?t(v,f,[_,m,k],!0):e(y,m,[f,_,k],!0),!0)})(ue,ce,$,le,Q,V,pe,b,K,z,P,tt,et),fe,((t,e,n,r,i,s)=>o=>(a,u)=>{const c=t.get(a);if(void 0===c){if(!o&&s(a)){const t=r(a),{outputs:s}=n(a);for(const n of s)if(U(n)){const i=r(n[0]);e(t,i,n[1],n[2])}else{const e=i(n[0]);t.disconnect(e,n[1])}}t.set(a,u)}else t.set(a,c+u)})(l,Q,V,K,J,P),E,Ct,$t,((t,e,n,r,i,s,o,a)=>(u,c)=>{const l=e.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=s(u.context),p=a(h);if(l===c){if(e.delete(u),!p&&o(u)){const e=r(u),{outputs:s}=n(u);for(const n of s)if(U(n)){const i=r(n[0]);t(e,i,n[1],n[2])}else{const t=i(n[0]);e.connect(t,n[1])}}}else e.set(u,l-c)})($,l,V,K,J,be,P,ke),((t,e,n)=>function r(i,s){const o=B(s)?s:n(t,s);if((t=>"delayTime"in t)(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>r([...i,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Ce,V,v),Se,be,Oe,Ee,Re,ke);var Me;const Ie=((t,e,n,r,i,s)=>class extends t{constructor(t,n){const o=i(t),a={...S,...n},u=r(o,a);super(t,!1,u,s(o)?e():null),this._nativeAnalyserNode=u}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(De,we,E,ge,be,ke),Pe=new WeakSet,Ne=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(me),Ve=(qe=new Uint32Array(1),t=>(qe[0]=t,qe[0]));var qe;const je=((t,e)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const u=n.length,c=n.getChannelData(a),l=r.length;for(let t=o<0?-o:0;t+o<u&&t<l;t+=1)r[t]=c[t+o]},n.copyToChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const u=n.length,c=n.getChannelData(a),l=r.length;for(let t=o<0?-o:0;t+o<u&&t<l;t+=1)c[t+o]=r[t]}})(Ve,E),Le=(t=>e=>{e.copyFromChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyToChannel)})(Ve),Fe=((t,e,n,r,i,s,o,a)=>{let u=null;return class c{constructor(c){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:p}={...D,...c};null===u&&(u=new i(1,1,44100));const f=null!==r&&e(s,s)?new r({length:l,numberOfChannels:h,sampleRate:p}):u.createBuffer(h,l,p);if(0===f.numberOfChannels)throw n();return"function"!=typeof f.copyFromChannel?(o(f),R(f)):e(O,(()=>O(f)))||a(f),t.add(f),f}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===c.prototype||t.has(e)}}})(Pe,fe,$t,Ne,Te,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Ne),je,Le),Be=(t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)})(zt),Ue=((t,e,n)=>async(r,i,s,o)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map((async([e,r])=>{const a=t(e),u=await a.render(e,i,o);n(e)||u.connect(s,r)})))})(ve,q,tt),ze=(t=>(e,n,r,i)=>t(n,e,r,i))(Ue),We=((t,e,n,r,i,s,o,a,u,c,l)=>(h,p)=>{const f=h.createBufferSource();return Mt(f,p),Pt(f,p,"playbackRate"),Dt(f,p,"buffer"),Dt(f,p,"loop"),Dt(f,p,"loopEnd"),Dt(f,p,"loopStart"),e(n,(()=>n(h)))||(t=>{t.start=(e=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw kt();e.call(t,r,i,s),n=!0}})(t.start)})(f),e(r,(()=>r(h)))||u(f),e(i,(()=>i(h)))||c(f,h),e(s,(()=>s(h)))||Nt(f),e(o,(()=>o(h)))||l(f,h),e(a,(()=>a(h)))||Vt(f),t(h,f),f})(Be,fe,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),re,ie,se,(t=>{t.start=(e=>(n=0,r=0,i)=>{const s=t.buffer,o=null===s?r:Math.min(s.duration,r);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)}),(t=>(e,n)=>{const r=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=r),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===r?null:n}),(t=>n=>t.call(e,null===n?r:n)))})(ne),oe),Ge=((t,e)=>(n,r,i,s)=>(t(r).replay(i),e(r,n,i,s)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(q),Ue),He=((t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(u,c,l){const h=s.get(c);return void 0!==h?Promise.resolve(h):(async(u,c,l)=>{let h=n(u);const p=A(h,c);if(!p){const t={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(c,t),null!==o&&h.start(...o),null!==a&&h.stop(a)}return s.set(c,h),p?await t(c,u.playbackRate,h.playbackRate,l):await r(c,u.playbackRate,h.playbackRate,l),await i(u,c,h,l),h})(u,c,l)}}})(ze,We,K,Ge,ye),$e=((t,n,r,i,s,o,a,u,c,l,h,p)=>(f,d,_,m=null,g=null)=>{const v=new e.AutomationEventList(_.defaultValue),y=d?i(v):null,w={get defaultValue(){return _.defaultValue},get maxValue(){return null===m?_.maxValue:m},get minValue(){return null===g?_.minValue:g},get value(){return _.value},set value(t){_.value=t,w.setValueAtTime(t,f.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof _.cancelAndHoldAtTime)null===y&&v.flush(f.context.currentTime),v.add(s(t)),_.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(f.context.currentTime),v.add(s(t));const n=Array.from(v).pop();_.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?_.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?_.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?_.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&_.setValueCurveAtTime(n.values,n.startTime,n.duration))}return w},cancelScheduledValues:t=>(null===y&&v.flush(f.context.currentTime),v.add(o(t)),_.cancelScheduledValues(t),w),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(f.context.currentTime),v.add(a(t,e)),_.exponentialRampToValueAtTime(t,e),w},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(f.context.currentTime),v.add(u(t,e)),_.linearRampToValueAtTime(t,e),w),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(f.context.currentTime),v.add(c(t,e,n)),_.setTargetAtTime(t,e,n),w),setValueAtTime:(t,e)=>(null===y&&v.flush(f.context.currentTime),v.add(l(t,e)),_.setValueAtTime(t,e),w),setValueCurveAtTime(t,e,n){const r=t instanceof Float32Array?t:new Float32Array(t);if(null!==p&&"webkitAudioContext"===p.name){const t=e+n,i=f.context.sampleRate,s=Math.ceil(e*i),o=Math.floor(t*i),a=o-s,u=new Float32Array(a);for(let t=0;t<a;t+=1){const o=(r.length-1)/n*((s+t)/i-e),a=Math.floor(o),c=Math.ceil(o);u[t]=a===c?r[a]:(1-(o-a))*r[a]+(1-(c-o))*r[c]}null===y&&v.flush(f.context.currentTime),v.add(h(u,e,n)),_.setValueCurveAtTime(u,e,n);const c=o/i;c<t&&w.setValueAtTime(u[u.length-1],c),w.setValueAtTime(r[r.length-1],t)}else null===y&&v.flush(f.context.currentTime),v.add(h(r,e,n)),_.setValueCurveAtTime(r,e,n);return w}};return r.set(w,_),n.set(w,f),t(w,y),w})((Xe=o,(t,e)=>{Xe.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Ce,a,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:r}=n;e.exponentialRampToValueAtTime(r,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:r}=n;e.linearRampToValueAtTime(r,t)}else if("setTarget"===n.type){const{startTime:t,target:r,timeConstant:i}=n;e.setTargetAtTime(r,t,i)}else if("setValue"===n.type){const{startTime:t,value:r}=n;e.setValueAtTime(r,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:r,values:i}=n;e.setValueCurveAtTime(i,r,t)}}}})),e.createCancelAndHoldAutomationEvent,e.createCancelScheduledValuesAutomationEvent,e.createExponentialRampToValueAutomationEvent,e.createLinearRampToValueAutomationEvent,e.createSetTargetAutomationEvent,e.createSetValueAutomationEvent,e.createSetValueCurveAutomationEvent,Ae);var Xe;const Ze=((t,e,n,r,i,s,o,a)=>class extends t{constructor(t,r){const a=s(t),u={...N,...r},c=i(a,u),l=o(a),h=l?e():null;super(t,!1,c,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==u.buffer,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=n(this,l,c.playbackRate,I,M)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){x(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(De,He,$e,kt,We,be,ke,ae),Ye=((t,e,n,r,i,s,o,a)=>class extends t{constructor(t,n){const r=s(t),u=o(r),c=i(r,n,u);super(t,!1,c,u?e(a):null),this._isNodeOfNativeOfflineAudioContext=u,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(De,(t=>{let e=null;return{render:(n,r,i)=>(null===e&&(e=(async(e,n,r)=>{const i=n.destination;return await t(e,n,i,r),i})(n,r,i)),e)}}),E,kt,((t,e)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=t(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{s.channelCount=e}catch(t){if(e>s.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),s.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o})(zt,ne),be,ke,ye),Qe=((t,e,n,r,i)=>()=>{const s=new WeakMap;return{render(o,a,u){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a,u)=>{let c=n(o);const l=A(c,a);if(!l){const t={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(a,t)}return s.set(a,c),l?(await t(a,o.Q,c.Q,u),await t(a,o.detune,c.detune,u),await t(a,o.frequency,c.frequency,u),await t(a,o.gain,c.gain,u)):(await r(a,o.Q,c.Q,u),await r(a,o.detune,c.detune,u),await r(a,o.frequency,c.frequency,u),await r(a,o.gain,c.gain,u)),await i(o,a,c,u),c})(o,a,u)}}})(ze,Lt,K,Ge,ye),Ke=(t=>(e,n)=>t.set(e,n))(he),Je=((t,e,n,r,i,s,o,a)=>class extends t{constructor(t,r){const u=s(t),c={..._t,...r},l=i(u,c),h=o(u);super(t,!1,l,h?n():null),this._Q=e(this,h,l.Q,I,M),this._detune=e(this,h,l.detune,1200*Math.log2(I),-1200*Math.log2(I)),this._frequency=e(this,h,l.frequency,t.sampleRate/2,0),this._gain=e(this,h,l.gain,40*Math.log10(I),M),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n),t.length!==e.length||e.length!==n.length)throw r()}})(De,$e,Qe,Ct,Lt,be,ke,Ke),tn=((t,e)=>(n,r,i)=>{const s=new Set;return n.connect=(i=>(o,a=0,u=0)=>{const c=0===s.size;if(e(o))return i.call(n,o,a,u),t(s,[o,a,u],(t=>t[0]===o&&t[1]===a&&t[2]===u),!0),c&&r(),o;i.call(n,o,a),t(s,[o,a],(t=>t[0]===o&&t[1]===a),!0),c&&r()})(n.connect),n.disconnect=(t=>(r,o,a)=>{const u=s.size>0;if(void 0===r)t.apply(n),s.clear();else if("number"==typeof r){t.call(n,r);for(const t of s)t[1]===r&&s.delete(t)}else{e(r)?t.call(n,r,o,a):t.call(n,r,o);for(const t of s)t[0]!==r||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||s.delete(t)}const c=0===s.size;u&&c&&i()})(n.disconnect),n})(z,Ee),en=((t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,(()=>{const t=r.numberOfInputs;for(let e=0;e<t;e+=1)i.connect(r,0,e)}),(()=>i.disconnect(r)))})(kt,tn),nn=((t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,i),Mt(i,r),i})(Ae,en),rn=((t,e,n,r,i)=>class extends t{constructor(t,s){const o=r(t),a={...mt,...s};super(t,!1,n(o,a),i(o)?e():null)}})(De,((t,e,n)=>()=>{const r=new WeakMap;return{render(i,s,o){const a=r.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=e(i);if(!A(a,s)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(s,e)}return r.set(s,a),await n(i,s,a,o),a})(i,s,o)}}})(nn,K,ye),nn,be,ke),sn=((t,e,n,r,i,s)=>class extends t{constructor(t,o){const a=r(t),u=s({...gt,...o});super(t,!1,n(a,u),i(a)?e():null)}})(De,((t,e,n)=>()=>{const r=new WeakMap;return{render(i,s,o){const a=r.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=e(i);if(!A(a,s)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(s,e)}return r.set(s,a),await n(i,s,a,o),a})(i,s,o)}}})(Ft,K,ye),Ft,be,ke,(t=>({...t,channelCount:t.numberOfOutputs}))),on=((t,e,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),u=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(i,{...o,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,u.buffer=a,u.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){c.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){c.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){c.channelInterpretation=t},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return u.onended},set onended(t){u.onended=t},addEventListener:(...t)=>u.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>u.dispatchEvent(t[0]),removeEventListener:(...t)=>u.removeEventListener(t[0],t[1],t[2]),start(t=0){u.start.call(u,t)},stop(t=0){u.stop.call(u,t)}};return t(i,u),r(Bt(h,c),(()=>u.connect(c)),(()=>u.disconnect(c)))})(Be,We,zt,tn),an=((t,e,n,r,i)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return Mt(a,o),Pt(a,o,"offset"),e(r,(()=>r(s)))||Nt(a),e(i,(()=>i(s)))||Vt(a),t(s,a),a})(Be,fe,on,re,se),un=((t,e,n,r,i,s,o)=>class extends t{constructor(t,o){const a=i(t),u={...vt,...o},c=r(a,u),l=s(a),h=l?n():null;super(t,!1,c,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=c,this._offset=e(this,l,c.offset,I,M),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){x(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(De,$e,((t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(u,c,l){const h=s.get(c);return void 0!==h?Promise.resolve(h):(async(u,c,l)=>{let h=n(u);const p=A(h,c);if(!p){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(c,t),null!==o&&h.start(o),null!==a&&h.stop(a)}return s.set(c,h),p?await t(c,u.offset,h.offset,l):await r(c,u.offset,h.offset,l),await i(u,c,h,l),h})(u,c,l)}}})(ze,an,K,Ge,ye),an,be,ke,ae),cn=((t,e)=>(n,r)=>{const i=n.createConvolver();if(Mt(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Dt(i,r,"buffer"),r.channelCount>2)throw t();if(e(i,"channelCount",(t=>()=>t.call(i)),(e=>n=>{if(n>2)throw t();return e.call(i,n)})),"max"===r.channelCountMode)throw t();return e(i,"channelCountMode",(t=>()=>t.call(i)),(e=>n=>{if("max"===n)throw t();return e.call(i,n)})),i})($t,ne),ln=((t,e,n,r,i,s)=>class extends t{constructor(t,o){const a=r(t),u={...yt,...o},c=n(a,u);super(t,!1,c,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=c,null!==u.buffer&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(De,((t,e,n)=>()=>{const r=new WeakMap;return{render(i,s,o){const a=r.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=e(i);if(!A(a,s)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(s,e)}return r.set(s,a),H(a)?await n(i,s,a.inputs[0],o):await n(i,s,a,o),a})(i,s,o)}}})(cn,K,ye),cn,be,ke,Ke),hn=((t,e,n,r,i,s,o)=>class extends t{constructor(t,a){const u=i(t),c={...wt,...a},l=r(u,c),h=s(u);super(t,!1,l,h?n(c.maxDelayTime):null),this._delayTime=e(this,h,l.delayTime),o(this,c.maxDelayTime)}get delayTime(){return this._delayTime}})(De,$e,((t,e,n,r,i)=>s=>{const o=new WeakMap;return{render(a,u,c){const l=o.get(u);return void 0!==l?Promise.resolve(l):(async(a,u,c)=>{let l=n(a);const h=A(l,u);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:s};l=e(u,t)}return o.set(u,l),h?await t(u,a.delayTime,l.delayTime,c):await r(u,a.delayTime,l.delayTime,c),await i(a,u,l,c),l})(a,u,c)}}})(ze,Ut,K,Ge,ye),Ut,be,ke,Ke),pn=(t=>(e,n)=>{const r=e.createDynamicsCompressor();if(Mt(r,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Pt(r,n,"attack"),Pt(r,n,"knee"),Pt(r,n,"ratio"),Pt(r,n,"release"),Pt(r,n,"threshold"),r})($t),fn=((t,e,n,r,i,s,o,a)=>class extends t{constructor(t,i){const u=s(t),c={...xt,...i},l=r(u,c),h=o(u);super(t,!1,l,h?n():null),this._attack=e(this,h,l.attack),this._knee=e(this,h,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,h,l.ratio),this._release=e(this,h,l.release),this._threshold=e(this,h,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(De,$e,((t,e,n,r,i)=>()=>{const s=new WeakMap;return{render(o,a,u){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a,u)=>{let c=n(o);const l=A(c,a);if(!l){const t={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(a,t)}return s.set(a,c),l?(await t(a,o.attack,c.attack,u),await t(a,o.knee,c.knee,u),await t(a,o.ratio,c.ratio,u),await t(a,o.release,c.release,u),await t(a,o.threshold,c.threshold,u)):(await r(a,o.attack,c.attack,u),await r(a,o.knee,c.knee,u),await r(a,o.ratio,c.ratio,u),await r(a,o.release,c.release,u),await r(a,o.threshold,c.threshold,u)),await i(o,a,c,u),c})(o,a,u)}}})(ze,pn,K,Ge,ye),pn,$t,be,ke,Ke),dn=((t,e,n,r,i,s)=>class extends t{constructor(t,o){const a=i(t),u={...Tt,...o},c=r(a,u),l=s(a);super(t,!1,c,l?n():null),this._gain=e(this,l,c.gain,I,M)}get gain(){return this._gain}})(De,$e,((t,e,n,r,i)=>()=>{const s=new WeakMap;return{render(o,a,u){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a,u)=>{let c=n(o);const l=A(c,a);if(!l){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(a,t)}return s.set(a,c),l?await t(a,o.gain,c.gain,u):await r(a,o.gain,c.gain,u),await i(o,a,c,u),c})(o,a,u)}}})(ze,zt,K,Ge,ye),zt,be,ke),_n=((t,e,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:u,feedback:c,feedforward:l})=>{const h=qt(s,i.sampleRate),p=c instanceof Float64Array?c:new Float64Array(c),f=l instanceof Float64Array?l:new Float64Array(l),d=p.length,_=f.length,m=Math.min(d,_);if(0===d||d>20)throw r();if(0===p[0])throw e();if(0===_||_>20)throw r();if(0===f[0])throw e();if(1!==p[0]){for(let t=0;t<_;t+=1)f[t]/=p[0];for(let t=1;t<d;t+=1)p[t]/=p[0]}const g=n(i,h,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=u;const v=[],y=[],w=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),w.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,r=e.numberOfChannels;for(let t=0;t<r;t+=1){const r=e.getChannelData(t),i=n.getChannelData(t);v[t]=At(p,d,f,_,m,y[t],w[t],v[t],32,r,i)}};const b=i.sampleRate/2;return Bt({get bufferSize(){return h},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,r){if(e.length!==n.length||n.length!==r.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/b),s=[Math.cos(i),Math.sin(i)],o=Wt(Gt(f,s),Gt(p,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),r[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Ct,kt,Ht,$t),mn=((t,e,n,r)=>i=>t(Et,(()=>Et(i)))?Promise.resolve(t(r,r)).then((t=>{if(!t){const t=n(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()})):new Promise((t=>{const n=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(i.destination),i.startRendering()})))(fe,zt,Ht,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{r.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(zt,Te)),gn=((t,e,n,r,i)=>(s,o)=>{const a=new WeakMap;let u=null;const c=async(c,l,h)=>{let p=null,f=e(c);const d=A(f,l);if(void 0===l.createIIRFilter?p=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(f=l.createIIRFilter(o,s)),a.set(l,null===p?f:p),null!==p){if(null===u){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(c.context.destination.channelCount,c.context.length,l.sampleRate);u=(async()=>{await r(c,t,t.destination,h);return((t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,u=Math.min(o,a);if(1!==i[0]){for(let t=0;t<o;t+=1)s[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const c=new Float32Array(32),l=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const n=t.getChannelData(e),r=h.getChannelData(e);c.fill(0),l.fill(0),At(i,o,s,a,u,c,l,0,32,n,r)}return h})(await i(t),l,s,o)})()}const t=await u;return p.buffer=t,p.start(0),p}return await r(c,l,f,h),f};return{render(t,e,n){const r=a.get(e);return void 0!==r?Promise.resolve(r):c(t,e,n)}}})(We,K,Te,ye,mn),vn=((t,e,n,r,i,s)=>class extends t{constructor(t,o){const a=r(t),u=i(a),c={...St,...o},l=e(a,u?null:t.baseLatency,c);super(t,!1,l,u?n(c.feedback,c.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw Ct();return e.call(t,n,r,i)})})(l),this._nativeIIRFilterNode=l,s(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(De,(t=>(e,n,r)=>{if(void 0===e.createIIRFilter)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Mt(i,r),i})(_n),gn,be,ke,Ke),yn=((t,e,n,r,i)=>(s,o)=>{const a=o.listener,{forwardX:u,forwardY:c,forwardZ:l,positionX:h,positionY:p,positionZ:f,upX:d,upY:_,upZ:m}=void 0===a.forwardX?(()=>{const u=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),c=i(o),l=r(o,256,9,0),h=(e,r)=>{const i=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});return i.connect(u,0,e),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>r}),t({context:s},c,i.offset,I,M)};let p=[0,0,-1,0,1,0],f=[0,0,0];return l.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some(((t,e)=>t!==p[e]))&&(a.setOrientation(...e),p=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some(((t,e)=>t!==f[e]))&&(a.setPosition(...n),f=n)},u.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}})():a;return{get forwardX(){return u},get forwardY(){return c},get forwardZ(){return l},get positionX(){return h},get positionY(){return p},get positionZ(){return f},get upX(){return d},get upY(){return _},get upZ(){return m}}})($e,nn,an,Ht,ke),wn=new WeakMap,bn=((t,e,n,r,i,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,u.set(this,n),r(n)&&i.set(n,new Set),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Ye,yn,Se,ke,wn,ae),xn=((t,e,n,r,i,s)=>(o,a)=>{const u=o.createOscillator();return Mt(u,a),Pt(u,a,"detune"),Pt(u,a,"frequency"),void 0!==a.periodicWave?u.setPeriodicWave(a.periodicWave):Dt(u,a,"type"),e(n,(()=>n(o)))||Nt(u),e(r,(()=>r(o)))||s(u,o),e(i,(()=>i(o)))||Vt(u),t(o,u),u})(Be,fe,re,ie,se,oe),Tn=((t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,u=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){u=t},render(c,l,h){const p=s.get(l);return void 0!==p?Promise.resolve(p):(async(c,l,h)=>{let p=n(c);const f=A(p,l);if(!f){const t={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===o?void 0:o,type:p.type};p=e(l,t),null!==a&&p.start(a),null!==u&&p.stop(u)}return s.set(l,p),f?(await t(l,c.detune,p.detune,h),await t(l,c.frequency,p.frequency,h)):(await r(l,c.detune,p.detune,h),await r(l,c.frequency,p.frequency,h)),await i(c,l,p,h),p})(c,l,h)}}})(ze,xn,K,Ge,ye),kn=((t,e,n,r,i,s,o)=>class extends t{constructor(t,o){const a=i(t),u={...Zt,...o},c=n(a,u),l=s(a),h=l?r():null,p=t.sampleRate/2;super(t,!1,c,h),this._detune=e(this,l,c.detune,153600,-153600),this._frequency=e(this,l,c.frequency,p,-p),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==u.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=u.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){x(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(De,$e,xn,Tn,be,ke,ae),Cn=(t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}})(We),Sn=((t,e,n,r,i)=>(s,{curve:o,oversample:a,...u})=>{const c=s.createWaveShaper(),l=s.createWaveShaper();Mt(c,u),Mt(l,u);const h=n(s,{...u,gain:1}),p=n(s,{...u,gain:-1}),f=n(s,{...u,gain:1}),d=n(s,{...u,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(t){h.channelCount=t,p.channelCount=t,c.channelCount=t,f.channelCount=t,l.channelCount=t,d.channelCount=t},get channelCountMode(){return c.channelCountMode},set channelCountMode(t){h.channelCountMode=t,p.channelCountMode=t,c.channelCountMode=t,f.channelCountMode=t,l.channelCountMode=t,d.channelCountMode=t},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,p.channelInterpretation=t,c.channelInterpretation=t,f.channelInterpretation=t,l.channelInterpretation=t,d.channelInterpretation=t},get context(){return c.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)c.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),r=new Float32Array(t+2-t%2);e[0]=n[0],r[0]=-n[t-1];const i=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<i;o+=1){const a=o/i*s,u=Math.floor(a),c=Math.ceil(a);e[o]=u===c?n[u]:(1-(a-u))*n[u]+(1-(c-a))*n[c],r[o]=u===c?-n[t-1-u]:-(1-(a-u))*n[t-1-u]-(1-(c-a))*n[t-1-c]}e[i]=t%2==1?n[i-1]:(n[i-2]+n[i-1])/2,c.curve=e,l.curve=r}g=n,m&&(r(g)&&null===_?_=t(s,h):null!==_&&(_(),_=null))},get inputs(){return[h]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(t){c.oversample=t,l.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);return i(Bt(v,f),(()=>{h.connect(c).connect(f),h.connect(p).connect(l).connect(d).connect(f),m=!0,r(g)&&(_=t(s,h))}),(()=>{h.disconnect(c),c.disconnect(f),h.disconnect(p),p.disconnect(l),l.disconnect(d),d.disconnect(f),m=!1,null!==_&&(_(),_=null)}))})(Cn,kt,zt,ee,tn),An=((t,e,n,r,i,s,o)=>(a,u)=>{const c=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name)return n(a,u);Mt(c,u);const l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw e();Dt(c,{curve:l},"curve"),Dt(c,u,"oversample");let h=null,p=!1;o(c,"curve",(t=>()=>t.call(c)),(e=>n=>(e.call(c,n),p&&(r(n)&&null===h?h=t(a,c):r(n)||null===h||(h(),h=null)),n)));return i(c,(()=>{p=!0,r(c.curve)&&(h=t(a,c))}),(()=>{p=!1,null!==h&&(h(),h=null)}))})(Cn,kt,Sn,ee,tn,Ae,ne),On=(t=>(e,n)=>{const r=e.createPanner();return void 0===r.orientationX?t(e,n):(Mt(r,n),Pt(r,n,"orientationX"),Pt(r,n,"orientationY"),Pt(r,n,"orientationZ"),Pt(r,n,"positionX"),Pt(r,n,"positionY"),Pt(r,n,"positionZ"),Dt(r,n,"coneInnerAngle"),Dt(r,n,"coneOuterAngle"),Dt(r,n,"coneOuterGain"),Dt(r,n,"distanceModel"),Dt(r,n,"maxDistance"),Dt(r,n,"panningModel"),Dt(r,n,"refDistance"),Dt(r,n,"rolloffFactor"),r)})(((t,e,n,r,i,s,o,a,u)=>(c,{coneInnerAngle:l,coneOuterAngle:h,coneOuterGain:p,distanceModel:f,maxDistance:d,orientationX:_,orientationY:m,orientationZ:g,panningModel:v,positionX:y,positionY:w,positionZ:b,refDistance:x,rolloffFactor:T,...k})=>{const C=c.createPanner();if(k.channelCount>2)throw o();if("max"===k.channelCountMode)throw o();Mt(C,k);const S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(c,{...S,channelInterpretation:"speakers",numberOfInputs:6}),O=r(c,{...k,gain:1}),E=r(c,{...S,gain:1}),R=r(c,{...S,gain:0}),D=r(c,{...S,gain:0}),M=r(c,{...S,gain:0}),I=r(c,{...S,gain:0}),P=r(c,{...S,gain:0}),N=i(c,256,6,1),V=s(c,{...S,curve:new Float32Array([1,1]),oversample:"none"});let q=[_,m,g],j=[y,w,b];N.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some(((t,e)=>t!==q[e]))&&(C.setOrientation(...e),q=e);const n=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some(((t,e)=>t!==j[e]))&&(C.setPosition(...n),j=n)},Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0});const L={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,C.channelCount=t},get channelCountMode(){return C.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,C.channelCountMode=t},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,C.channelInterpretation=t},get coneInnerAngle(){return C.coneInnerAngle},set coneInnerAngle(t){C.coneInnerAngle=t},get coneOuterAngle(){return C.coneOuterAngle},set coneOuterAngle(t){C.coneOuterAngle=t},get coneOuterGain(){return C.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();C.coneOuterGain=t},get context(){return C.context},get distanceModel(){return C.distanceModel},set distanceModel(t){C.distanceModel=t},get inputs(){return[O]},get maxDistance(){return C.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;C.maxDistance=t},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return R.gain},get orientationZ(){return D.gain},get panningModel(){return C.panningModel},set panningModel(t){C.panningModel=t},get positionX(){return M.gain},get positionY(){return I.gain},get positionZ(){return P.gain},get refDistance(){return C.refDistance},set refDistance(t){if(t<0)throw new RangeError;C.refDistance=t},get rolloffFactor(){return C.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;C.rolloffFactor=t},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])};l!==L.coneInnerAngle&&(L.coneInnerAngle=l),h!==L.coneOuterAngle&&(L.coneOuterAngle=h),p!==L.coneOuterGain&&(L.coneOuterGain=p),f!==L.distanceModel&&(L.distanceModel=f),d!==L.maxDistance&&(L.maxDistance=d),_!==L.orientationX.value&&(L.orientationX.value=_),m!==L.orientationY.value&&(L.orientationY.value=m),g!==L.orientationZ.value&&(L.orientationZ.value=g),v!==L.panningModel&&(L.panningModel=v),y!==L.positionX.value&&(L.positionX.value=y),w!==L.positionY.value&&(L.positionY.value=w),b!==L.positionZ.value&&(L.positionZ.value=b),x!==L.refDistance&&(L.refDistance=x),T!==L.rolloffFactor&&(L.rolloffFactor=T),1===q[0]&&0===q[1]&&0===q[2]||C.setOrientation(...q),0===j[0]&&0===j[1]&&0===j[2]||C.setPosition(...j);return u(Bt(L,C),(()=>{O.connect(C),t(O,V,0,0),V.connect(E).connect(A,0,0),V.connect(R).connect(A,0,1),V.connect(D).connect(A,0,2),V.connect(M).connect(A,0,3),V.connect(I).connect(A,0,4),V.connect(P).connect(A,0,5),A.connect(N).connect(c.destination)}),(()=>{O.disconnect(C),a(O,V,0,0),V.disconnect(E),E.disconnect(A),V.disconnect(R),R.disconnect(A),V.disconnect(D),D.disconnect(A),V.disconnect(M),M.disconnect(A),V.disconnect(I),I.disconnect(A),V.disconnect(P),P.disconnect(A),A.disconnect(N),N.disconnect(c.destination)}))})($,kt,nn,zt,Ht,An,$t,Q,tn)),En=((t,e,n,r,i,s,o,a,u,c)=>()=>{const l=new WeakMap;let h=null;return{render(p,f,d){const _=l.get(f);return void 0!==_?Promise.resolve(_):(async(p,f,d)=>{let _=null,m=s(p);const g={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},v={...g,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},y=A(m,f);if("bufferSize"in m)_=r(f,{...g,gain:1});else if(!y){const t={...v,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(f,t)}if(l.set(f,null===_?m:_),null!==_){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,p.context.length,f.sampleRate),r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});r.connect(t.destination),h=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,r)=>{const i=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await a(t,e,i.offset,d),i})));for(let t=0;t<6;t+=1)e[t].connect(r,0,t),e[t].start(0);return c(t)})()}const t=await h,s=r(f,{...g,gain:1});await u(p,f,s,d);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let m=[l[0][0],l[1][0],l[2][0]],y=[l[3][0],l[4][0],l[5][0]],w=r(f,{...g,gain:1}),b=i(f,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]});s.connect(w).connect(b.inputs[0]),b.connect(_);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==m[e]))||n.some(((t,e)=>t!==y[e]))){m=t,y=n;const o=e/f.sampleRate;w.gain.setValueAtTime(0,o),w=r(f,{...g,gain:0}),b=i(f,{...v,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),w.gain.setValueAtTime(1,o),s.connect(w).connect(b.inputs[0]),b.connect(_)}}return _}return y?(await t(f,p.orientationX,m.orientationX,d),await t(f,p.orientationY,m.orientationY,d),await t(f,p.orientationZ,m.orientationZ,d),await t(f,p.positionX,m.positionX,d),await t(f,p.positionY,m.positionY,d),await t(f,p.positionZ,m.positionZ,d)):(await a(f,p.orientationX,m.orientationX,d),await a(f,p.orientationY,m.orientationY,d),await a(f,p.orientationZ,m.orientationZ,d),await a(f,p.positionX,m.positionX,d),await a(f,p.positionY,m.positionY,d),await a(f,p.positionZ,m.positionZ,d)),H(m)?await u(p,f,m.inputs[0],d):await u(p,f,m,d),m})(p,f,d)}}})(ze,nn,an,zt,On,K,Te,Ge,ye,mn),Rn=((t,e,n,r,i,s,o)=>class extends t{constructor(t,a){const u=i(t),c={...Yt,...a},l=n(u,c),h=s(u);super(t,!1,l,h?r():null),this._nativePannerNode=l,this._orientationX=e(this,h,l.orientationX,I,M),this._orientationY=e(this,h,l.orientationY,I,M),this._orientationZ=e(this,h,l.orientationZ,I,M),this._positionX=e(this,h,l.positionX,I,M),this._positionY=e(this,h,l.positionY,I,M),this._positionZ=e(this,h,l.positionZ,I,M),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(De,$e,On,En,be,ke,Ke),Dn=((t,e,n,r)=>class i{constructor(i,s){const o=e(i),a=r({...Qt,...s}),u=t(o,a);return n.add(u),u}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a})(E),be,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Mn=((t,e)=>(n,r)=>{const i=r.channelCountMode;if("clamped-max"===i)throw e();if(void 0===n.createStereoPanner)return t(n,r);const s=n.createStereoPanner();return Mt(s,r),Pt(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),s})(((t,e,n,r,i,s)=>{const o=16385,a=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...c,oversample:"none"},h=(t,s,h,p,f)=>{if(1===s)return((t,e,i,s)=>{const h=new Float32Array(o),p=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*u;h[t]=Math.cos(e),p[t]=Math.sin(e)}const f=n(t,{...c,gain:0}),d=r(t,{...l,curve:h}),_=r(t,{...l,curve:a}),m=n(t,{...c,gain:0}),g=r(t,{...l,curve:p});return{connectGraph(){e.connect(f),e.connect(_.inputs[0]),e.connect(m),_.connect(i),i.connect(d.inputs[0]),i.connect(g.inputs[0]),d.connect(f.gain),g.connect(m.gain),f.connect(s,0,0),m.connect(s,0,1)},disconnectGraph(){e.disconnect(f),e.disconnect(_.inputs[0]),e.disconnect(m),_.disconnect(i),i.disconnect(d.inputs[0]),i.disconnect(g.inputs[0]),d.disconnect(f.gain),g.disconnect(m.gain),f.disconnect(s,0,0),m.disconnect(s,0,1)}}})(t,h,p,f);if(2===s)return((t,i,s,h)=>{const p=new Float32Array(o),f=new Float32Array(o),d=new Float32Array(o),_=new Float32Array(o),m=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>m){const e=(t-m)/(16384-m)*u;p[t]=Math.cos(e),f[t]=Math.sin(e),d[t]=0,_[t]=1}else{const e=t/(16384-m)*u;p[t]=1,f[t]=0,d[t]=Math.cos(e),_[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...c,gain:0}),y=r(t,{...l,curve:p}),w=n(t,{...c,gain:0}),b=r(t,{...l,curve:f}),x=r(t,{...l,curve:a}),T=n(t,{...c,gain:0}),k=r(t,{...l,curve:d}),C=n(t,{...c,gain:0}),S=r(t,{...l,curve:_});return{connectGraph(){i.connect(g),i.connect(x.inputs[0]),g.connect(v,0),g.connect(w,0),g.connect(T,1),g.connect(C,1),x.connect(s),s.connect(y.inputs[0]),s.connect(b.inputs[0]),s.connect(k.inputs[0]),s.connect(S.inputs[0]),y.connect(v.gain),b.connect(w.gain),k.connect(T.gain),S.connect(C.gain),v.connect(h,0,0),T.connect(h,0,0),w.connect(h,0,1),C.connect(h,0,1)},disconnectGraph(){i.disconnect(g),i.disconnect(x.inputs[0]),g.disconnect(v,0),g.disconnect(w,0),g.disconnect(T,1),g.disconnect(C,1),x.disconnect(s),s.disconnect(y.inputs[0]),s.disconnect(b.inputs[0]),s.disconnect(k.inputs[0]),s.disconnect(S.inputs[0]),y.disconnect(v.gain),b.disconnect(w.gain),k.disconnect(T.gain),S.disconnect(C.gain),v.disconnect(h,0,0),T.disconnect(h,0,0),w.disconnect(h,0,1),C.disconnect(h,0,1)}}})(t,h,p,f);throw i()};return(e,{channelCount:r,channelCountMode:o,pan:a,...u})=>{if("max"===o)throw i();const c=t(e,{...u,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...u,channelCount:r,channelCountMode:o,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:f,disconnectGraph:d}=h(e,r,l,p,c);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(m&&d(),({connectGraph:f,disconnectGraph:d}=h(e,t,l,p,c)),m&&f()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return s(Bt(_,c),(()=>{f(),m=!0}),(()=>{d(),m=!1}))}})(nn,Ft,zt,An,$t,tn),$t),In=((t,e,n,r,i)=>()=>{const s=new WeakMap;return{render(o,a,u){const c=s.get(a);return void 0!==c?Promise.resolve(c):(async(o,a,u)=>{let c=n(o);const l=A(c,a);if(!l){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(a,t)}return s.set(a,c),l?await t(a,o.pan,c.pan,u):await r(a,o.pan,c.pan,u),H(c)?await i(o,a,c.inputs[0],u):await i(o,a,c,u),c})(o,a,u)}}})(ze,Mn,K,Ge,ye),Pn=((t,e,n,r,i,s)=>class extends t{constructor(t,o){const a=i(t),u={...Kt,...o},c=n(a,u),l=s(a);super(t,!1,c,l?r():null),this._pan=e(this,l,c.pan)}get pan(){return this._pan}})(De,$e,Mn,In,be,ke),Nn=((t,e,n)=>()=>{const r=new WeakMap;return{render(i,s,o){const a=r.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=e(i);if(!A(a,s)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(s,e)}return r.set(s,a),H(a)?await n(i,s,a.inputs[0],o):await n(i,s,a,o),a})(i,s,o)}}})(An,K,ye),Vn=((t,e,n,r,i,s,o)=>class extends t{constructor(t,e){const a=i(t),u={...te,...e},c=n(a,u);super(t,!0,c,s(a)?r():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(De,kt,An,Nn,be,ke,Ke),qn=(t=>null!==t&&t.isSecureContext)(me),jn=(t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return r()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(me),Ln=new WeakMap,Fn=((t,e)=>n=>{let r=t.get(n);if(void 0!==r)return r;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,8e3),t.set(n,r),r})(Ln,Te),Bn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(me),Un=qn?((t,e,n,r,i,s,o,a,u,c,l,p)=>(f,d,v={credentials:"omit"})=>{const y=s(f),w=new URL(d,p.location.href).toString();if(void 0!==y.audioWorklet)return Promise.all([i(d),Promise.resolve(t(l,l))]).then((([t,e])=>{const[n,r]=_(t,w),i=e?r:r.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),s=new Blob([`${n};(registerProcessor=>{${i}\n})((n,p)=>registerProcessor(n,class extends p{${e?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${e?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(s);return y.audioWorklet.addModule(u,v).then((()=>{if(a(y))return;return o(y).audioWorklet.addModule(u,v)})).finally((()=>URL.revokeObjectURL(u)))}));const b=c.get(f);if(void 0!==b&&b.has(d))return Promise.resolve();const x=u.get(f);if(void 0!==x){const t=x.get(d);if(void 0!==t)return t}const T=i(d).then((t=>{const[e,r]=_(t,w);return n(`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`)})).then((()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;r(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const r=h.get(y);if(void 0!==r){if(r.has(t))throw e();g(n),m(n.parameterDescriptors),r.set(t,n)}else g(n),m(n.parameterDescriptors),h.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))}));return void 0===x?u.set(f,new Map([[d,T]])):x.set(d,T),T.then((()=>{const t=c.get(f);void 0===t?c.set(f,new Set([d])):t.add(d)})).finally((()=>{const t=u.get(f);void 0!==t&&t.delete(d)})),T})(fe,$t,(t=>e=>new Promise(((n,r)=>{if(null===t)return void r(new SyntaxError);const i=t.document.head;if(null===i)r(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),u=t.onerror,c=()=>{t.onerror=u,URL.revokeObjectURL(a)};t.onerror=(e,n,i,s,o)=>n===a||n===t.location.href&&1===i&&1===s?(c(),r(o),!1):null!==u?u(e,n,i,s,o):void 0,s.onerror=()=>{c(),r(new SyntaxError)},s.onload=()=>{c(),n()},s.src=a,s.type="module",i.appendChild(s)}})))(me),jn,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch{}throw t()})((()=>new DOMException("","AbortError"))),be,Fn,ke,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,8e3),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const e=new t(r,"a",{numberOfOutputs:0}),n=r.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),await r.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return s&&!o})(Bn,Te),me):void 0,zn=((t,e)=>n=>t(n)||e(n))(Oe,ke),Wn=((t,e,n,r,i,s,o,a,u,c,l)=>(h,p)=>{const f=o(h)?h:s(h);if(i.has(p)){const t=n();return Promise.reject(t)}try{i.add(p)}catch{}return e(u,(()=>u(f)))?f.decodeAudioData(p).then((n=>(e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const i=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(p)}catch{}},s=t=>{n(t),i()};try{f.decodeAudioData(p,(n=>{"function"!=typeof n.copyFromChannel&&(c(n),R(n)),t.add(n),i(),e(n)}),(t=>{s(null===t?r():t)}))}catch(t){s(t)}}))})(Pe,fe,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,be,zn,O,Et,je,Le),Gn=((t,e,n,r,i,s,o,a,u,c,l,h,p,f,d,_,m,g,v,y)=>class extends d{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,r){return new n({length:e,numberOfChannels:t,sampleRate:r})}createBufferSource(){return new r(this)}createChannelMerger(t=6){return new s(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new u(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new f(this,{feedback:e,feedforward:t})}createOscillator(){return new _(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return c(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t))).catch((t=>{throw"function"==typeof n&&n(t),t}))}})(Un,Ie,Fe,Ze,Je,rn,sn,un,ln,Wn,hn,fn,dn,vn,bn,kn,Rn,Dn,Pn,Vn),Hn=((t,e,n,r)=>class extends t{constructor(t,i){const s=n(t),o=e(s,i);if(r(s))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(De,((t,e)=>t.createMediaElementSource(e.mediaElement)),be,ke),$n=((t,e,n,r)=>class extends t{constructor(t,i){const s=n(t);if(r(s))throw new TypeError;const o={...Ot,...i},a=e(s,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(De,((t,e)=>{const n=t.createMediaStreamDestination();return Mt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),be,ke),Xn=((t,e,n,r)=>class extends t{constructor(t,i){const s=n(t),o=e(s,i);if(r(s))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(De,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i}),be,ke),Zn=((t,e,n)=>class extends t{constructor(t,r){const i=n(t);super(t,!0,e(i,r),null)}})(De,((t,e)=>(n,{mediaStreamTrack:r})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if("audio"!==r.kind)throw t();if(e(n))throw new TypeError;return s})(kt,ke),be),Yn=((t,e,n,r,i,s,o,a,u)=>class extends t{constructor(t={}){if(null===u)throw new Error("Missing the native AudioContext constructor.");const e=new u(t);if(null===e)throw r();if(!F(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:i}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/s:"interactive"===i||void 0===i?256/s:"playback"===i?1024/s:128*Math.max(2,Math.min(128,Math.round(i*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===u.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),L(this)})))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(Gn,kt,$t,Jt,Hn,$n,Xn,Zn,Ae),Qn=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(wn),Kn=(t=>(e,n)=>{t(e).add(n)})(Qn),Jn=(t=>(e,n,r=0,i=0)=>{const s=e[r];if(void 0===s)throw t();return it(n)?s.connect(n,0,i):s.connect(n,0)})(E),tr=(t=>(e,n)=>{t(e).delete(n)})(Qn),er=(t=>(e,n,r,i=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?bt(t,e,n).disconnect():it(n)?void 0===r?e.forEach((t=>t.disconnect(n))):void 0===i?bt(t,e,r).disconnect(n,0):bt(t,e,r).disconnect(n,0,i):void 0===r?e.forEach((t=>t.disconnect(n))):bt(t,e,r).disconnect(n,0))(E),nr=new WeakMap,rr=((t,e)=>n=>e(t,n))(nr,v),ir=((t,e,n,r,i,s,o,a,u,c,l,h,f)=>(d,_,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw u();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some((t=>t<1)))throw u();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw u();const y=g.channelCount*g.numberOfInputs,w=v.reduce(((t,e)=>t+e),0),b=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+b>6||w>6)throw u();const x=new MessageChannel,T=[],k=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(o(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),k.push(i(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const C=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:r}of m.parameterDescriptors){const i=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[r]?g.parameterData[r]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?I:e},minValue:{get:()=>void 0===n?M:n}}),C.push(i)}const S=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+b)}),A=qt(_,d.sampleRate),O=a(d,A,y+b,Math.max(1,w)),E=i(d,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),R=[];for(let t=0;t<g.numberOfOutputs;t+=1)R.push(r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[t].connect(S,e,t*g.channelCount+e)}const D=new ct(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const n=C[e];return n.connect(S,0,y+e),n.start(0),[t,n.offset]})));S.connect(O);let P=g.channelInterpretation,N=null;const V=0===g.numberOfOutputs?[O]:R,q={get bufferSize(){return A},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return P},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;P=t},get context(){return O.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return N},set onprocessorerror(t){"function"==typeof N&&q.removeEventListener("processorerror",N),N="function"==typeof t?t:null,"function"==typeof N&&q.addEventListener("processorerror",N)},get parameters(){return D},get port(){return x.port2},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,V),disconnect:c.bind(null,V),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])},j=new Map;var L,F;x.port1.addEventListener=(L=x.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=j.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(d.currentTime,d.sampleRate,(()=>e(t)))},j.set(e,t[1]))}}return L.call(x.port1,t[0],t[1],t[2])}),x.port1.removeEventListener=(F=x.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=j.get(t[1]);void 0!==e&&(j.delete(t[1]),t[1]=e)}return F.call(x.port1,t[0],t[1],t[2])});let B=null;Object.defineProperty(x.port1,"onmessage",{get:()=>B,set:t=>{"function"==typeof B&&x.port1.removeEventListener("message",B),B="function"==typeof t?t:null,"function"==typeof B&&(x.port1.addEventListener("message",B),x.port1.start())}}),m.prototype.port=x.port1;let U=null;((t,e,n,r)=>{let i=p.get(t);void 0===i&&(i=new WeakMap,p.set(t,i));const s=jt(n,r);return i.set(e,s),s})(d,q,m,g).then((t=>U=t));const z=ft(g.numberOfInputs,g.channelCount),W=ft(g.numberOfOutputs,v),G=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let H=!0;const $=()=>{g.numberOfOutputs>0&&O.disconnect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=R[t];for(let r=0;r<v[t];r+=1)E.disconnect(n,e+r,r);e+=v[t]}},X=new Map;O.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==U){const n=h(q);for(let r=0;r<A;r+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)ht(t,z[e],n,n,r);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},n)=>{ht(t,G,e,y+n,r)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===W[t][e].byteLength&&(W[t][e]=new Float32Array(128));try{const t=z.map(((t,e)=>{if(n[e].size>0)return X.set(e,A/128),t;const r=X.get(e);return void 0===r?[]:(t.every((t=>t.every((t=>0===t))))&&(1===r?X.delete(e):X.set(e,r-1)),t)})),i=l(d.currentTime+r/d.sampleRate,d.sampleRate,(()=>U.process(t,W,G)));H=i;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let i=0;i<v[t];i+=1)pt(e,W[t],i,n+i,r);n+=v[t]}}catch(t){H=!1,q.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!H){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[r].disconnect(S,e,t*g.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=C[e];t.disconnect(S,0,y+e),t.stop()}}S.disconnect(O),O.onaudioprocess=null,Z?$():K();break}}}};let Z=!1;const Y=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Q=()=>O.connect(Y).connect(d.destination),K=()=>{O.disconnect(Y),Y.disconnect()};return Q(),f(q,(()=>{if(H){K(),g.numberOfOutputs>0&&O.connect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=R[t];for(let r=0;r<v[t];r+=1)E.connect(n,e+r,r);e+=v[t]}}Z=!0}),(()=>{H&&(Q(),$()),Z=!1}))})(Jn,E,kt,nn,Ft,an,zt,Ht,$t,er,jn,rr,tn),sr=((t,e,n,r,i)=>(s,o,a,u,c,l)=>{if(null!==a)try{const e=new a(s,u,l),r=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=r.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},r.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=r.get(t[1]);void 0!==e&&(r.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(s.destination);return i(e,(()=>t.disconnect()),(()=>t.connect(s.destination)))}return e}catch(t){if(11===t.code)throw r();throw t}var h,p;if(void 0===c)throw r();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(s,o,c,l)})(kt,ir,zt,$t,tn),or=((t,e,n,r,i,s,o,a,u,c,l,h,p,f,d,_)=>(m,g,v)=>{const y=new WeakMap;let w=null;return{render(b,x,T){a(x,b);const k=y.get(x);return void 0!==k?Promise.resolve(k):(async(a,b,x)=>{let T=l(a),k=null;const C=A(T,b),S=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===h){const t=S.reduce(((t,e)=>t+e),0),n=i(b,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let t=0;t<a.numberOfOutputs;t+=1)s.push(r(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[t]}));const c=o(b,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});c.connect=e.bind(null,s),c.disconnect=u.bind(null,s),k=[n,s,c]}else C||(T=new h(b,m));if(y.set(b,null===k?T:k[2]),null!==k){if(null===w){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,u=async()=>{const u=new p(n,128*Math.ceil(a.context.length/128),b.sampleRate),c=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)c.push(o(u,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(i(u,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=s(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await f(u,t,e.offset,x),e}))),m=r(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){c[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(m,e,t*g.channelCount+e)}for(const[e,n]of h.entries())n.connect(m,0,t+e),n.start(0);return m.connect(u.destination),await Promise.all(c.map((t=>d(a,u,t,x)))),_(u)};w=dt(a,0===n?null:await u(),b,g,S,v,c)}const t=await w,e=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[u,l,h]=k;null!==t&&(e.buffer=t,e.start(0)),e.connect(u);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let r=0;r<S[t];r+=1)u.connect(n,e+r,r);e+=S[t]}return h}if(C)for(const[e,n]of a.parameters.entries())await t(b,n,T.parameters.get(e),x);else for(const[t,e]of a.parameters.entries())await f(b,e,T.parameters.get(t),x);return await d(a,b,T,x),T})(b,x,T)}}})(ze,Jn,We,nn,Ft,an,zt,tr,er,jn,K,Bn,Te,Ge,ye,mn),ar=(t=>e=>t.get(e))(Ln),ur=(t=>(e,n)=>{t.set(e,n)})(nr),cr=qn?((t,e,n,r,i,s,o,a,u,c,l,p,f)=>class extends e{constructor(e,f,d){var _;const m=a(e),g=u(m),v=l({...lt,...d}),y=h.get(m),w=null==y?void 0:y.get(f),b=g||"closed"!==m.state?m:null!==(_=o(m))&&void 0!==_?_:m,x=i(b,g?null:e.baseLatency,c,f,w,v);super(e,!0,x,g?r(f,v,w):null);const T=[];x.parameters.forEach(((t,e)=>{const r=n(this,g,t);T.push([e,r])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new ct(T),g&&t(m,this);const{activeInputs:k}=s(this);p(x,k)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?f(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Kn,De,$e,or,sr,V,ar,be,ke,Bn,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),ur,ae):void 0,lr=(((t,e,n,r,i)=>{})(kt,$t,Jt,bn,Ae),((t,e)=>(n,r,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,r,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})($t,Te)),hr=((t,e,n,r,i,s,o,a)=>{const u=[];return(c,l)=>n(c).render(c,l,u).then((()=>Promise.all(Array.from(r(l)).map((t=>n(t).render(t,l,u)))))).then((()=>i(l))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),R(n)):e(s,(()=>s(n)))||a(n),t.add(n),n)))})(Pe,fe,ve,Qn,mn,O,je,Le),pr=(((t,e,n,r,i)=>{})(fe,kt,lr,bn,hr),((t,e,n,r,i)=>class extends t{constructor(t,n,i){let s;if("number"==typeof t&&void 0!==n&&void 0!==i)s={length:n,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");s=t}const{length:o,numberOfChannels:a,sampleRate:u}={...Xt,...s},c=r(a,o,u);e(Et,(()=>Et(c)))||c.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(c.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(c,a),this._length=o,this._nativeOfflineAudioContext=c,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,L(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(Gn,fe,kt,lr,hr)),fr=((t,e)=>n=>{const r=t.get(n);return e(r)||e(n)})(u,Oe),dr=((t,e)=>n=>t.has(n)||e(n))(s,Ee),_r=((t,e)=>n=>t.has(n)||e(n))(a,Re),mr=((t,e)=>n=>{const r=t.get(n);return e(r)||e(n)})(u,ke);function gr(t,e){if(!t)throw new Error(e)}function vr(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function yr(t){t.isOffline||"running"===t.state||br('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let wr=console;function br(...t){wr.warn(...t)}function xr(t){return void 0===t}function Tr(t){return!xr(t)}function kr(t){return"number"==typeof t}function Cr(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Sr(t){return"boolean"==typeof t}function Ar(t){return Array.isArray(t)}function Or(t){return"string"==typeof t}function Er(t){return Or(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Rr(t,e,n){return new pr(t,e,n)}const Dr="object"==typeof self?self:null,Mr=Dr&&(Dr.hasOwnProperty("AudioContext")||Dr.hasOwnProperty("webkitAudioContext"));function Ir(t,e,n,r){var i,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,n,o):i(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o}function Pr(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))}Object.create;Object.create;class Nr{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Vr(t){return _r(t)}function qr(t){return dr(t)}function jr(t){return mr(t)}function Lr(t){return fr(t)}function Fr(t){return t instanceof AudioBuffer}function Br(t,e){return"value"===t||Vr(e)||qr(e)||Fr(e)}function Ur(t,...e){if(!e.length)return t;const n=e.shift();if(Cr(t)&&Cr(n))for(const e in n)Br(e,n[e])?t[e]=n[e]:Cr(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Ur(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Ur(t,...e)}function zr(t,e,n=[],r){const i={},s=Array.from(e);if(Cr(s[0])&&r&&!Reflect.has(s[0],r)){Object.keys(s[0]).some((e=>Reflect.has(t,e)))||(Ur(i,{[r]:s[0]}),n.splice(n.indexOf(r),1),s.shift())}if(1===s.length&&Cr(s[0]))Ur(i,s[0]);else for(let t=0;t<n.length;t++)Tr(s[t])&&(i[n[t]]=s[t]);return Ur(t,i)}function Wr(t,e){return xr(t)?e:t}function Gr(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class Hr{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Dr&&this.toString()===Dr.TONE_DEBUG_CLASS)&&function(...t){wr.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Hr.version=t;const $r=1e-6;function Xr(t,e){return t>e+$r}function Zr(t,e){return Xr(t,e)||Qr(t,e)}function Yr(t,e){return t+$r<e}function Qr(t,e){return Math.abs(t-e)<$r}class Kr extends Hr{constructor(){super(),this.name="Timeline",this._timeline=[];const t=zr(Kr.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(gr(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];gr(Zr(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Qr(this._timeline[e].time,t)){for(let n=e;n>=0&&Qr(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Zr(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const r=this._timeline.length;let i=r;if(r>0&&this._timeline[r-1][e]<=t)return r-1;for(;n<i;){let r=Math.floor(n+(i-n)/2);const s=this._timeline[r],o=this._timeline[r+1];if(Qr(s[e],t)){for(let n=r;n<this._timeline.length;n++){if(!Qr(this._timeline[n][e],t))break;r=n}return r}if(Yr(s[e],t)&&Xr(o[e],t))return r;Xr(s[e],t)?i=r:n=r+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let r=this._search(t),i=this._search(e);return-1!==r&&-1!==i?(this._timeline[r].time!==t&&(r+=1),this._timeline[i].time===e&&(i-=1),this._iterate(n,r,i)):-1===r&&this._iterate(n,0,i),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Qr(this._timeline[n].time,t)){let r=n;for(let e=n;e>=0&&Qr(this._timeline[e].time,t);e--)r=e;this._iterate((t=>{e(t)}),r,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Jr=[];function ti(t){Jr.push(t)}const ei=[];function ni(t){ei.push(t)}class ri extends Hr{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{xr(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...r)=>{e(...r),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(xr(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(xr(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,r=n.length;t<r;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(ri.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class ii extends ri{constructor(){super(...arguments),this.isOffline=!1}}class si extends ii{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Kr,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=zr(si.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Yn(t)}({latencyHint:t.latencyHint}),this._ticker=new Nr(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,Jr.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){gr(Lr(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaStreamDestination(){gr(Lr(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){gr(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){gr(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){gr(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){gr(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return gr(Tr(cr),"This node only works in a secure context (https or localhost)"),new cr(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Pr(this,void 0,void 0,(function*(){gr(Tr(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Pr(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Or(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&Lr(this._context)?this._context.resume():Promise.resolve()}close(){return Pr(this,void 0,void 0,(function*(){var t;Lr(this._context)&&(yield this._context.close()),this._initialized&&(t=this,ei.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=e,r.loop=!0,r.start(0),this._constants.set(t,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,r=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),r()},id:n,time:i+e})};return r(),n}}function oi(t,e){Ar(e)?e.forEach((e=>oi(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function ai(t,e){Ar(e)?e.forEach((e=>ai(t,e))):Object.defineProperty(t,e,{writable:!0})}const ui=()=>{};class ci extends Hr{constructor(){super(),this.name="ToneAudioBuffer",this.onload=ui;const t=zr(ci.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Fr(t.url)||t.url instanceof ci?this.set(t.url):Or(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:ui,onload:ui,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:fi().sampleRate}set(t){return t instanceof ci?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Pr(this,void 0,void 0,(function*(){const e=ci.load(t).then((t=>{this.set(t),this.onload(this)}));ci.downloads.push(e);try{yield e}finally{const t=ci.downloads.indexOf(e);ci.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Ar(t)&&t[0].length>0,n=e?t.length:1,r=e?t[0].length:t.length,i=fi(),s=i.createBuffer(n,r,i.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(o[t],t);return this._buffer=s,this}toMono(t){if(kr(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(kr(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),r=Math.floor(e*this.sampleRate);gr(n<r,"The start time must be less than the end time");const i=r-n,s=fi().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)s.copyToChannel(this.getChannelData(t).subarray(n,r),t);return new ci(s)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new ci).fromArray(t)}static fromUrl(t){return Pr(this,void 0,void 0,(function*(){const e=new ci;return yield e.load(t)}))}static load(t){return Pr(this,void 0,void 0,(function*(){const e=t.match(/\[(.+\|?)+\]$/);if(e){const n=e[1].split("|");let r=n[0];for(const t of n)if(ci.supportsType(t)){r=t;break}t=t.replace(e[0],r)}const n=""===ci.baseUrl||ci.baseUrl.endsWith("/")?ci.baseUrl:ci.baseUrl+"/",r=yield fetch(n+t);if(!r.ok)throw new Error(`could not load url: ${t}`);const i=yield r.arrayBuffer();return yield fi().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Pr(this,void 0,void 0,(function*(){for(yield Promise.resolve();ci.downloads.length;)yield ci.downloads[0]}))}}ci.baseUrl="",ci.downloads=[];class li extends si{constructor(){super({clockSource:"offline",context:jr(arguments[0])?arguments[0]:Rr(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:jr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=jr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Pr(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Pr(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new ci(e)}))}close(){return Promise.resolve()}}const hi=new class extends ii{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Pr(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let pi=hi;function fi(){return pi===hi&&Mr&&di(new si),pi}function di(t){pi=Lr(t)?new si(t):jr(t)?new li(t):t}function _i(){return pi.resume()}if(Dr&&!Dr.TONE_SILENCE_LOGGING){let t="v";0;const e=` * Tone.js ${t}14.7.58 * `;console.log(`%c${e}`,"background: #000; color: #fff")}function mi(t){return Math.pow(2,t/12)}let gi=440;function vi(t){return Math.round(yi(t))}function yi(t){return 69+12*Math.log2(t/gi)}function wi(t){return gi*Math.pow(2,(t-69)/12)}class bi extends Hr{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),r="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/n)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let r=0;return t&&"0"!==t&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(r+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(r+=this._beatsToUnits(parseFloat(n)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof bi&&this.fromType(this._val),xr(this._val))return this._noArg();if(Or(this._val)&&xr(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Cr(this._val)){let t=0;for(const e in this._val)if(Tr(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Tr(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Or(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class xi extends bi{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new xi(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),r=this.valueOf();return r+(Math.round(r/n)*n-r)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],r=new xi(this.context,e[0]).toSeconds();return e.forEach((e=>{const i=new xi(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(r-t)&&(n=e,r=i)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let r=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=r.toString();i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3)));return[n,e,r].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return vi(this.toFrequency())}_now(){return this.context.now()}}class Ti extends xi{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return gi}static set A4(t){!function(t){gi=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Ti.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=ki[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Ti.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let r=1;return t&&"0"!==t&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(r*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}}})}transpose(t){return new Ti(this.context,this.valueOf()*mi(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return vi(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Ti.A4);let n=Math.round(12*e)+57;const r=Math.floor(n/12);r<0&&(n+=-12*r);return Ci[n%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return wi(t)}static ftom(t){return vi(t)}}const ki={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Ci=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Si extends xi{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Ai extends Hr{constructor(){super();const t=zr(Ai.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:fi()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new xi(this.context,t).toSeconds()}toFrequency(t){return new Ti(this.context,t).toFrequency()}toTicks(t){return new Si(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{xr(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Tr(n)&&Tr(n.value)&&Tr(n.setValueAtTime)?t[e]=n.value:n instanceof Ai?t[e]=n._getPartialProperties(t[e]):Ar(n)||kr(n)||Or(n)||Sr(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Tr(this[e])&&(this[e]&&Tr(this[e].value)&&Tr(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Ai?this[e].set(t[e]):this[e]=t[e])})),this}}class Oi extends Kr{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return vr(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Ei extends Ai{constructor(){super(zr(Ei.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=zr(Ei.getDefaults(),arguments,["param","units","convert"]);for(gr(Tr(t.param)&&(Vr(t.param)||t.param instanceof Ei),"param must be an AudioParam");!Vr(t.param);)t.param=t.param._param;this._swappable=!!Tr(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Kr(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Tr(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ai.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Tr(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Tr(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Tr(this.maxValue)&&Tr(this.minValue)&&vr(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?(e=t,Math.log(e)/Math.LN10*20):t;var e}setValueAtTime(t,e){const n=this.toSeconds(e),r=this._fromType(t);return gr(isFinite(r)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),r=this._events.get(e);let i=this._initialValue;if(null===r)i=this._initialValue;else if("setTargetAtTime"!==r.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=r.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=r.value;if("setTargetAtTime"===r.type){const e=this._events.getBefore(r.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(r.time,t,n.time,n.value,e):this._exponentialInterpolate(r.time,t,n.time,n.value,e)}else i=r.value;else{const t=this._events.getBefore(r.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===r.type&&(i=this._exponentialApproach(r.time,n,r.value,r.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),r=this.toSeconds(e);return gr(isFinite(n)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:r,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,r),this._param.linearRampToValueAtTime(n,r),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Math.max(this._minOutput,n),this._assertRange(n);const r=this.toSeconds(e);return gr(isFinite(n)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,r),this._param.exponentialRampToValueAtTime(n,r),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const r=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,r),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const r=this._fromType(t);gr(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(r),gr(isFinite(r)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",t,i,n),this._param.setTargetAtTime(r,i,n),this}setValueCurveAtTime(t,e,n,r=1){n=this.toSeconds(n),e=this.toSeconds(e);const i=this._fromType(t[0])*r;this.setValueAtTime(this._toType(i),e);const s=n/(t.length-1);for(let n=1;n<t.length;n++){const i=this._fromType(t[n])*r;this.linearRampToValueAtTime(this._toType(i),e+n*s)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return gr(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));gr(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const r=this._events.get(e),i=this._events.getAfter(e);return r&&Qr(r.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const r=this._events.getAfter(n.time),i=r?r.time:e+2,s=(i-e)/10;for(let n=e;n<i;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){gr(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,r,i){return n+(e-n)*Math.exp(-(i-t)/r)}_linearInterpolate(t,e,n,r,i){return e+(i-t)/(n-t)*(r-e)}_exponentialInterpolate(t,e,n,r,i){return e*Math.pow(r/e,(i-t)/(n-t))}}class Ri extends Ai{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Tr(this.input)?Vr(this.input)||this.input instanceof Ei?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Tr(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Tr(t)&&(t instanceof Ri||qr(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();gr(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Mi(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return br("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Ii(this,t,e,n),this}chain(...t){return Di(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Tr(this.input)&&(this.input instanceof Ri?this.input.dispose():qr(this.input)&&this.input.disconnect()),Tr(this.output)&&(this.output instanceof Ri?this.output.dispose():qr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Di(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Ri?t.connect(e):qr(t)&&Mi(t,e),e)),e)}function Mi(t,e,n=0,r=0){for(gr(Tr(t),"Cannot connect from undefined node"),gr(Tr(e),"Cannot connect to undefined node"),(e instanceof Ri||qr(e))&&gr(e.numberOfInputs>0,"Cannot connect to node with no inputs"),gr(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Ri||e instanceof Ei;)Tr(e.input)&&(e=e.input);for(;t instanceof Ri;)Tr(t.output)&&(t=t.output);Vr(e)?t.connect(e,n):t.connect(e,n,r)}function Ii(t,e,n=0,r=0){if(Tr(e))for(;e instanceof Ri;)e=e.input;for(;!qr(t);)Tr(t.output)&&(t=t.output);Vr(e)?t.disconnect(e,n):qr(e)?t.disconnect(e,n,r):t.disconnect()}class Pi extends Ri{constructor(){super(zr(Pi.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=zr(Pi.getDefaults(),arguments,["gain","units"]);this.gain=new Ei({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),oi(this,"gain")}static getDefaults(){return Object.assign(Ri.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ni extends Ri{constructor(t){super(t),this.onended=ui,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Pi({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Ri.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:ui})}_startGain(t,e=1){gr(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){gr(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==ui&&(this.onended(this),this.onended=ui,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),gr(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Vi extends Ni{constructor(){super(zr(Vi.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=zr(Vi.getDefaults(),arguments,["offset"]);Mi(this._source,this._gainNode),this.offset=new Ei({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Ni.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class qi extends Ri{constructor(){super(zr(qi.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=zr(qi.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Vi({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Ri.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return ji(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,r){return this._param.setValueCurveAtTime(t,e,n,r),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function ji(t,e,n,r){(e instanceof Ei||Vr(e)||e instanceof qi&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof qi&&(e.overridden=!0)),Mi(t,e,n,r)}class Li extends Ei{constructor(){super(zr(Li.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Kr(1/0),this._multiplier=1;const t=zr(Li.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ei.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const r=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){const s=n*t+e,o=this._exponentialApproach(i.time,i.value,r,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const r=this._events.get(n),i=this._events.previousEvent(r),s=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(s,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const r=this._events.get(n),i=this._events.previousEvent(r),s=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),r=this._events.get(e),i=Math.round(Math.max(10*(e-r.time),1)),s=(e-r.time)/i;for(let t=0;t<=i;t++){const i=s*t+r.time,o=this._exponentialInterpolate(r.time,r.value,e,n,i);this.linearRampToValueAtTime(this._toType(o),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(xr(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let r=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(r=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+r)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),r=this.getTicksAtTime(e);return this.getTimeOfTick(r+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const r=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(n.time))-r)/(n.time-e.time),s=Math.sqrt(Math.pow(r,2)-2*i*(e.ticks-t)),o=(-r+s)/i,a=(-r-s)/i;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),r=this.toSeconds(t),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+r)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Fi extends qi{constructor(){super(zr(Fi.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=zr(Fi.getDefaults(),arguments,["value"]);this.input=this._param=new Li({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(qi.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Bi extends Ai{constructor(){super(zr(Bi.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Oi,this._tickOffset=new Kr;const t=zr(Bi.getDefaults(),arguments,["frequency"]);this.frequency=new Fi({context:this.context,units:t.units,value:t.frequency}),oi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Ai.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Tr(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);let i=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(s=n.ticks,e=n.time),"started"===i.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t})),this._state.remove(r),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let r=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(i=n.seconds,e=n.time),"started"===r.state&&"started"!==t.state&&(i+=t.time-e),r=t})),this._state.remove(n),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),r=this._state.get(e),i=Math.max(n.time,r.time),s=this.frequency.getTicksAtTime(i)+t-n.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(t,e,n){let r=this._state.get(t);this._state.forEachBetween(t,e,(e=>{r&&"started"===r.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(r.time,t),e.time-this.sampleTime,n),r=e}));let i=null;if(r&&"started"===r.state){const s=Math.max(r.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(r.time);let u=Math.ceil(a)-a;u=Qr(u,1)?0:u;let c=this.frequency.getTimeOfTick(o+u);for(;c<e;){try{n(c,Math.round(this.getTicksAtTime(c)))}catch(t){i=t;break}c+=this.frequency.getDurationOfTicks(1,c)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Ui extends Ai{constructor(){super(zr(Ui.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=ui,this._lastUpdate=0,this._state=new Oi("stopped"),this._boundLoop=this._loop.bind(this);const t=zr(Ui.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Bi({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,oi(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Ai.getDefaults(),{callback:ui,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){yr(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),r=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(r+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ri.mixin(Ui);class zi extends Ri{constructor(){super(zr(zi.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=zr(zi.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new Ei({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),oi(this,"delayTime")}static getDefaults(){return Object.assign(Ri.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Wi extends Hr{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=zr(Wi.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:ui,onload:ui,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return gr(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=ui,r=ui){return Or(e)?this._buffers.set(t.toString(),new ci(this.baseUrl+e,n,r)):this._buffers.set(t.toString(),new ci(e,n,r)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Gi extends Ti{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return vi(super._frequencyToUnits(t))}_ticksToUnits(t){return vi(super._ticksToUnits(t))}_beatsToUnits(t){return vi(super._beatsToUnits(t))}_secondsToUnits(t){return vi(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return wi(this.toMidi())}transpose(t){return new Gi(this.context,this.toMidi()+t)}}class Hi extends Si{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class $i extends Ai{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Kr,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ti((t=>{t.draw=new $i({context:t})})),ni((t=>{t.draw.dispose()}));class Xi extends Hr{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){gr(Tr(t.time),"Events must have a time property"),gr(Tr(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Zi(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),r=t.right;r&&(t.right=r.left,r.left=t),null!==e?n?e.left=r:e.right=r:this._setRoot(r)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),r=t.left;r&&(t.left=r.right,r.right=t),null!==e?n?e.left=r:e.right=r:this._setRoot(r)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Zi{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Yi extends Ri{constructor(){super(zr(Yi.getDefaults(),arguments,["volume"])),this.name="Volume";const t=zr(Yi.getDefaults(),arguments,["volume"]);this.input=this.output=new Pi({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,oi(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Ri.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Qi extends Ri{constructor(){super(zr(Qi.getDefaults(),arguments)),this.name="Destination",this.input=new Yi({context:this.context}),this.output=new Pi({context:this.context}),this.volume=this.input.volume;const t=zr(Qi.getDefaults(),arguments);Di(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Ri.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Di(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ti((t=>{t.destination=new Qi({context:t})})),ni((t=>{t.destination.dispose()}));class Ki extends Hr{constructor(t){super(),this.name="TimelineValue",this._timeline=new Kr({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Ji{constructor(t,e){this.id=Ji._eventId++;const n=Object.assign(Ji.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:ui,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Ji._eventId=0;class ts extends Ji{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ts.getDefaults(),e);this.duration=new Hi(t.context,n.duration).valueOf(),this._interval=new Hi(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Ji.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Hi(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Hi(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Hi(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class es extends Ai{constructor(){super(zr(es.getDefaults(),arguments)),this.name="Transport",this._loop=new Ki(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Kr,this._repeatedEvents=new Xi,this._syncedSignals=[],this._swingAmount=0;const t=zr(es.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Ui({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),oi(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Ai.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),r=Math.sin(n*Math.PI)*this._swingAmount;t+=new Hi(this.context,2*this._swingTicks/3).toSeconds()*r}this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new Ji(this,{callback:t,time:new Si(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,r=1/0){const i=new ts(this,{callback:t,duration:new xi(this.context,r).toTicks(),interval:new xi(this.context,e).toTicks(),time:new Si(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const n=new Ji(this,{callback:t,once:!0,time:new Si(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new Hi(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Tr(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Ar(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new xi(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new xi(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Hi(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Hi(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),r=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",r),this._clock.setTicksAtTime(t,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const r=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/r}else e=0}const n=new Pi(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),ai(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ri.mixin(es),ti((t=>{t.transport=new es({context:t})})),ni((t=>{t.transport.dispose()}));class ns extends Ri{constructor(t){super(t),this.input=void 0,this._state=new Oi("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=ui,this._syncedStop=ui,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Yi({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,oi(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Ri.getDefaults(),{mute:!1,onstop:ui,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let r=xr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(r=this._clampToCurrentTime(r),this._synced||"started"!==this._state.getValueAtTime(r))if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const t=this._state.get(r);t&&(t.offset=this.toSeconds(Wr(e,0)),t.duration=n?this.toSeconds(n):void 0);const i=this.context.transport.schedule((t=>{this._start(t,e,n)}),r);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else yr(this.context),this._start(r,e,n);else gr(Xr(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,e,n);return this}stop(t){let e=xr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Tr(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const r=e-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-r),this._start(t,this.toSeconds(n.offset)+r,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=ui,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class rs extends Ni{constructor(){super(zr(rs.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=zr(rs.getDefaults(),arguments,["url","onload"]);Mi(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Ei({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new ci(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ni.getDefaults(),{url:new ci,loop:!1,loopEnd:0,loopStart:0,onload:ui,onerror:ui,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,r=1){gr(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,r),e=this.loop?Wr(e,this.loopStart):Wr(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;Zr(s,t)&&(s=(s-e)%n+e),Qr(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Yr(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,s)),Tr(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class is extends ns{constructor(){super(zr(is.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=zr(is.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ns.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(gr(t in as,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=as[this._type];this._source=new rs({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const ss=220500,os={brown:null,pink:null,white:null},as={get brown(){if(!os.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ss);t[e]=n;let r=0;for(let t=0;t<ss;t++){const e=2*Math.random()-1;n[t]=(r+.02*e)/1.02,r=n[t],n[t]*=3.5}}os.brown=(new ci).fromArray(t)}return os.brown},get pink(){if(!os.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ss);let r,i,s,o,a,u,c;t[e]=n,r=i=s=o=a=u=c=0;for(let t=0;t<ss;t++){const e=2*Math.random()-1;r=.99886*r+.0555179*e,i=.99332*i+.0750759*e,s=.969*s+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,u=-.7616*u-.016898*e,n[t]=r+i+s+o+a+u+c+.5362*e,n[t]*=.11,c=.115926*e}}os.pink=(new ci).fromArray(t)}return os.pink},get white(){if(!os.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ss);t[e]=n;for(let t=0;t<ss;t++)n[t]=2*Math.random()-1}os.white=(new ci).fromArray(t)}return os.white}};function us(t,e){return Pr(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,r=new li(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:r})).toDestination().start(0);return(yield r.render()).getChannelData(0)}))}class cs extends Ni{constructor(){super(zr(cs.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=zr(cs.getDefaults(),arguments,["frequency","type"]);Mi(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Ei({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Ei({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),oi(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ni.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ls extends ns{constructor(){super(zr(ls.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=zr(ls.getDefaults(),arguments,["frequency","type"]);this.frequency=new qi({context:this.context,units:"frequency",value:t.frequency}),oi(this,"frequency"),this.detune=new qi({context:this.context,units:"cents",value:t.detune}),oi(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ns.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new cs({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return ls._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=ls._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Tr(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),r=this.context.createPeriodicWave(e,n);this._wave=r,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),ls._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),ls._periodicWaveCache.length>100&&ls._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){vr(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const r=new Float32Array(n),i=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[r,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(r[o]=-a*Math.sin(e*o),i[o]=a*Math.cos(e*o)):(r[o]=0,i[o]=0)}return[r,i]}_inverseFFT(t,e,n){let r=0;const i=t.length;for(let s=0;s<i;s++)r+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return r}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const r=2*Math.PI;for(let i=0;i<32;i++)n=Math.max(this._inverseFFT(t,e,i/32*r),n);return i=-this._inverseFFT(t,e,this._phase)/n,s=-1,o=1,Math.max(Math.min(i,o),s);var i,s,o}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ls._periodicWaveCache=[];class hs extends Ri{constructor(){super(Object.assign(zr(hs.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return ji(this,t,e,n),this}}class fs extends hs{constructor(){super(Object.assign(zr(fs.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=zr(fs.getDefaults(),arguments,["mapping","length"]);Ar(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(qi.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let r=0,i=e;r<i;r++){const e=r/(i-1)*2-1;n[r]=t(e,r)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){gr(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class ds extends hs{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new fs({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class _s extends qi{constructor(){super(Object.assign(zr(_s.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=zr(_s.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Pi({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(qi.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class ms extends ns{constructor(){super(zr(ms.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new ds({context:this.context}),this._modulationNode=new Pi({context:this.context});const t=zr(ms.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ls({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new _s({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),oi(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ls.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class gs extends ns{constructor(){super(zr(gs.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Pi({context:this.context,gain:0});const t=zr(gs.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ls({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new qi({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ls({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new _s({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new _s({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),oi(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ls.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class vs extends ns{constructor(){super(zr(vs.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Pi({context:this.context,gain:0}),this._thresh=new fs({context:this.context,mapping:t=>t<=0?-1:1});const t=zr(vs.getDefaults(),arguments,["frequency","width"]);this.width=new qi({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),oi(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ns.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ys extends ns{constructor(){super(zr(ys.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=zr(ys.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new qi({context:this.context,units:"frequency",value:t.frequency}),this.detune=new qi({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,oi(this,["frequency","detune"])}static getDefaults(){return Object.assign(ls.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,r)=>t.detune.value=e+n*r))}}get count(){return this._oscillators.length}set count(t){if(vr(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new ls({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):ui});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class ws extends ns{constructor(){super(zr(ws.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new _s({context:this.context,value:2});const t=zr(ws.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new vs({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),oi(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ns.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const bs={am:ms,fat:ys,fm:gs,oscillator:ls,pulse:vs,pwm:ws};class xs extends ns{constructor(){super(zr(xs.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=zr(xs.getDefaults(),arguments,["frequency","type"]);this.frequency=new qi({context:this.context,units:"frequency",value:t.frequency}),this.detune=new qi({context:this.context,units:"cents",value:t.detune}),oi(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ls.getDefaults(),gs.getDefaults(),ms.getDefaults(),ys.getDefaults(),vs.getDefaults(),ws.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=bs[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof bs[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&kr(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&kr(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Or(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){return us(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Ts extends qi{constructor(){super(Object.assign(zr(Ts.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Pi({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Di(this._constantSource,this._sum)}static getDefaults(){return Object.assign(qi.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class ks extends hs{constructor(){super(Object.assign(zr(ks.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=zr(ks.getDefaults(),arguments,["min","max"]);this._mult=this.input=new _s({context:this.context,value:t.max-t.min}),this._add=this.output=new Ts({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(hs.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Cs extends hs{constructor(){super(Object.assign(zr(Cs.getDefaults(),arguments))),this.name="Zero",this._gain=new Pi({context:this.context}),this.output=this._gain,this.input=void 0,Mi(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Ii(this.context.getConstant(0),this._gain),this}}class Ss extends Ri{constructor(){super(zr(Ss.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Ei.prototype._fromType,this._toType=Ei.prototype._toType,this._is=Ei.prototype._is,this._clampValue=Ei.prototype._clampValue;const t=zr(Ss.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new ls({context:this.context,frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Pi({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new qi({context:this.context,units:"audioRange",value:0}),this._zeros=new Cs({context:this.context}),this._a2g=new ds({context:this.context}),this._scaler=this.output=new ks({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._a2g,this._amplitudeGain,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),oi(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(Ri.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof Ei||t instanceof qi)&&(this.convert=t.convert,this.units=t.units),ji(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function As(t,e=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){vr(r,t,e),n.set(this,r)}})}}function Os(t,e=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){vr(this.toSeconds(r),t,e),n.set(this,r)}})}}class Es extends ns{constructor(){super(zr(Es.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=zr(Es.getDefaults(),arguments,["url","onload"]);this._buffer=new ci({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ns.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:ui,onerror:ui,playbackRate:1,reverse:!1})}load(t){return Pr(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=ui){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Wr(e,this._loopStart):Wr(e,0);let r=this.toSeconds(e);this._synced&&(r*=this._playbackRate);const i=n;n=Wr(n,Math.max(this._buffer.duration-r,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new rs({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&xr(i)?o.start(t,r):o.start(t,r,s-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&vr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&vr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Ir([Os(0)],Es.prototype,"fadeIn",void 0),Ir([Os(0)],Es.prototype,"fadeOut",void 0);class Rs extends ns{constructor(){super(zr(Rs.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=zr(Rs.getDefaults(),arguments,["url","onload"]);this.buffer=new ci({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Ui({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(ns.getDefaults(),{onload:ui,onerror:ui,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=Wr(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const r=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/r),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const r=n<this._overlap?0:this._overlap,i=new rs({context:this.context,url:this.buffer,fadeIn:r,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:mi(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){vr(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&vr(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&vr(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);vr(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class Ds extends hs{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new fs({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ms extends Ri{constructor(){super(zr(Ms.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new qi({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=zr(Ms.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Ri.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Or(t))return t;{let n;for(n in Is)if(Is[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Or(n)&&Reflect.has(Is,n)){const r=Is[n];Cr(r)?"_decayCurve"!==t&&(this[t]=r[e]):this[t]=r}else{if(!Ar(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){gr(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){n=(1-i)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let r=this._attackCurve;for(let t=1;t<r.length;t++)if(r[t-1]<=i&&i<=r[t]){r=this._attackCurve.slice(t),r[0]=i;break}this._sig.setValueCurveAtTime(r,t,n,e)}if(r&&this.sustain<1){const i=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,r+s):this._sig.exponentialApproachValueAtTime(i,s,r)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(gr(Ar(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return ji(this,t,e,n),this}asArray(t=1024){return Pr(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new li(1,e,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=r+this.toSeconds(this.release),s=.1*i,o=i+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(r+s)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Ir([Os(0)],Ms.prototype,"attack",void 0),Ir([Os(0)],Ms.prototype,"decay",void 0),Ir([As(0,1)],Ms.prototype,"sustain",void 0),Ir([Os(0)],Ms.prototype,"release",void 0);const Is=(()=>{const t=128;let e,n;const r=[];for(e=0;e<t;e++)r[e]=Math.sin(e/127*(Math.PI/2));const i=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=t/10+.83*n}i[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,r=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(r*(1-n))}function u(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:u(a),Out:a},cosine:{In:r,Out:(c=r,c.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:o,Out:u(o)},step:{In:s,Out:u(s)}};var c})();class Ps extends Ri{constructor(){super(zr(Ps.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=zr(Ps.getDefaults(),arguments);this._volume=this.output=new Yi({context:this.context,volume:t.volume}),this.volume=this._volume.volume,oi(this,"volume")}static getDefaults(){return Object.assign(Ri.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const r=t[e],i=this.context.transport.schedule((r=>{t[e]=r,n.apply(this,t)}),r);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,r){const i=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,i,r),this.triggerRelease(i+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Ns extends Ps{constructor(){super(zr(Ns.getDefaults(),arguments));const t=zr(Ns.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Ps.getDefaults(),{detune:0,onsilence:ui,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const r=this.toSeconds(e);return this._triggerEnvelopeAttack(r,n),this.setNote(t,r),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),r=t instanceof Ti?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,t,n)}else this.frequency.setValueAtTime(r,n);return this}}Ir([Os(0)],Ns.prototype,"portamento",void 0);class Vs extends Ms{constructor(){super(zr(Vs.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Pi({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class qs extends Ns{constructor(){super(zr(qs.getDefaults(),arguments)),this.name="Synth";const t=zr(qs.getDefaults(),arguments);this.oscillator=new xs(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Vs(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),oi(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Ns.getDefaults(),{envelope:Object.assign(Gr(Ms.getDefaults(),Object.keys(Ri.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Gr(xs.getDefaults(),[...Object.keys(ns.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class js extends Ns{constructor(){super(zr(js.getDefaults(),arguments)),this.name="ModulationSynth";const t=zr(js.getDefaults(),arguments);this._carrier=new qs({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new qs({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new qi({context:this.context,units:"frequency"}),this.detune=new qi({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new _s({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Pi({context:this.context,gain:0}),oi(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Ns.getDefaults(),{harmonicity:3,oscillator:Object.assign(Gr(xs.getDefaults(),[...Object.keys(ns.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Gr(Ms.getDefaults(),Object.keys(Ri.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Gr(xs.getDefaults(),[...Object.keys(ns.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Gr(Ms.getDefaults(),Object.keys(Ri.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Ls extends Ri{constructor(){super(zr(Ls.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=zr(Ls.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Ei({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new Ei({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new Ei({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new Ei({context:this.context,units:"gain",value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Ri.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){gr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const r=19980*Math.pow(n/t,2)+20;e[n]=r}const n=new Float32Array(t),r=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,n,r),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Fs extends Ri{constructor(){super(zr(Fs.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Pi({context:this.context}),this.output=new Pi({context:this.context}),this._filters=[];const t=zr(Fs.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new qi({context:this.context,units:"positive",value:t.Q}),this.frequency=new qi({context:this.context,units:"frequency",value:t.frequency}),this.detune=new qi({context:this.context,units:"cents",value:t.detune}),this.gain=new qi({context:this.context,units:"decibels",value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,oi(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Ri.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){gr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=kr(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let r=n.indexOf(e);gr(-1!==r,`rolloff can only be ${n.join(", ")}`),r+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(r);for(let t=0;t<r;t++){const e=new Ls({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,Di(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Ls({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>n[e]*=t))})),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),ai(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Bs extends js{constructor(){super(zr(Bs.getDefaults(),arguments)),this.name="FMSynth";const t=zr(Bs.getDefaults(),arguments);this.modulationIndex=new _s({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(js.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}class Us extends qs{constructor(){super(zr(Us.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=zr(Us.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,oi(this,["oscillator","envelope"])}static getDefaults(){return Ur(Ns.getDefaults(),qs.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),r=this.toFrequency(t instanceof Ti?t.toFrequency():t),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(r,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ir([As(0)],Us.prototype,"octaves",void 0),Ir([Os(0)],Us.prototype,"pitchDecay",void 0);const zs=new Set;function Ws(t){zs.add(t)}function Gs(t,e){const n=`registerProcessor("${t}", ${e})`;zs.add(n)}class Hs extends Ri{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=ui;const e=URL.createObjectURL(new Blob([Array.from(zs).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Ws('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Ws("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Ws("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const $s="feedback-comb-filter";Gs($s,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Xs extends Hs{constructor(){super(zr(Xs.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=zr(Xs.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Pi({context:this.context}),this.output=new Pi({context:this.context}),this.delayTime=new Ei({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Ei({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),oi(this,["resonance","delayTime"])}_audioWorkletName(){return $s}static getDefaults(){return Object.assign(Ri.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){Di(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class Zs extends Ri{constructor(){super(zr(Zs.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=zr(Zs.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new Pi({context:this.context}),this.output=new Pi({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(Ri.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const r=19980*Math.pow(n/t,2)+20;e[n]=r}const n=new Float32Array(t),r=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,r),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Ys extends Ri{constructor(){super(zr(Ys.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=zr(Ys.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Xs({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Zs({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(Ri.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Qs extends Ps{constructor(){super(zr(Qs.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=zr(Qs.getDefaults(),arguments,["voice","options"]);gr(!kr(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Ps.getDefaults(),{maxPolyphony:32,options:{},voice:qs})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}br("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const r=new Gi(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,n),this._activeVoices.push({midi:r,voice:i,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new Gi(this.context,t).toMidi(),r=this._activeVoices.find((({midi:t,released:e})=>t===n&&!e));r&&(r.voice.triggerRelease(e),r.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,r){gr(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,r):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,r)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const r=this.toSeconds(e);return this._scheduleEvent("attack",t,r,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,r){const i=this.toSeconds(n);if(this.triggerAttack(t,i,r),Ar(e)){gr(Ar(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const r=e[Math.min(n,e.length-1)],s=this.toSeconds(r);gr(s>0,"The duration must be greater than 0"),this.triggerRelease(t[n],i+s)}}else{const n=this.toSeconds(e);gr(n>0,"The duration must be greater than 0"),this.triggerRelease(t,i+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Gr(t,["onsilence","context"]);return this.options=Ur(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Ks extends Ps{constructor(){super(zr(Ks.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=zr(Ks.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const r=parseInt(n,10);if(gr(Er(n)||kr(r)&&isFinite(r),`url key is neither a note or midi pitch: ${n}`),Er(n)){const r=new Ti(this.context,n).toMidi();e[r]=t.urls[n]}else kr(r)&&isFinite(r)&&(e[r]=t.urls[r])})),this._buffers=new Wi({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Ps.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:ui,onerror:ui,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const r=yi(new Ti(this.context,t).toFrequency()),i=Math.round(r),s=r-i,o=this._findClosest(i),a=i-o,u=this._buffers.get(a),c=mi(o+s),l=new rs({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:c}).connect(this.output);l.start(e,0,u.duration/c,n),Ar(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Ti(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,r=1){const i=this.toSeconds(n);return this.triggerAttack(t,i,r),Ar(e)?(gr(Ar(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const r=e[Math.min(n,e.length-1)];this.triggerRelease(t,i+this.toSeconds(r))}))):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,n){if(gr(Er(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Er(t)){const r=new Ti(this.context,t).toMidi();this._buffers.add(r,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Ir([Os(0)],Ks.prototype,"attack",void 0),Ir([Os(0)],Ks.prototype,"release",void 0);class Js extends Ai{constructor(){super(zr(Js.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Oi("stopped"),this._startOffset=0;const t=zr(Js.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(Ai.getDefaults(),{callback:ui,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||kr(this._loop)&&this._loop>1){e=1/0,kr(this._loop)&&(e=this._loop*this._getLoopDuration());const r=this._state.getAfter(n);null!==r&&(e=Math.min(e,r.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new Hi(this.context,e));const i=new Hi(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new Hi(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Hi(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=Wr(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;Sr(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Hi(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new Hi(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class to extends Ai{constructor(){super(zr(to.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=zr(to.getDefaults(),arguments,["callback","interval"]);this._event=new Js({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(Ai.getDefaults(),{interval:"4n",callback:ui,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class eo extends Ri{constructor(){super(Object.assign(zr(eo.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Ds({context:this.context}),this.a=new Pi({context:this.context,gain:0}),this.b=new Pi({context:this.context,gain:0}),this.output=new Pi({context:this.context}),this._internalChannels=[this.a,this.b];const t=zr(eo.getDefaults(),arguments,["fade"]);this.fade=new qi({context:this.context,units:"normalRange",value:t.fade}),oi(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Mi(this._split,this.a.gain,0),Mi(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Ri.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class no extends Ri{constructor(t){super(t),this.name="Effect",this._dryWet=new eo({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Pi({context:this.context}),this.effectReturn=new Pi({context:this.context}),this.input=new Pi({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],oi(this,"wet")}static getDefaults(){return Object.assign(Ri.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class ro extends Ri{constructor(){super(Object.assign(zr(ro.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=zr(ro.getDefaults(),arguments,["pan"]);this.pan=new Ei({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",oi(this,"pan")}static getDefaults(){return Object.assign(Ri.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}Gs("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class io extends Ri{constructor(){super(zr(io.getDefaults(),arguments,["channels"])),this.name="Split";const t=zr(io.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Ri.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class so extends Ri{constructor(){super(zr(so.getDefaults(),arguments,["channels"])),this.name="Merge";const t=zr(so.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(Ri.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class oo extends Ri{constructor(t){super(t),this.name="StereoEffect",this.input=new Pi({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new eo({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new io({context:this.context,channels:2}),this._merge=new so({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),oi(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),Di(...t),Mi(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),Di(...t),Mi(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Ri.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class ao extends oo{constructor(t){super(t),this.feedback=new qi({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new Pi({context:this.context}),this._feedbackR=new Pi({context:this.context}),this._feedbackSplit=new io({context:this.context,channels:2}),this._feedbackMerge=new so({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),oi(this,["feedback"])}static getDefaults(){return Object.assign(oo.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class uo extends ao{constructor(){super(zr(uo.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=zr(uo.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new Ss({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new Ss({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new zi({context:this.context}),this._delayNodeR=new zi({context:this.context}),this.frequency=this._lfoL.frequency,oi(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(ao.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class co extends no{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new Pi({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,oi(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(no.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class lo extends co{constructor(){super(zr(lo.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=zr(lo.getDefaults(),arguments,["pitch"]);this._frequency=new qi({context:this.context}),this._delayA=new zi({maxDelay:1,context:this.context}),this._lfoA=new Ss({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new zi({maxDelay:1,context:this.context}),this._lfoB=new Ss({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new eo({context:this.context}),this._crossFadeLFO=new Ss({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new zi({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,oi(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(co.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=mi(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=mi(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class ho extends no{constructor(){super(zr(ho.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=zr(ho.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(no.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){vr(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){vr(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Pr(this,void 0,void 0,(function*(){const t=this.ready,e=new li(2,this._decay+this._preDelay,this.context.sampleRate),n=new is({context:e}),r=new is({context:e}),i=new so({context:e});n.connect(i,0,0),r.connect(i,0,1);const s=new Pi({context:e}).toDestination();i.connect(s),n.start(0),r.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(ui),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class po extends Ri{constructor(){super(zr(po.getDefaults(),arguments,["solo"])),this.name="Solo";const t=zr(po.getDefaults(),arguments,["solo"]);this.input=this.output=new Pi({context:this.context}),po._allSolos.has(this.context)||po._allSolos.set(this.context,new Set),po._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Ri.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),po._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){po._soloed.has(this.context)||po._soloed.set(this.context,new Set),po._soloed.get(this.context).add(this)}_removeSolo(){po._soloed.has(this.context)&&po._soloed.get(this.context).delete(this)}_isSoloed(){return po._soloed.has(this.context)&&po._soloed.get(this.context).has(this)}_noSolos(){return!po._soloed.has(this.context)||po._soloed.has(this.context)&&0===po._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),po._allSolos.get(this.context).delete(this),this._removeSolo(),this}}po._allSolos=new Map,po._soloed=new Map;class fo extends Ri{constructor(){super(zr(fo.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=zr(fo.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new ro({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Yi({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,oi(this,["pan","volume"])}static getDefaults(){return Object.assign(Ri.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class _o extends Ri{constructor(){super(zr(_o.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=zr(_o.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new po({solo:t.solo,context:this.context}),this._panVol=this.output=new fo({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),oi(this,["pan","volume"])}static getDefaults(){return Object.assign(Ri.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return _o.buses.has(t)||_o.buses.set(t,new Pi({context:this.context})),_o.buses.get(t)}send(t,e=0){const n=this._getBus(t),r=new Pi({context:this.context,units:"decibels",gain:e});return this.connect(r),r.connect(n),r}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}_o.buses=new Map;class mo extends Ri{constructor(){super(...arguments),this.name="Listener",this.positionX=new Ei({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Ei({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Ei({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Ei({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Ei({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Ei({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Ei({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Ei({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Ei({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Ri.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ti((t=>{t.listener=new mo({context:t})})),ni((t=>{t.listener.dispose()}));class go extends Ri{constructor(){super(zr(go.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=zr(go.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Ei({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new Ei({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new Ei({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new Ei({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new Ei({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),oi(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Ri.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class vo extends Ri{constructor(){super(Object.assign(zr(vo.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=zr(vo.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new go({context:this.context,ratio:20,attack:0,release:0,threshold:t.threshold}),this.threshold=this._compressor.threshold,oi(this,"threshold")}static getDefaults(){return Object.assign(Ri.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}function yo(){return fi().now()}fi().transport;fi().destination,fi().destination;fi().listener;fi().draw;fi();i(666);const wo=class{constructor(t,e,n=2){fi().rawContext.suspend(),this.grains=[],this.presets=[],this.isStopped=!1,this.numVoices=n,this.buffer=t,this.nodes=[],this.toneContext=e,this.transport=this.toneContext.transport,this.dest=this.toneContext.destination,this.dest.name="Grainsynth Destination",this.effectsChain=[],this.grainOutput=new Pi(1),this.grainOutput.name="Grain Output",this.filter=new Fs(1e4,"lowpass",-24,4),this.compressor=new go({ratio:20,threshold:-24,release:1,attack:.003}),this.pitchShifter=new lo({pitch:-12});for(let t=0;t<this.numVoices;t++)window.safari?(this.grains[t]=new Rs({url:this.buffer,sampleRate:11025}),this.grains[t].channelCount=1,this.grains[t].unsync()):this.grains[t]=new Rs(this.buffer);this.setupMaster(),this.grains.forEach((async t=>{t.loop=!0,t.connect(this.grainOutput)})),this.grainOutput.connect(this.filter)}getNodes(){Object.entries(this).forEach((t=>{const e=t[1];"object"==typeof e&&e.connect&&console.log(e)}))}debug(){this.grains.forEach((t=>{t.debug=!0,t.playbackRate=1,t.grainSize=.5})),this.setClockFrequency(1)}setupMaster(){this.output=new Pi(1),this.output.name="Output",this.output.gain.setValueAtTime(.7/this.numVoices,yo()),this.pitchShifter.windowSize=1,this.filter.connect(this.compressor),window.isMp3?(this.compressor.connect(this.pitchShifter),this.pitchShifter.connect(this.output)):(this.pitchShifter.dispose(),this.compressor.dispose(),this.filter.connect(this.output)),this.output.connect(this.dest)}isGrainLoaded(t){return new Promise(((e,n)=>{t.onerror&&n("couldn't load grains"),t.loaded&&e(t.loaded)}))}async play(t=1){this.transport.start(),this.output.gain.setValueAtTime(1/this.numVoices,yo());const e=this.grains.map((t=>this.isGrainLoaded(t)));await Promise.all(e),this.grains.forEach((async(e,n)=>{e.start(`+${n}`,n+t)})),this.isStopped=!1}stop(){this.grains.forEach((t=>{t.stop()})),this.isStopped=!0}kill(){this.grains.forEach((t=>t.dispose()))}chainEffect(t){if(this.effectsChain.push(t),this.effectsChain.length>1){const t=this.effectsChain[0],e=this.effectsChain[this.effectsChain.length-1];this.input.disconnect(),e&&e.disconnect(),this.input.connect(t);for(let t=0;t<this.effectsChain.length-1;t++)this.effectsChain[t].connect(this.effectsChain[t+1]);e.connect(this.dest)}}setClockFrequency(t,e){this.grains.forEach((e=>e._clock.frequency.targetRampTo(t,"+0.1")))}detuneLFO(){this.grains.forEach((t=>{const e=new Ss({frequency:Math.random().toFixed(2),max:10,min:-10});e.connect(t.detune),e.start()}))}swellLFO(){this.volumeLFO=new Ss({frequency:Math.random().toFixed(2)/4,max:.5}),this.volumeLFO.connect(this.output.gain),this.volumeLFO.start()}randomStarts(){this.grains.forEach((t=>{t.stop(),t.start(yo(),Math.random()*t.buffer.duration)}))}randRange(t,e){return Math.random()*(e-t)+t}randomizeParameters(){const{randRange:t}=this;this.stop(),this.setDetune(t(-100,100)),this.setPitchShift(-12,12),this.setGrainSize(t(.1,1)),this.setOverlap(t(.1,1)),this.setRate(t(-1,2)),this.setVolume(.5),this.play(),this.randomStarts()}getCurrentValues(){const t=[];return["detune","overlap","grainSize","loopStart","loopEnd","playbackRate"].forEach((e=>{t.push(t[e]=this.getGrainValues(e))})),t}setCurrentValues(t){this.grains.forEach(((e,n)=>{e.detune=t.detune[n],e.overlap=t.overlap[n],e.grainSize=t.grainSize[n],e.loopEnd=t.loopEnd[n],e.playbackRate=t.playbackRate[n],e.reverse=Math.random()<.2}))}randArrayFromRange(t,e,n){return Array.from({length:t},(()=>this.randRange(e,n)))}feedbackCombFilter(){this.combFilter=new Ys(.5,.9,1e3),this.chainEffect(this.combFilter)}randomInterpolate(){const t=this.grains.length,e=(this.getCurrentValues(),{detune:this.randArrayFromRange(t,-1e3,100),overlap:this.randArrayFromRange(t,.01,1),grainSize:this.randArrayFromRange(t,.001,.05),playbackRate:this.randArrayFromRange(t,.01,.05),loopEnd:this.randArrayFromRange(t,0,this.grains[0].buffer.duration)});this.setClockFrequency(1*Math.random(),10),this.setCurrentValues(e)}randomLoop(t){this.loop=new to((()=>{this.randomInterpolate(),this.grains.forEach((t=>{Math.random()<.2?t.stop():t.start(yo())}))}),t).start()}setPitchShift(t){this.pitchShifter.pitch=Number(t)}getPitchShift(){return this.pitchShifter.pitch}setDetune(t){const e=t/2;this.grains.forEach((n=>n.detune=Math.random()*t-e))}getDetune(){}getGrainValues(t){const e=[];return this.grains.forEach((n=>{t in n&&e.push(n[t])})),e}setRate(t){this.grains.forEach((e=>e.playbackRate=t))}setOverlap(t){this.grains.forEach((e=>e.overlap=t))}setGrainSize(t){this.grains.forEach((e=>e.grainSize=t))}setLoopStart(t){this.grains.forEach((e=>e.loopStart=t))}setLoopEnd(t){this.grains.forEach((e=>e.loopEnd=t))}setVolume(t){this.output.gain.setValueAtTime(t,this.toneContext.currentTime)}rampVolume(t,e){this.output.gain.rampTo(t,e)}};var bo=function(t,e){return(bo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function xo(t,e){function n(){this.constructor=t}bo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var To=function(){return(To=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function ko(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((r=r.apply(t,e||[])).next())}))}function Co(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function So(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ao(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function Oo(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ao(arguments[e]));return t}function Eo(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var Ro=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};function Do(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Do(t[n],e[n]));return t}var Mo=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function Io(){try{return"[object process]"===Object.prototype.toString.call(i.g.process)}catch(t){return!1}}var Po=function(t){function e(n,r,i){var s=t.call(this,r)||this;return s.code=n,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,No.prototype.create),s}return xo(e,t),e}(Error),No=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,s=this.errors[t],o=s?Vo(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",u=new Po(i,a,r);return u},t}();function Vo(t,e){return t.replace(qo,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var qo=/\{\$([^}]+)}/g;function jo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(s=l^u&(c^l),o=1518500249):(s=u^c^l,o=1859775393):r<60?(s=u&c|l&(u|c),o=2400959708):(s=u^c^l,o=3395469782);i=(a<<5|a>>>27)+s+h+o+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<e;){if(0===s)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[s]=t.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<e;)if(i[s]=t[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();function Lo(t,e){var n=new Fo(t,e);return n.subscribe.bind(n)}var Fo=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=Bo),void 0===r.error&&(r.error=Bo),void 0===r.complete&&(r.complete=Bo);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Bo(){}var Uo=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),zo="[DEFAULT]",Wo=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=zo);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Mo;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=To({identifier:zo,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(i);if(!s){if(r)return null;throw Error("Service "+this.name+" is not available")}return s}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(zo)}catch(t){}try{for(var r=So(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=Ao(i.value,2),o=s[0],a=s[1],u=this.normalizeInstanceIdentifier(o);try{var c=this.getOrInitializeService(u);a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=zo),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return ko(this,void 0,void 0,(function(){var t;return Co(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Oo(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===zo?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:zo:t},t}();var Go,Ho=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Wo(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function $o(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}var Xo,Zo=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Xo||(Xo={}));var Yo,Qo={debug:Xo.DEBUG,verbose:Xo.VERBOSE,info:Xo.INFO,warn:Xo.WARN,error:Xo.ERROR,silent:Xo.SILENT},Ko=Xo.INFO,Jo=((Go={})[Xo.DEBUG]="log",Go[Xo.VERBOSE]="log",Go[Xo.INFO]="info",Go[Xo.WARN]="warn",Go[Xo.ERROR]="error",Go),ta=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),s=Jo[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,$o(["["+i+"]  "+t.name+":"],n))}},ea=function(){function t(t){this.name=t,this._logLevel=Ko,this._logHandler=ta,this._userLogHandler=null,Zo.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Xo))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?Qo[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,$o([this,Xo.DEBUG],t)),this._logHandler.apply(this,$o([this,Xo.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,$o([this,Xo.VERBOSE],t)),this._logHandler.apply(this,$o([this,Xo.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,$o([this,Xo.INFO],t)),this._logHandler.apply(this,$o([this,Xo.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,$o([this,Xo.WARN],t)),this._logHandler.apply(this,$o([this,Xo.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,$o([this,Xo.ERROR],t)),this._logHandler.apply(this,$o([this,Xo.ERROR],t))},t}();function na(t){Zo.forEach((function(e){e.setLogLevel(t)}))}var ra,ia=((Yo={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Yo["bad-app-name"]="Illegal App name: '{$appName}",Yo["duplicate-app"]="Firebase App named '{$appName}' already exists",Yo["app-deleted"]="Firebase App named '{$appName}' already deleted",Yo["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Yo["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Yo),sa=new No("app","Firebase",ia),oa="@firebase/app",aa="[DEFAULT]",ua=((ra={})[oa]="fire-core",ra["@firebase/analytics"]="fire-analytics",ra["@firebase/auth"]="fire-auth",ra["@firebase/database"]="fire-rtdb",ra["@firebase/functions"]="fire-fn",ra["@firebase/installations"]="fire-iid",ra["@firebase/messaging"]="fire-fcm",ra["@firebase/performance"]="fire-perf",ra["@firebase/remote-config"]="fire-rc",ra["@firebase/storage"]="fire-gcs",ra["@firebase/firestore"]="fire-fst",ra["fire-js"]="fire-js",ra["firebase-wrapper"]="fire-js-all",ra),ca=new ea("@firebase/app"),la=function(){function t(t,e,n){var r,i,s=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Do(void 0,t),this.container=new Ho(e.name),this._addComponent(new Uo("app",(function(){return s}),"PUBLIC"));try{for(var o=So(this.firebase_.INTERNAL.components.values()),a=o.next();!a.done;a=o.next()){var u=a.value;this._addComponent(u)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=aa),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=aa),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){ca.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw sa.create("app-deleted",{appName:this.name_})},t}();la.prototype.name&&la.prototype.options||la.prototype.delete||console.log("dc");function ha(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var s=i;void 0===s.name&&(s.name=aa);var o=s.name;if("string"!=typeof o||!o)throw sa.create("bad-app-name",{appName:String(o)});if(jo(e,o))throw sa.create("duplicate-app",{appName:o});var a=new t(n,s,r);return e[o]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=ua[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void ca.warn(u.join(" "))}s(new Uo(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:na,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw sa.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Qo[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:Xo[n].toLowerCase(),message:o,args:i,type:e.name})}},r=0,i=Zo;r<i.length;r++)n(i[r])}(t,e)},apps:null,SDK_VERSION:"8.0.1",INTERNAL:{registerComponent:s,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!jo(e,t=t||aa))throw sa.create("no-app",{appName:t});return e[t]}function s(s){var o,a,u=s.name;if(n.has(u))return ca.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===s.type?r[u]:null;if(n.set(u,s),"PUBLIC"===s.type){var c=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[u])throw sa.create("invalid-app-argument",{appName:u});return t[u]()};void 0!==s.serviceProps&&Do(c,s.serviceProps),r[u]=c,t.prototype[u]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,u);return n.apply(this,s.multipleInstances?t:[])}}try{for(var l=So(Object.keys(e)),h=l.next();!h.done;h=l.next()){var p=h.value;e[p]._addComponent(s)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return"PUBLIC"===s.type?r[u]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}var pa=function t(){var e=ha(la);return e.INTERNAL=To(To({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Do(e,t)},createSubscribe:Lo,ErrorFactory:No,deepExtend:Do}),e}(),fa=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){ca.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var da=self.firebase.SDK_VERSION;da&&da.indexOf("LITE")>=0&&ca.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _a=pa.initializeApp;pa.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Io()&&ca.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_a.apply(void 0,t)};var ma=pa;!function(t,e){t.INTERNAL.registerComponent(new Uo("platform-logger",(function(t){return new fa(t)}),"PRIVATE")),t.registerVersion(oa,"0.6.13",e),t.registerVersion("fire-js","")}(ma);const ga=ma;ga.registerVersion("firebase","8.0.2","app");var va="firebasestorage.googleapis.com",ya=function(t){function e(n,r){var i=t.call(this,La(n),"Firebase Storage: "+r+" ("+La(n)+")")||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return xo(e,t),e.prototype.codeEquals=function(t){return La(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(Po),wa="unknown",ba="object-not-found",xa="quota-exceeded",Ta="unauthenticated",ka="unauthorized",Ca="retry-limit-exceeded",Sa="canceled",Aa="invalid-url",Oa="invalid-default-bucket",Ea="no-default-bucket",Ra="cannot-slice-blob",Da="server-file-wrong-size",Ma="no-download-url",Ia="invalid-argument",Pa="app-deleted",Na="invalid-root-operation",Va="invalid-format",qa="internal-error",ja="unsupported-environment";function La(t){return"storage/"+t}function Fa(){return new ya(wa,"An unknown error occurred, please check the error payload for server response.")}function Ba(){return new ya(Sa,"User canceled the upload/download.")}function Ua(){return new ya(Ra,"Cannot slice blob for upload. Please retry the upload.")}function za(t){return new ya(Ia,t)}function Wa(){return new ya(Pa,"The Firebase app was deleted.")}function Ga(t){return new ya(Na,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ha(t,e){return new ya(Va,"String does not match format '"+t+"': "+e)}function $a(t){throw new ya(qa,"Internal error: "+t)}var Xa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Za=function(t,e){this.data=t,this.contentType=e||null};function Ya(t,e){switch(t){case Xa.RAW:return new Za(Qa(e));case Xa.BASE64:case Xa.BASE64URL:return new Za(Ka(t,e));case Xa.DATA_URL:return new Za((n=new Ja(e)).base64?Ka(Xa.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw Ha(Xa.DATA_URL,"Malformed data URL.")}return Qa(e)}(n.rest),function(t){return new Ja(t).contentType}(e))}var n;throw Fa()}function Qa(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Ka(t,e){switch(t){case Xa.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw Ha(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Xa.BASE64URL:var i=-1!==e.indexOf("+"),s=-1!==e.indexOf("/");if(i||s)throw Ha(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=atob(e)}catch(e){throw Ha(t,"Invalid character found")}for(var a=new Uint8Array(o.length),u=0;u<o.length;u++)a[u]=o.charCodeAt(u);return a}var Ja=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Ha(Xa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i};var tu,eu={STATE_CHANGED:"state_changed"},nu="running",ru="pausing",iu="paused",su="success",ou="canceling",au="canceled",uu="error",cu={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function lu(t){switch(t){case nu:case ru:case ou:return cu.RUNNING;case iu:return cu.PAUSED;case su:return cu.SUCCESS;case au:return cu.CANCELED;case uu:default:return cu.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(tu||(tu={}));var hu=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=tu.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=tu.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=tu.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw $a("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw $a("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw $a("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw $a("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),pu=function(){function t(){}return t.prototype.createXhrIo=function(){return new hu},t}();function fu(t){return"string"==typeof t||t instanceof String}function du(t){return _u()&&t instanceof Blob}function _u(){return"undefined"!=typeof Blob}function mu(t,e,n,r){if(r<e)throw new ya(Ia,"Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw new ya(Ia,"Invalid value for '"+t+"'. Expected "+n+" or less.")}function gu(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function vu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=gu();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(_u())return new Blob(t);throw new ya(ja,"This browser doesn't seem to support creating Blobs")}var yu=function(){function t(t,e){var n=0,r="";du(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(du(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(_u()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(vu.apply(null,r))}var i=e.map((function(t){return fu(t)?Ya(Xa.RAW,t).data:t.data_})),s=0;i.forEach((function(t){s+=t.byteLength}));var o=new Uint8Array(s),a=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)o[a++]=t[e]})),new t(o,!0)},t.prototype.uploadData=function(){return this.data_},t}(),wu=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw new ya(Oa,"Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}for(var o=va.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/"+r+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+r+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:s}],u=0;u<a.length;u++){var c=a[u],l=c.regex.exec(e);if(l){var h=l[c.indices.bucket],p=l[c.indices.path];p||(p=""),n=new t(h,p),c.postModify(n);break}}if(null==n)throw function(t){return new ya(Aa,"Invalid URL '"+t+"'.")}(e);return n},t}();function bu(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function xu(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Tu(t){return"https://"+va+"/v0"+t}function ku(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}function Cu(t,e){return e}var Su=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Cu},Au=null;function Ou(){if(Au)return Au;var t=[];t.push(new Su("bucket")),t.push(new Su("generation")),t.push(new Su("metageneration")),t.push(new Su("name","fullPath",!0));var e=new Su("name");e.xform=function(t,e){return function(t){return!fu(t)||t.length<2?t:xu(t)}(e)},t.push(e);var n=new Su("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Su("timeCreated")),t.push(new Su("updated")),t.push(new Su("md5Hash",null,!0)),t.push(new Su("cacheControl",null,!0)),t.push(new Su("contentDisposition",null,!0)),t.push(new Su("contentEncoding",null,!0)),t.push(new Su("contentLanguage",null,!0)),t.push(new Su("contentType",null,!0)),t.push(new Su("metadata","customMetadata",!0)),Au=t}function Eu(t,e,n){for(var r={type:"file"},i=n.length,s=0;s<i;s++){var o=n[s];r[o.local]=o.xform(r,e[o.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new wu(n,r);return e.makeStorageReference(i)}})}(r,t),r}function Ru(t,e,n){var r=bu(e);return null===r?null:Eu(t,r,n)}function Du(t,e){for(var n={},r=e.length,i=0;i<r;i++){var s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}function Mu(t,e,n){var r=bu(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,s=n.prefixes;i<s.length;i++){var o=s[i].replace(/\/$/,""),a=t.makeStorageReference(new wu(e,o));r.prefixes.push(a)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var l=c[u];a=t.makeStorageReference(new wu(e,l.name)),r.items.push(a)}return r}(t,e,r)}var Iu=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Pu(t){if(!t)throw Fa()}function Nu(t,e){return function(n,r){var i=Ru(t,r,e);return Pu(null!==i),i}}function Vu(t,e){return function(n,r){var i=Ru(t,r,e);return Pu(null!==i),function(t,e){var n=bu(e);if(null===n)return null;if(!fu(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.bucket,r=t.fullPath;return Tu("/b/"+i(n)+"/o/"+i(r))+ku({alt:"media",token:e})}))[0]}(i,r)}}function qu(t){return function(e,n){var r,i,s;return 401===e.getStatus()?r=new ya(Ta,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,r=new ya(xa,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new ya(ka,"User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function ju(t){var e=qu(t);return function(n,r){var i,s=e(n,r);return 404===n.getStatus()&&(i=t.path,s=new ya(ba,"Object '"+i+"' does not exist.")),s.serverResponse=r.serverResponse,s}}function Lu(t,e,n){var r=Tu(e.fullServerUrl()),i=t.maxOperationRetryTime,s=new Iu(r,"GET",Nu(t,n),i);return s.errorHandler=ju(e),s}function Fu(t,e,n,r,i){var s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);var o=Tu(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,u=new Iu(o,"GET",function(t,e){return function(n,r){var i=Mu(t,e,r);return Pu(null!==i),i}}(t,e.bucket),a);return u.urlParams=s,u.errorHandler=qu(e),u}function Bu(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var Uu=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function zu(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Pu(!1)}return Pu(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Wu=262144;function Gu(t,e,n,r,i,s,o,a){var u=new Uu(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new ya(Da,"Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,p=h+l,f={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,p);if(null===d)throw Ua();var _=e.maxUploadRetryTime,m=new Iu(n,"POST",(function(t,n){var i,o=zu(t,["active","final"]),a=u.current+l,c=r.size();return i="final"===o?Nu(e,s)(t,n):null,new Uu(a,c,"final"===o,i)}),_);return m.headers=f,m.body=d.uploadData(),m.progressCallback=a||null,m.errorHandler=qu(t),m}var Hu=function(t,e,n){if("function"==typeof t||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}},$u=function(t,e,n,r,i,s){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=s};function Xu(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Zu=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Ou(),this._resumable=this._shouldDoResumable(this._blob),this._state=nu,this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t.codeEquals(Sa)?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition(uu))},this._metadataErrorHandler=function(t){r._request=void 0,t.codeEquals(Sa)?r.completeTransitions_():(r._error=t,r._transition(uu))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){this._state===nu&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage.getAuthToken().then((function(n){switch(e._state){case nu:t(n);break;case ou:e._transition(au);break;case ru:e._transition(iu)}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var s=e.bucketOnlyServerUrl(),o=Bu(e,r,i),a={name:o.fullPath},u=Tu(s),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=Du(o,n),h=t.maxUploadRetryTime,p=new Iu(u,"POST",(function(t){var e;zu(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Pu(!1)}return Pu(fu(e)),e}),h);return p.urlParams=a,p.headers=c,p.body=l,p.errorHandler=qu(e),p}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime,s=new Iu(n,"POST",(function(t){var e=zu(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Pu(!1)}n||Pu(!1);var i=Number(n);return Pu(!isNaN(i)),new Uu(i,r.size(),"final"===e)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=qu(e),s}(t._ref.storage,t._ref._location,e,t._blob),i=t._ref.storage.makeRequest(r,n);t._request=i,i.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=Wu*this._chunkMultiplier,n=new Uu(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i){var s;try{s=Gu(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition(uu)}var o=t._ref.storage.makeRequest(s,i);t._request=o,o.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition(su)):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){Wu*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=Lu(t._ref.storage,t._ref._location,t._mappings),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition(su)}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;var u=Bu(e,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Du(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=yu.getBlob(c,r,l);if(null===h)throw Ua();var p={name:u.fullPath},f=Tu(s),d=t.maxUploadRetryTime,_=new Iu(f,"POST",Nu(t,n),d);return _.urlParams=p,_.headers=o,_.body=h.uploadData(),_.errorHandler=qu(e),_}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition(su)}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case ou:case ru:this._state=t,void 0!==this._request&&this._request.cancel();break;case nu:var e=this._state===iu;this._state=t,e&&(this._notifyObservers(),this._start());break;case iu:this._state=t,this._notifyObservers();break;case au:this._error=Ba(),this._state=t,this._notifyObservers();break;case uu:case su:this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case ru:this._transition(iu);break;case ou:this._transition(au);break;case nu:this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=lu(this._state);return new $u(this._transferred,this._blob.size(),t,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,s=new Hu(e,n,r);return this._addObserver(s),function(){i._removeObserver(s)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(lu(this._state)){case cu.SUCCESS:Xu(this._resolve.bind(null,this.snapshot))();break;case cu.CANCELED:case cu.ERROR:Xu(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(lu(this._state)){case cu.RUNNING:case cu.PAUSED:t.next&&Xu(t.next.bind(t,this.snapshot))();break;case cu.SUCCESS:t.complete&&Xu(t.complete.bind(t))();break;case cu.CANCELED:case cu.ERROR:t.error&&Xu(t.error.bind(t,this._error))();break;default:t.error&&Xu(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t=this._state===iu||this._state===ru;return t&&this._transition(nu),t},t.prototype.pause=function(){var t=this._state===nu;return t&&this._transition(ru),t},t.prototype.cancel=function(){var t=this._state===nu||this._state===ru;return t&&this._transition(ou),t},t}(),Yu=function(){function t(t,e){this._service=t,this._location=e instanceof wu?e:wu.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype.newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new wu(this._location.bucket,"");return this.newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return xu(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new wu(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Ga(t)},t}();function Qu(t){var e={prefixes:[],items:[]};return Ku(t,e).then((function(){return e}))}function Ku(t,e,n){return ko(this,void 0,void 0,(function(){var r,i,s;return Co(this,(function(o){switch(o.label){case 0:return[4,Ju(t,{pageToken:n})];case 1:return r=o.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(s=e.items).push.apply(s,r.items),null==r.nextPageToken?[3,3]:[4,Ku(t,e,r.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function Ju(t,e){return ko(this,void 0,void 0,(function(){var n,r,i;return Co(this,(function(s){switch(s.label){case 0:return null!=e&&"number"==typeof e.maxResults&&mu("options.maxResults",1,1e3,e.maxResults),[4,t.storage.getAuthToken()];case 1:return n=s.sent(),r=e||{},i=Fu(t.storage,t._location,"/",r.pageToken,r.maxResults),[2,t.storage.makeRequest(i,n).getPromise()]}}))}))}function tc(t,e){return ko(this,void 0,void 0,(function(){var n,r;return Co(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage.getAuthToken()];case 1:return n=i.sent(),r=function(t,e,n,r){var i=Tu(e.fullServerUrl()),s=Du(n,r),o=t.maxOperationRetryTime,a=new Iu(i,"PATCH",Nu(t,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=ju(e),a}(t.storage,t._location,e,Ou()),[2,t.storage.makeRequest(r,n).getPromise()]}}))}))}function ec(t){return ko(this,void 0,void 0,(function(){var e,n;return Co(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e,n){var r=Tu(e.fullServerUrl()),i=t.maxOperationRetryTime,s=new Iu(r,"GET",Vu(t,n),i);return s.errorHandler=ju(e),s}(t.storage,t._location,Ou()),[2,t.storage.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new ya(Ma,"The given file does not have any download URLs.");return t}))]}}))}))}function nc(t){return ko(this,void 0,void 0,(function(){var e,n;return Co(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e){var n=Tu(e.fullServerUrl()),r=t.maxOperationRetryTime,i=new Iu(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=ju(e),i}(t.storage,t._location),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}function rc(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new wu(t._location.bucket,n);return new Yu(t.storage,r)}var ic=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),sc=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new ic(this._delegate.snapshot,this,this._ref)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new ic(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,s=void 0;return e&&(s="function"==typeof e?function(t){return e(new ic(t,i,i._ref))}:{next:e.next?function(t){return e.next(new ic(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,s,n||void 0,r||void 0)},t}(),oc=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new ac(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new ac(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),ac=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(rc(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new sc(function(t,e,n){return void 0===n&&(n=null),t._throwIfRoot("uploadBytesResumable"),new Zu(t,new yu(e),n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){return void 0===e&&(e=Xa.RAW),this._throwIfRoot("putString"),new sc(function(t,e,n,r){void 0===n&&(n=Xa.RAW),t._throwIfRoot("putString");var i=Ya(n,e),s=To({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),new Zu(t,new yu(i.data,!0),s)}(this._delegate,t,e,n),this)},t.prototype.listAll=function(){var t=this;return Qu(this._delegate).then((function(e){return new oc(e,t.storage)}))},t.prototype.list=function(t){var e=this;return Ju(this._delegate,t).then((function(t){return new oc(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return ko(this,void 0,void 0,(function(){var e,n;return Co(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=Lu(t.storage,t._location,Ou()),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}(this._delegate)},t.prototype.updateMetadata=function(t){return tc(this._delegate,t)},t.prototype.getDownloadURL=function(){return ec(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),nc(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Ga(t)},t}(),uc=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();var cc=function(){function t(t,e,n,r,i,s,o,a,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,s=t.reject_,o=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(o,o.getResponseText());void 0!==a?i(a):i()}catch(t){s(t)}else null!==o?((r=Fa()).serverResponse=o.getResponseText(),t.errorCallback_?s(t.errorCallback_(o,r)):s(r)):n.canceled?s(r=t.appDelete_?Wa():Ba()):s(r=new ya(Ca,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new lc(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,s=!1,o=0;function a(){return 2===o}var u=!1;function c(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function l(e){i=setTimeout((function(){i=null,t(h,a())}),e)}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)c.call.apply(c,Eo([null,t],e));else{var i;a()||s?c.call.apply(c,Eo([null,t],e)):(r<64&&(r*=2),1===o?(o=2,i=0):i=1e3*(r+Math.random()),l(i))}}var p=!1;function f(t){p||(p=!0,u||(null!==i?(t||(o=2),clearTimeout(i),l(0)):t||(o=1)))}return l(0),setTimeout((function(){s=!0,f(!0)}),n),f}((function(e,n){if(n)e(!1,new lc(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===tu.NO_ERROR,s=n.getStatus();if(r&&!t.isRetryStatusCode_(s)){var o=-1!==t.successCodes_.indexOf(s);e(!0,new lc(o,n))}else{var a=n.getErrorCode()===tu.ABORT;e(!1,new lc(!1,null,a))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),lc=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function hc(t,e,n,r){var i=ku(t.urlParams),s=t.url+i,o=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(o,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(o,n),function(t){var e=void 0!==ga?ga.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new cc(s,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}function pc(t){return/^[A-Za-z]+:\/\//.test(t)}function fc(t,e){if(t instanceof gc){var n=t;if(null==n._bucket)throw new ya(Ea,"No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new Yu(n,n._bucket);return null!=e?fc(r,e):r}if(void 0!==e){if(e.includes(".."))throw za('`path` param cannot contain ".."');return rc(t,e)}return t}function dc(t,e){if(e&&pc(e)){if(t instanceof gc)return new Yu(t,e);throw za("To use ref(service, url), the first argument must be a Storage instance.")}return fc(t,e)}var _c,mc,gc=function(){function t(t,e,n,r){var i,s;this.app=t,this._authProvider=e,this._pool=n,this._url=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?wu.makeFromBucketSpec(r):(i=this.app.options,null==(s=null==i?void 0:i.storageBucket)?null:wu.makeFromBucketSpec(s))}return Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){mu("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){mu("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype.getAuthToken=function(){return ko(this,void 0,void 0,(function(){var t,e;return Co(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype.makeStorageReference=function(t){return new Yu(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this._deleted)return new uc(Wa());var r=hc(t,this._appId,e,this._pool);return this._requests.add(r),r.getPromise().then((function(){return n._requests.delete(r)}),(function(){return n._requests.delete(r)})),r},t}(),vc=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(pc(t))throw za("ref() expected a child path but got a URL, use refFromURL instead.");return new ac(dc(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!pc(t))throw za("refFromURL() expected a full URL but got a child path, use ref() instead.");try{wu.makeFromUrl(t)}catch(t){throw za("refFromUrl() expected a valid full URL but got an invalid one.")}return new ac(dc(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t}();function yc(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new vc(n,new gc(n,r,new pu,e))}mc={TaskState:cu,TaskEvent:eu,StringFormat:Xa,Storage:gc,Reference:ac},(_c=ga).INTERNAL.registerComponent(new Uo("storage",yc,"PUBLIC").setServiceProps(mc).setMultipleInstances(!0)),_c.registerVersion("@firebase/storage","0.4.2");var wc=i(877);const bc=class{constructor(t,e="audio/mpeg-3"){this.firebaseConfig={apiKey:"AIzaSyAbb8-7skMg99nzAlvUaqR6vfQvD7q_7Vs",authDomain:"test-a201f.firebaseapp.com",databaseURL:"https://test-a201f.firebaseio.com",projectId:"test-a201f",storageBucket:"test-a201f.appspot.com",messagingSenderId:"120555329679",appId:"1:120555329679:web:a8734f69a5da95480df8fa",measurementId:"G-QLSEEEE02P"},this.suffix="audio/mpeg-3"===e?"mp3":"aac",ga.initializeApp(this.firebaseConfig),this.audioCtx=t,this.storage=ga.storage(),this.storageRef=this.storage.ref(),this.audioRef=this.storageRef.child(`audio-${(0,wc.v4)()}.${this.suffix}`)}async listAll(){this.files=await this.storageRef.list(),"aac"===this.suffix&&this.getAacFiles()}async getAacFiles(){return new Promise((async(t,e)=>{this.filePromises=[],this.fileNames=[],this.files.items.forEach((async t=>{this.filePromises.push(t.getMetadata())})),this.filesMetadata=await Promise.all(this.filePromises),this.filesMetadata.filter((t=>{"audio/aac"===t.contentType&&this.fileNames.push(t.fullPath)})),t(this.fileNames)}))}async getRandomSample(){const t=this.files.items[~~(Math.random()*this.files.items.length)];this.audioFile=await t.getDownloadURL()}async downloadSample(t){return fetch(t,{cors:"opaque"}).then((t=>t.arrayBuffer())).then((t=>this.audioCtx.decodeAudioData(t))).catch((t=>console.log(t)))}async uploadSample(t){this.uploadTask=this.audioRef.put(t,{contentType:t.type}),this.uploadTask.on("state_changed",(t=>{this.progress=t.bytesTransferred/t.totalBytes*100,ga.storage.TaskState.RUNNING}),(t=>{}),(()=>{this.uploadTask.snapshot.ref.getDownloadURL().then((function(t){window.logging&&console.log("File available at",t)}))}))}};const xc=class{constructor(t=800,e){this.length=t,this.audioCtx=e}async getPermissions(){return new Promise((async(t,e)=>{try{const e=navigator.mediaCapabilities.decodingInfo({type:"file",audio:{contentType:"audio/mp3"}}).then((t=>t.supported));!0===await e?this.type="audio/mpeg-3":this.type="audio/aac";const n=await navigator.mediaDevices.getUserMedia({audio:!0});this.stream=n,t(n)}catch(t){return console.log(t),!1}}))}async recordChunks(){return new Promise(((t,e)=>{this.recording=!0,this.mediaRecorder=new MediaRecorder(this.stream),console.log(this.mediaRecorder),this.mediaRecorder.start(),this.audioChunks=[],this.mediaRecorder.addEventListener("dataavailable",(e=>{this.audioChunks.push(e.data),t(!0)}))}))}async stopRecording(){return new Promise(((t,e)=>{this.mediaRecorder.stop(),this.recording=!1,this.mediaRecorder.addEventListener("stop",(()=>{this.audioBlob=new Blob(this.audioChunks,{type:this.type}),console.log(this.audioBlob),this.audioUrl=URL.createObjectURL(this.audioBlob),t(this.audioBlob)}))}))}readBlobAsArrayBuffer(t){const e=new FileReader;return new Promise(((n,r)=>{e.onerror=()=>{e.abort(),r(new DOMException("Problem parsing input file."))},e.onload=()=>{n(e.result)},e.readAsArrayBuffer(t)}))}async loadToBuffer(t){if(!this.recording){const e=await this.readBlobAsArrayBuffer(t);let n;this.arrayBuffer=e;try{n=await this.audioCtx.decodeAudioData(this.arrayBuffer)}catch(t){n=this.audioContext.decodeAudioData((t=>t))}return new Promise(((t,e)=>{try{t(n),this.decodedBuffer=n}catch(t){e(t)}}))}}createSource(t){let e=this.audioCtx.createBufferSource();return e.buffer=t,e}};const Tc=class{constructor(t){this.input=new Pi(.8),this.limiter=new vo(-12),this.effectsChain=[],this.ctx=t,this.output=new Pi(1),this.dest=this.ctx.destination,window.isMp3&&this.chainEffect(this.limiter)}test(){var t=this.ctx.createOscillator();t.frequency.setValueAtTime(440,this.ctx.currentTime),t.connect(this.output),t.start()}setVolume(t){this.output.gain.setValueAtTime(t,this.ctx.getCurrentTime)}connectSource(t){try{return this.source=t,t.connect(this.input),!0}catch(t){return!1}}chorus(t=.1,e=20,n=.9){this.chorus=new uo(t,e,n).start(),this.chainEffect(this.chorus)}chainEffect(t){if(this.effectsChain.push(t),this.effectsChain.length>1){const t=this.effectsChain[0],e=this.effectsChain[this.effectsChain.length-1];this.input.disconnect(),e&&e.disconnect(),this.input.connect(t);for(let t=0;t<this.effectsChain.length-1;t++)this.effectsChain[t].connect(this.effectsChain[t+1]);e.toDestination()}else this.input.connect(this.effectsChain[0]).connect(this.dest)}removeEffect(t){this.output.disconnect(t),this.output.connect(this.dest)}lowpassFilter(t,e){this.filter=new Fs(t,"lowpass",-24,e),this.chainEffect(this.filter)}delay(t=100,e=.5){this.masterDelay=new zi(t,e),this.chainEffect(this.masterDelay)}async reverb(t,e=.3,n=4,r=1){t?(this.masterReverb=new ho({preDelay:e,decay:n,wet:r}),await this.masterReverb.generate(),this.chainEffect(this.masterReverb)):this.masterReverb&&this.removeEffect(this.masterReverb)}disconnect(){this.dest.disconnect()}};const kc=class{constructor(t){this.randomValues=[...Array(20)].map((()=>Math.floor(12*Math.random()))),this.ctx=t,this.uiSynth=new Qs({polyphony:3,voice:Bs,maxPolyphony:3}),this.uiSynth.set({envelope:{attack:0,decay:.1,release:.5},harmonicity:2,volume:2}),this.idx=0,this.master=new Pi(.1),this.uiSynth.connect(this.master)}play(t){this.idx++,this.uiSynth.set({harmonicity:this.randomValues[this.idx%this.randomValues.length]}),this.uiSynth.set({modulationIndex:this.randomValues[this.idx%this.randomValues.length]});try{t.forEach((t=>{var e,n;this.uiSynth.triggerAttackRelease((e=t,new Ti(fi(),e,n)).harmonize([0,3,7,11,13,15,17,19,21,23]),0,yo())}))}catch(t){this.uiSynth.releaseAll()}}};async function Cc(t,e,n="audio/mpeg-3"){return fetch(t).then((t=>t.arrayBuffer())).then((t=>e.decodeAudioData(t))).catch((t=>console.log(t)))}async function Sc(t,e){let n,r;return new Promise((async(s,o)=>{try{n=await fetch(t,{mimeType:"audio/aac"}),r=await n.arrayBuffer()}catch(t){i.e(823).then(i.bind(i,823)).then((async t=>{n=await fetch(t.default,{mimeType:"audio/aac"}),r=await n.arrayBuffer()}))}let a;try{a=await Wn(e._context._nativeContext,r)}catch(t){i.e(823).then(i.bind(i,823)).then((async t=>{n=await fetch(t.default,{mimeType:"audio/aac"}),r=await n.arrayBuffer(),a=await Wn(e._context._nativeContext,r)}))}window.logging&&console.log(a),s(a)}))}function Ac(t,e,n,r,i){return(t-e)*(i-r)/(n-e)+r}function Oc(t,e){return new Promise((async(n,r)=>{let i;"number"!=typeof e&&e<=0&&r("Samplerate is not a number"),t||r("Input buffer is undefined"),i=typeof t.sampleRate===Number?t.sampleRate/e:44100/e;let s=t.length*i,o=new pr(t.numberOfChannels,s,e),a=o.createBufferSource();const u=o.createGain();u.gain.value=Ec(t),window.logging&&console.log(u.gain.value),a.buffer=t,a.connect(u),u.connect(o.destination),a.start(0);try{n(await o.startRendering())}catch(t){r(t)}}))}function Ec(t){if(!1===Object&&(Dc("buffer is invalid. Skipping"),reject(!1)),t){for(var e=t.getChannelData(0),n=Math.floor(.05*t.sampleRate),r=[],i=0,s=0;s<e.length;s++)i+=e[s]**2,s%n==0&&(i=Math.sqrt(i/n),r.push(i),i=0);return r.sort((function(t,e){return t-e})),1/r[Math.floor(.95*r.length)]/10}}function Rc(t){return t[Math.floor(Math.random()*t.length)]}function Dc(t){window.logging&&console.log(`%cSound: ${t}`,"color:#233E82; font-family:'Arial';color:white; font-weight: 500; background:black;")}function Mc(t){return!!t&&(window.logging&&console.log(t.getChannelData(0).length),t.getChannelData(0).length<65536&&(Math.max(...t.getChannelData(0))>0||void 0))}i(486);fi().rawContext.suspend(),window.debounce=function(t,e){let n;return function(...r){n&&clearTimeout(n),n=setTimeout((()=>{t(...r)}),e)}};const Ic=window.innerWidth<600;let Pc;window.safari=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome");let Nc=navigator.userAgent.includes("iPhone")&&navigator.userAgent.includes("Safari");Nc=!1;let Vc=navigator.mediaCapabilities.decodingInfo({type:"file",audio:{contentType:"audio/mp3"}}).then((function(t){return t.supported})),qc=!1,jc=Ic?1:3,Lc=0,Fc=null;window.recordingLimitReached=!1,window.recording=!1,window.isMuted=!0,window.logging=!1;const Bc={latencyHint:"playback",updateInterval:1,bufferSize:256,state:"suspended"};let Uc=new si(Bc),zc=0,Wc=44100;Uc.name="Playback Context";let Gc;window.safari&&(Gc=new Audio,window.webkitAudioContext&&di(new webkitAudioContext(Bc)),window.OfflineAudioContext=window.webkitOfflineAudioContext,i.e(785).then(i.bind(i,785)).then((t=>{window.MediaRecorder=t.default})),window.addEventListener("touchstart",(()=>{Gc.autoplay=!0,Gc.muted=!1})),Dc("loaded MediaRecorder polyfill for safari"));const Hc=async()=>{void 0===Pc&&i.e(865).then(i.bind(i,945)).then((t=>{Pc=t.default,Gc.src=Pc,Gc.load(),Gc.loop=!0,Gc.addEventListener("loadedmetadata",(()=>{tl.classList="",tl.classList.add("fa-volume-off"),Gc.muted=!1,tl.classList.add("fa","fa-volume-off"),ol(),window.synthsLoaded=!0})),Gc.addEventListener("onended",(()=>{Gc.currentTime=0}))}))};let $c;di(Uc);let Xc=[];window.synthsLoaded=!1;const Zc=new kc(Uc);let Yc=new bc(Uc);let Qc=new xc(500,Uc),Kc=Ic?1:3,Jc=3;const tl=document.querySelector("#mute"),el=document.querySelector("#play"),nl=document.querySelector("#audiotooltip");let rl;el.addEventListener("click",(()=>{(async()=>{Dc("attempting to start audio"),await Uc.rawContext.resume(),await _i(),window.isSoundStarted=!0,Dc("Audio context is: "+Uc.rawContext.state),Dc("Asking for microphone permissions"),await Qc.getPermissions()})(),el.style.display="none",tl.style.display="inline-block"})),tl.onclick=async()=>{zc++,window.isMuted=!window.isMuted,window.safari&&(Gc.muted=window.isMuted,Uc.muted=window.isMuted,1===zc&&(Zc.master.toDestination(),Uc.resume(),Gc.play())),_l(window.isMuted),window.synthsLoaded&&(window.isMuted?fl():1===zc?cl():dl())};const il=async(t=null)=>new Promise((async(e,n)=>{if(console.log("Mp3 supported: "+window.isMp3),t){if(t){const e=await Oc(t,Wc);Xc.forEach((t=>{try{t.buffer.copyToChannel(e.getChannelData(0),0,0)}catch(n){t.buffer=e}t.setLoopStart(0),t.randomInterpolate()}))}}else Xc.forEach((async t=>{let e,n;if(await Yc.getRandomSample(),window.isMp3){let r;console.log(Yc.audioFile),e=await Cc(Yc.audioFile,Uc),console.log(e),Mc(e)>0?(r=e,Dc("clip is not silent, continuing")):(await Yc.getRandomSample(),e=await Cc(Yc.audioFile,Uc),r=e);try{const t=await Oc(r,Wc);n=removeZeroValues(t.getChannelData(0))}catch(t){Dc("reverting to original buffer"),n=e.getChannelData(0)}t.buffer.copyToChannel(n,0,0)}else{const n=await Yc.storageRef.child(Rc(Yc.fileNames)).getDownloadURL();console.log("trying to load aac file from "+n),e=await Sc(n,Uc),e.idealGain=console.log("new buffer: "+e),t.buffer=e,t.grainOutput.gain.value=Ec(e)/Jc}t.randomInterpolate(),Dc("reloaded buffers")}))}));let sl=0;window.addEventListener("radius_reached",(()=>{sl++,sl%20==0&&(console.log("radius reached"),il())}));const ol=()=>{window.addEventListener("pixel_added",(t=>{const{pixelX:e,pixelY:n}=t.data;let r;Dc("pixel added"),r&&clearTimeout(r),r=setTimeout((()=>{!window.isMuted&&Zc.play([e,window.height-n])}),33)}))};window.addEventListener("down",(async()=>{qc||window.isMuted||(qc=await Qc.getPermissions(),Dc(`user has ${qc?"":"not"} allowed recording.`)),!window.isMuted&&qc&&(Lc++,Lc>jc&&(window.recordingLimitReached=!0),!window.recordingLimitReached&&qc?(async()=>{new Promise((async(t,e)=>{if(window.MediaRecorder&&qc)try{Dc("started user recording #"+Lc),window.recording=!0,await Qc.recordChunks(),t(!0)}catch(t){Dc(t),e(!1)}else window.recording=!1,e(!1),Dc("media recording is not supported in this browser")}))})():Dc("user recording limit reached"))})),window.addEventListener("released",(()=>{window.isMuted||(window.recordingLimitReached||setTimeout((()=>{(async()=>{if(Qc.recording&&qc){const t=await Qc.stopRecording();try{Fc=await Qc.loadToBuffer(t)}catch(t){Dc(t)}il(Fc),Yc.uploadSample(Qc.audioBlob),Gc&&Gc.play(),Dc("stopped user recording #"+Lc),window.recording=!1}else window.recording=!1})()}),100),Dc("mouse is released"))}));const al=async()=>new Promise((async(t,e)=>{await Yc.listAll();const n=await Vc;if(!n){await Yc.getAacFiles();Jc=8}Dc(`mp3 is ${n?"":"not "}supported in this browser`);for(let t=0;t<Kc;t++){let e,r,i;if(n)e=await Cc(await Rc(Yc.files.items).getDownloadURL(),Uc),e&&Mc(e)>0?(r=e,Dc("clip is not silent, continuing")):(Dc("clip is silent: reloading"),e=await Cc(await Rc(Yc.files.items).getDownloadURL(),Uc),Dc(e),r=e);else{const t=await Yc.storageRef.child(Rc(Yc.fileNames)).getDownloadURL();console.log("trying to load aac file from "+t),e=await Sc(t,Uc),e.idealGain=Ec(e)/Jc,r=e}if(r){if(window.OfflineAudioContext)try{i=await Oc(r,Wc),i=removeZeroValues(i)}catch(t){i=r}else i=r;Xc.push(new wo(i,Uc,Jc)),Xc.forEach((t=>{t.filter.frequency.value=220,t.filter.gain.value=10,r.idealGain&&(t.grainOutput.gain.value=r.idealGain)})),window.synths=Xc,Dc("Loaded GrainSynth "+(t+1))}}window.soundtrackAudioCtx=Uc,$c=new Tc(Uc),$c.connectSource(Zc.master),(()=>{rl=new gs({frequency:40,harmonicity:.5,detune:0}),rl.filter=new Fs,rl.connect(rl.filter);const t=new is({type:"pink",volume:-14});t.connect(rl.filter),$c.connectSource(rl.filter),rl.volume.value=-64,rl.volume.targetRampTo(-28,10),rl.filter.frequency.value=60,rl.filter.gain.value=10,t.start("+1"),rl.start("+1")})(),$c.lowpassFilter(5e3,1),window.isMp3&&$c.chorus(.01,300,.9),!Ic&&window.isMp3&&$c.reverb(!0,.3,4,.7),window.synthsLoaded=!0,tl.classList=[],ul(),tl.classList.add("fa","fa-volume-off"),tl.disabled=!1,Dc("Voices loaded"),t(!0)})),ul=()=>{window.isMuted?nl.innerHTML="unmute sound":nl.innerHTML="mute sound"},cl=async()=>{ul(),window.isMuted||(await _i(),await Uc.resume(),Xc.forEach((async(t,e)=>{await t.isGrainLoaded(t.grains[t.grains.length-1]),window.logging&&Dc(t),t.isStopped||(t.randomInterpolate(),t.play(Uc.currentTime+.05*e),t.output.disconnect(t.dest),$c.connectSource(t.output))})),ll(),hl()),"closed"===Uc.state&&(Dc("audio context is closed by user gesture, restarting"),await Uc.rawContext.resume())},ll=()=>{try{Xc[0].transport.scheduleRepeat((t=>{pl()}),10)}catch(t){Dc(t)}},hl=()=>{Xc[0].transport&&Xc[0].transport.scheduleRepeat((t=>{rl.detune.rampTo(Ac(Math.random(),0,1,-100,100),30),rl.harmonicity.rampTo(Ac(Math.random(),0,1,.5,2),30)}),30)},pl=()=>{try{if(ps&&ps.particles){let{radius:t,maxradius:e}=ps.particles[ps.particles.length-1];Xc.forEach(((n,r)=>{n.setDetune(Ac(t,0,e,-1e3,.05));let i=(r+1)*Ac(t,0,e,440,880);!Ic&&n.filter.frequency.rampTo(i,5)})),rl.filter.frequency.rampTo(Ac(~~t,0,~~e,50,200),10)}}catch(t){console.warn("particle system not defined, threw error"+t)}},fl=()=>{"running"===Uc.state&&Uc.rawContext.suspend()},dl=()=>{Uc.rawContext.resume()},_l=t=>{t?(tl.classList.add("fa-volume-off"),tl.classList.remove("fa-volume-up")):(tl.classList.remove("fa-volume-off"),tl.classList.add("fa-volume-up"))};(async()=>{Vc=await Vc,Vc||(Yc.suffix="aac",Kc=1,Jc=3);try{window.isMp3=Vc,await Uc.rawContext.resume(),await al(),window.reloadBuffers=il,ol()}catch(t){Hc()}})()})()})();