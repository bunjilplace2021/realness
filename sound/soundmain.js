/*! For license information please see soundmain.js.LICENSE.txt */
(()=>{var t,e,n={228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}},858:t=>{t.exports=function(t){if(Array.isArray(t))return t}},575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}},884:t=>{t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],s=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);s=!0);}catch(t){i=!0,r=t}finally{try{s||null==a.return||a.return()}finally{if(i)throw r}}return n}}},521:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},38:(t,e,n)=>{var s=n(858),i=n(884),r=n(379),o=n(521);t.exports=function(t,e){return s(t)||i(t,e)||r(t,e)||o()}},379:(t,e,n)=>{var s=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}},195:function(t,e,n){t=n.nmd(t),function(e){"use strict";function s(t,e){e|=0;for(var n=Math.max(t.length-e,0),s=Array(n),i=0;i<n;i++)s[i]=t[e+i];return s}var i=function(t){var e=s(arguments,1);return function(){var n=s(arguments);return t.apply(null,e.concat(n))}},r=function(t){return function(){var e=s(arguments),n=e.pop();t.call(this,e,n)}};function o(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var a="function"==typeof setImmediate&&setImmediate,c="object"==typeof process&&"function"==typeof process.nextTick;function u(t){setTimeout(t,0)}function l(t){return function(e){var n=s(arguments,1);t((function(){e.apply(null,n)}))}}var h=l(a?setImmediate:c?process.nextTick:u);function p(t){return r((function(e,n){var s;try{s=t.apply(this,e)}catch(t){return n(t)}o(s)&&"function"==typeof s.then?s.then((function(t){d(n,null,t)}),(function(t){d(n,t.message?t:new Error(t))})):n(null,s)}))}function d(t,e,n){try{t(e,n)}catch(t){h(f,t)}}function f(t){throw t}var m="function"==typeof Symbol;function _(t){return m&&"AsyncFunction"===t[Symbol.toStringTag]}function g(t){return _(t)?p(t):t}function v(t){return function(e){var n=s(arguments,1),i=r((function(n,s){var i=this;return t(e,(function(t,e){g(t).apply(i,n.concat(e))}),s)}));return n.length?i.apply(this,n):i}}var y="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,b="object"==typeof self&&self&&self.Object===Object&&self,w=y||b||Function("return this")(),x=w.Symbol,T=Object.prototype,k=T.hasOwnProperty,S=T.toString,C=x?x.toStringTag:void 0;function A(t){var e=k.call(t,C),n=t[C];try{t[C]=void 0;var s=!0}catch(t){}var i=S.call(t);return s&&(e?t[C]=n:delete t[C]),i}var O=Object.prototype.toString;function E(t){return O.call(t)}var R="[object Null]",D="[object Undefined]",M=x?x.toStringTag:void 0;function I(t){return null==t?void 0===t?D:R:M&&M in Object(t)?A(t):E(t)}var P="[object AsyncFunction]",V="[object Function]",N="[object GeneratorFunction]",q="[object Proxy]";function L(t){if(!o(t))return!1;var e=I(t);return e==V||e==N||e==P||e==q}var j=9007199254740991;function F(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=j}function B(t){return null!=t&&F(t.length)&&!L(t)}var U={};function z(){}function W(t){return function(){if(null!==t){var e=t;t=null,e.apply(this,arguments)}}}var G="function"==typeof Symbol&&Symbol.iterator,H=function(t){return G&&t[G]&&t[G]()};function X(t,e){for(var n=-1,s=Array(t);++n<t;)s[n]=e(n);return s}function $(t){return null!=t&&"object"==typeof t}var Y="[object Arguments]";function Z(t){return $(t)&&I(t)==Y}var Q=Object.prototype,J=Q.hasOwnProperty,K=Q.propertyIsEnumerable,tt=Z(function(){return arguments}())?Z:function(t){return $(t)&&J.call(t,"callee")&&!K.call(t,"callee")},et=Array.isArray;function nt(){return!1}var st="object"==typeof e&&e&&!e.nodeType&&e,it=st&&t&&!t.nodeType&&t,rt=it&&it.exports===st?w.Buffer:void 0,ot=(rt?rt.isBuffer:void 0)||nt,at=9007199254740991,ct=/^(?:0|[1-9]\d*)$/;function ut(t,e){var n=typeof t;return!!(e=null==e?at:e)&&("number"==n||"symbol"!=n&&ct.test(t))&&t>-1&&t%1==0&&t<e}var lt="[object Arguments]",ht="[object Array]",pt="[object Boolean]",dt="[object Date]",ft="[object Error]",mt="[object Function]",_t="[object Map]",gt="[object Number]",vt="[object Object]",yt="[object RegExp]",bt="[object Set]",wt="[object String]",xt="[object WeakMap]",Tt="[object ArrayBuffer]",kt="[object DataView]",St="[object Float64Array]",Ct="[object Int8Array]",At="[object Int16Array]",Ot="[object Int32Array]",Et="[object Uint8Array]",Rt="[object Uint8ClampedArray]",Dt="[object Uint16Array]",Mt="[object Uint32Array]",It={};function Pt(t){return $(t)&&F(t.length)&&!!It[I(t)]}function Vt(t){return function(e){return t(e)}}It["[object Float32Array]"]=It[St]=It[Ct]=It[At]=It[Ot]=It[Et]=It[Rt]=It[Dt]=It[Mt]=!0,It[lt]=It[ht]=It[Tt]=It[pt]=It[kt]=It[dt]=It[ft]=It[mt]=It[_t]=It[gt]=It[vt]=It[yt]=It[bt]=It[wt]=It[xt]=!1;var Nt="object"==typeof e&&e&&!e.nodeType&&e,qt=Nt&&t&&!t.nodeType&&t,Lt=qt&&qt.exports===Nt&&y.process,jt=function(){try{var t=qt&&qt.require&&qt.require("util").types;return t||Lt&&Lt.binding&&Lt.binding("util")}catch(t){}}(),Ft=jt&&jt.isTypedArray,Bt=Ft?Vt(Ft):Pt,Ut=Object.prototype.hasOwnProperty;function zt(t,e){var n=et(t),s=!n&&tt(t),i=!n&&!s&&ot(t),r=!n&&!s&&!i&&Bt(t),o=n||s||i||r,a=o?X(t.length,String):[],c=a.length;for(var u in t)!e&&!Ut.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ut(u,c))||a.push(u);return a}var Wt=Object.prototype;function Gt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Wt)}function Ht(t,e){return function(n){return t(e(n))}}var Xt=Ht(Object.keys,Object),$t=Object.prototype.hasOwnProperty;function Yt(t){if(!Gt(t))return Xt(t);var e=[];for(var n in Object(t))$t.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Zt(t){return B(t)?zt(t):Yt(t)}function Qt(t){var e=-1,n=t.length;return function(){return++e<n?{value:t[e],key:e}:null}}function Jt(t){var e=-1;return function(){var n=t.next();return n.done?null:(e++,{value:n.value,key:e})}}function Kt(t){var e=Zt(t),n=-1,s=e.length;return function(){var i=e[++n];return n<s?{value:t[i],key:i}:null}}function te(t){if(B(t))return Qt(t);var e=H(t);return e?Jt(e):Kt(t)}function ee(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function ne(t){return function(e,n,s){if(s=W(s||z),t<=0||!e)return s(null);var i=te(e),r=!1,o=0,a=!1;function c(t,e){if(o-=1,t)r=!0,s(t);else{if(e===U||r&&o<=0)return r=!0,s(null);a||u()}}function u(){for(a=!0;o<t&&!r;){var e=i();if(null===e)return r=!0,void(o<=0&&s(null));o+=1,n(e.value,e.key,ee(c))}a=!1}u()}}function se(t,e,n,s){ne(e)(t,g(n),s)}function ie(t,e){return function(n,s,i){return t(n,e,s,i)}}function re(t,e,n){n=W(n||z);var s=0,i=0,r=t.length;function o(t,e){t?n(t):++i!==r&&e!==U||n(null)}for(0===r&&n(null);s<r;s++)e(t[s],s,ee(o))}var oe=ie(se,1/0),ae=function(t,e,n){(B(t)?re:oe)(t,g(e),n)};function ce(t){return function(e,n,s){return t(ae,e,g(n),s)}}function ue(t,e,n,s){s=s||z,e=e||[];var i=[],r=0,o=g(n);t(e,(function(t,e,n){var s=r++;o(t,(function(t,e){i[s]=e,n(t)}))}),(function(t){s(t,i)}))}var le=ce(ue),he=v(le);function pe(t){return function(e,n,s,i){return t(ne(n),e,g(s),i)}}var de=pe(ue),fe=ie(de,1),me=v(fe);function _e(t,e){for(var n=-1,s=null==t?0:t.length;++n<s&&!1!==e(t[n],n,t););return t}function ge(t){return function(e,n,s){for(var i=-1,r=Object(e),o=s(e),a=o.length;a--;){var c=o[t?a:++i];if(!1===n(r[c],c,r))break}return e}}var ve=ge();function ye(t,e){return t&&ve(t,e,Zt)}function be(t,e,n,s){for(var i=t.length,r=n+(s?1:-1);s?r--:++r<i;)if(e(t[r],r,t))return r;return-1}function we(t){return t!=t}function xe(t,e,n){for(var s=n-1,i=t.length;++s<i;)if(t[s]===e)return s;return-1}function Te(t,e,n){return e==e?xe(t,e,n):be(t,we,n)}var ke=function(t,e,n){"function"==typeof e&&(n=e,e=null),n=W(n||z);var i=Zt(t).length;if(!i)return n(null);e||(e=i);var r={},o=0,a=!1,c=Object.create(null),u=[],l=[],h={};function p(t,e){u.push((function(){_(t,e)}))}function d(){if(0===u.length&&0===o)return n(null,r);for(;u.length&&o<e;)u.shift()()}function f(t,e){var n=c[t];n||(n=c[t]=[]),n.push(e)}function m(t){_e(c[t]||[],(function(t){t()})),d()}function _(t,e){if(!a){var i=ee((function(e,i){if(o--,arguments.length>2&&(i=s(arguments,1)),e){var u={};ye(r,(function(t,e){u[e]=t})),u[t]=i,a=!0,c=Object.create(null),n(e,u)}else r[t]=i,m(t)}));o++;var u=g(e[e.length-1]);e.length>1?u(r,i):u(i)}}function v(){for(var t=0;l.length;)t++,_e(y(l.pop()),(function(t){0==--h[t]&&l.push(t)}));if(t!==i)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function y(e){var n=[];return ye(t,(function(t,s){et(t)&&Te(t,e,0)>=0&&n.push(s)})),n}ye(t,(function(e,n){if(!et(e))return p(n,[e]),void l.push(n);var s=e.slice(0,e.length-1),i=s.length;if(0===i)return p(n,e),void l.push(n);h[n]=i,_e(s,(function(r){if(!t[r])throw new Error("async.auto task `"+n+"` has a non-existent dependency `"+r+"` in "+s.join(", "));f(r,(function(){0==--i&&p(n,e)}))}))})),v(),d()};function Se(t,e){for(var n=-1,s=null==t?0:t.length,i=Array(s);++n<s;)i[n]=e(t[n],n,t);return i}var Ce="[object Symbol]";function Ae(t){return"symbol"==typeof t||$(t)&&I(t)==Ce}var Oe=1/0,Ee=x?x.prototype:void 0,Re=Ee?Ee.toString:void 0;function De(t){if("string"==typeof t)return t;if(et(t))return Se(t,De)+"";if(Ae(t))return Re?Re.call(t):"";var e=t+"";return"0"==e&&1/t==-Oe?"-0":e}function Me(t,e,n){var s=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var r=Array(i);++s<i;)r[s]=t[s+e];return r}function Ie(t,e,n){var s=t.length;return n=void 0===n?s:n,!e&&n>=s?t:Me(t,e,n)}function Pe(t,e){for(var n=t.length;n--&&Te(e,t[n],0)>-1;);return n}function Ve(t,e){for(var n=-1,s=t.length;++n<s&&Te(e,t[n],0)>-1;);return n}function Ne(t){return t.split("")}var qe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Le(t){return qe.test(t)}var je="\\ud800-\\udfff",Fe="["+je+"]",Be="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ue="\\ud83c[\\udffb-\\udfff]",ze="[^"+je+"]",We="(?:\\ud83c[\\udde6-\\uddff]){2}",Ge="[\\ud800-\\udbff][\\udc00-\\udfff]",He="(?:"+Be+"|"+Ue+")?",Xe="[\\ufe0e\\ufe0f]?",$e="(?:\\u200d(?:"+[ze,We,Ge].join("|")+")"+Xe+He+")*",Ye=Xe+He+$e,Ze="(?:"+[ze+Be+"?",Be,We,Ge,Fe].join("|")+")",Qe=RegExp(Ue+"(?="+Ue+")|"+Ze+Ye,"g");function Je(t){return t.match(Qe)||[]}function Ke(t){return Le(t)?Je(t):Ne(t)}function tn(t){return null==t?"":De(t)}var en=/^\s+|\s+$/g;function nn(t,e,n){if((t=tn(t))&&(n||void 0===e))return t.replace(en,"");if(!t||!(e=De(e)))return t;var s=Ke(t),i=Ke(e);return Ie(s,Ve(s,i),Pe(s,i)+1).join("")}var sn=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,rn=/,/,on=/(=.+)?(\s*)$/,an=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm;function cn(t){return t=(t=(t=(t=t.toString().replace(an,"")).match(sn)[2].replace(" ",""))?t.split(rn):[]).map((function(t){return nn(t.replace(on,""))}))}function un(t,e){var n={};ye(t,(function(t,e){var s,i=_(t),r=!i&&1===t.length||i&&0===t.length;if(et(t))s=t.slice(0,-1),t=t[t.length-1],n[e]=s.concat(s.length>0?o:t);else if(r)n[e]=t;else{if(s=cn(t),0===t.length&&!i&&0===s.length)throw new Error("autoInject task functions require explicit parameters.");i||s.pop(),n[e]=s.concat(o)}function o(e,n){var i=Se(s,(function(t){return e[t]}));i.push(n),g(t).apply(null,i)}})),ke(n,e)}function ln(){this.head=this.tail=null,this.length=0}function hn(t,e){t.length=1,t.head=t.tail=e}function pn(t,e,n){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var s=g(t),i=0,r=[],o=!1;function a(t,e,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(l.started=!0,et(t)||(t=[t]),0===t.length&&l.idle())return h((function(){l.drain()}));for(var s=0,i=t.length;s<i;s++){var r={data:t[s],callback:n||z};e?l._tasks.unshift(r):l._tasks.push(r)}o||(o=!0,h((function(){o=!1,l.process()})))}function c(t){return function(e){i-=1;for(var n=0,s=t.length;n<s;n++){var o=t[n],a=Te(r,o,0);0===a?r.shift():a>0&&r.splice(a,1),o.callback.apply(o,arguments),null!=e&&l.error(e,o.data)}i<=l.concurrency-l.buffer&&l.unsaturated(),l.idle()&&l.drain(),l.process()}}var u=!1,l={_tasks:new ln,concurrency:e,payload:n,saturated:z,unsaturated:z,buffer:e/4,empty:z,drain:z,error:z,started:!1,paused:!1,push:function(t,e){a(t,!1,e)},kill:function(){l.drain=z,l._tasks.empty()},unshift:function(t,e){a(t,!0,e)},remove:function(t){l._tasks.remove(t)},process:function(){if(!u){for(u=!0;!l.paused&&i<l.concurrency&&l._tasks.length;){var t=[],e=[],n=l._tasks.length;l.payload&&(n=Math.min(n,l.payload));for(var o=0;o<n;o++){var a=l._tasks.shift();t.push(a),r.push(a),e.push(a.data)}i+=1,0===l._tasks.length&&l.empty(),i===l.concurrency&&l.saturated();var h=ee(c(t));s(e,h)}u=!1}},length:function(){return l._tasks.length},running:function(){return i},workersList:function(){return r},idle:function(){return l._tasks.length+i===0},pause:function(){l.paused=!0},resume:function(){!1!==l.paused&&(l.paused=!1,h(l.process))}};return l}function dn(t,e){return pn(t,1,e)}ln.prototype.removeLink=function(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t},ln.prototype.empty=function(){for(;this.head;)this.shift();return this},ln.prototype.insertAfter=function(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1},ln.prototype.insertBefore=function(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1},ln.prototype.unshift=function(t){this.head?this.insertBefore(this.head,t):hn(this,t)},ln.prototype.push=function(t){this.tail?this.insertAfter(this.tail,t):hn(this,t)},ln.prototype.shift=function(){return this.head&&this.removeLink(this.head)},ln.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},ln.prototype.toArray=function(){for(var t=Array(this.length),e=this.head,n=0;n<this.length;n++)t[n]=e.data,e=e.next;return t},ln.prototype.remove=function(t){for(var e=this.head;e;){var n=e.next;t(e)&&this.removeLink(e),e=n}return this};var fn=ie(se,1);function mn(t,e,n,s){s=W(s||z);var i=g(n);fn(t,(function(t,n,s){i(e,t,(function(t,n){e=n,s(t)}))}),(function(t){s(t,e)}))}function _n(){var t=Se(arguments,g);return function(){var e=s(arguments),n=this,i=e[e.length-1];"function"==typeof i?e.pop():i=z,mn(t,e,(function(t,e,i){e.apply(n,t.concat((function(t){var e=s(arguments,1);i(t,e)})))}),(function(t,e){i.apply(n,[t].concat(e))}))}}var gn=function(){return _n.apply(null,s(arguments).reverse())},vn=Array.prototype.concat,yn=function(t,e,n,i){i=i||z;var r=g(n);de(t,e,(function(t,e){r(t,(function(t){return t?e(t):e(null,s(arguments,1))}))}),(function(t,e){for(var n=[],s=0;s<e.length;s++)e[s]&&(n=vn.apply(n,e[s]));return i(t,n)}))},bn=ie(yn,1/0),wn=ie(yn,1),xn=function(){var t=s(arguments),e=[null].concat(t);return function(){return arguments[arguments.length-1].apply(this,e)}};function Tn(t){return t}function kn(t,e){return function(n,s,i,r){r=r||z;var o,a=!1;n(s,(function(n,s,r){i(n,(function(s,i){s?r(s):t(i)&&!o?(a=!0,o=e(!0,n),r(null,U)):r()}))}),(function(t){t?r(t):r(null,a?o:e(!1))}))}}function Sn(t,e){return e}var Cn=ce(kn(Tn,Sn)),An=pe(kn(Tn,Sn)),On=ie(An,1);function En(t){return function(e){var n=s(arguments,1);n.push((function(e){var n=s(arguments,1);"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&_e(n,(function(e){console[t](e)})))})),g(e).apply(null,n)}}var Rn=En("dir");function Dn(t,e,n){n=ee(n||z);var i=g(t),r=g(e);function o(t){if(t)return n(t);var e=s(arguments,1);e.push(a),r.apply(this,e)}function a(t,e){return t?n(t):e?void i(o):n(null)}a(null,!0)}function Mn(t,e,n){n=ee(n||z);var i=g(t),r=function(t){if(t)return n(t);var o=s(arguments,1);if(e.apply(this,o))return i(r);n.apply(null,[null].concat(o))};i(r)}function In(t,e,n){Mn(t,(function(){return!e.apply(this,arguments)}),n)}function Pn(t,e,n){n=ee(n||z);var s=g(e),i=g(t);function r(t){if(t)return n(t);i(o)}function o(t,e){return t?n(t):e?void s(r):n(null)}i(o)}function Vn(t){return function(e,n,s){return t(e,s)}}function Nn(t,e,n){ae(t,Vn(g(e)),n)}function qn(t,e,n,s){ne(e)(t,Vn(g(n)),s)}var Ln=ie(qn,1);function jn(t){return _(t)?t:r((function(e,n){var s=!0;e.push((function(){var t=arguments;s?h((function(){n.apply(null,t)})):n.apply(null,t)})),t.apply(this,e),s=!1}))}function Fn(t){return!t}var Bn=ce(kn(Fn,Fn)),Un=pe(kn(Fn,Fn)),zn=ie(Un,1);function Wn(t){return function(e){return null==e?void 0:e[t]}}function Gn(t,e,n,s){var i=new Array(e.length);t(e,(function(t,e,s){n(t,(function(t,n){i[e]=!!n,s(t)}))}),(function(t){if(t)return s(t);for(var n=[],r=0;r<e.length;r++)i[r]&&n.push(e[r]);s(null,n)}))}function Hn(t,e,n,s){var i=[];t(e,(function(t,e,s){n(t,(function(n,r){n?s(n):(r&&i.push({index:e,value:t}),s())}))}),(function(t){t?s(t):s(null,Se(i.sort((function(t,e){return t.index-e.index})),Wn("value")))}))}function Xn(t,e,n,s){(B(e)?Gn:Hn)(t,e,g(n),s||z)}var $n=ce(Xn),Yn=pe(Xn),Zn=ie(Yn,1);function Qn(t,e){var n=ee(e||z),s=g(jn(t));function i(t){if(t)return n(t);s(i)}i()}var Jn=function(t,e,n,s){s=s||z;var i=g(n);de(t,e,(function(t,e){i(t,(function(n,s){return n?e(n):e(null,{key:s,val:t})}))}),(function(t,e){for(var n={},i=Object.prototype.hasOwnProperty,r=0;r<e.length;r++)if(e[r]){var o=e[r].key,a=e[r].val;i.call(n,o)?n[o].push(a):n[o]=[a]}return s(t,n)}))},Kn=ie(Jn,1/0),ts=ie(Jn,1),es=En("log");function ns(t,e,n,s){s=W(s||z);var i={},r=g(n);se(t,e,(function(t,e,n){r(t,e,(function(t,s){if(t)return n(t);i[e]=s,n()}))}),(function(t){s(t,i)}))}var ss=ie(ns,1/0),is=ie(ns,1);function rs(t,e){return e in t}function os(t,e){var n=Object.create(null),i=Object.create(null);e=e||Tn;var o=g(t),a=r((function(t,r){var a=e.apply(null,t);rs(n,a)?h((function(){r.apply(null,n[a])})):rs(i,a)?i[a].push(r):(i[a]=[r],o.apply(null,t.concat((function(){var t=s(arguments);n[a]=t;var e=i[a];delete i[a];for(var r=0,o=e.length;r<o;r++)e[r].apply(null,t)}))))}));return a.memo=n,a.unmemoized=t,a}var as=l(c?process.nextTick:a?setImmediate:u);function cs(t,e,n){n=n||z;var i=B(e)?[]:{};t(e,(function(t,e,n){g(t)((function(t,r){arguments.length>2&&(r=s(arguments,1)),i[e]=r,n(t)}))}),(function(t){n(t,i)}))}function us(t,e){cs(ae,t,e)}function ls(t,e,n){cs(ne(e),t,n)}var hs=function(t,e){var n=g(t);return pn((function(t,e){n(t[0],e)}),e,1)},ps=function(t,e){var n=hs(t,e);return n.push=function(t,e,s){if(null==s&&(s=z),"function"!=typeof s)throw new Error("task callback must be a function");if(n.started=!0,et(t)||(t=[t]),0===t.length)return h((function(){n.drain()}));e=e||0;for(var i=n._tasks.head;i&&e>=i.priority;)i=i.next;for(var r=0,o=t.length;r<o;r++){var a={data:t[r],priority:e,callback:s};i?n._tasks.insertBefore(i,a):n._tasks.push(a)}h(n.process)},delete n.unshift,n};function ds(t,e){if(e=W(e||z),!et(t))return e(new TypeError("First argument to race must be an array of functions"));if(!t.length)return e();for(var n=0,s=t.length;n<s;n++)g(t[n])(e)}function fs(t,e,n,i){mn(s(t).reverse(),e,n,i)}function ms(t){var e=g(t);return r((function(t,n){return t.push((function(t,e){var i;t?n(null,{error:t}):(i=arguments.length<=2?e:s(arguments,1),n(null,{value:i}))})),e.apply(this,t)}))}function _s(t){var e;return et(t)?e=Se(t,ms):(e={},ye(t,(function(t,n){e[n]=ms.call(this,t)}))),e}function gs(t,e,n,s){Xn(t,e,(function(t,e){n(t,(function(t,n){e(t,!n)}))}),s)}var vs=ce(gs),ys=pe(gs),bs=ie(ys,1);function ws(t){return function(){return t}}function xs(t,e,n){var s=5,i=0,r={times:s,intervalFunc:ws(i)};function o(t,e){if("object"==typeof e)t.times=+e.times||s,t.intervalFunc="function"==typeof e.interval?e.interval:ws(+e.interval||i),t.errorFilter=e.errorFilter;else{if("number"!=typeof e&&"string"!=typeof e)throw new Error("Invalid arguments for async.retry");t.times=+e||s}}if(arguments.length<3&&"function"==typeof t?(n=e||z,e=t):(o(r,t),n=n||z),"function"!=typeof e)throw new Error("Invalid arguments for async.retry");var a=g(e),c=1;function u(){a((function(t){t&&c++<r.times&&("function"!=typeof r.errorFilter||r.errorFilter(t))?setTimeout(u,r.intervalFunc(c)):n.apply(null,arguments)}))}u()}var Ts=function(t,e){e||(e=t,t=null);var n=g(e);return r((function(e,s){function i(t){n.apply(null,e.concat(t))}t?xs(t,i,s):xs(i,s)}))};function ks(t,e){cs(fn,t,e)}var Ss=ce(kn(Boolean,Tn)),Cs=pe(kn(Boolean,Tn)),As=ie(Cs,1);function Os(t,e,n){var s=g(e);function i(t,e){var n=t.criteria,s=e.criteria;return n<s?-1:n>s?1:0}le(t,(function(t,e){s(t,(function(n,s){if(n)return e(n);e(null,{value:t,criteria:s})}))}),(function(t,e){if(t)return n(t);n(null,Se(e.sort(i),Wn("value")))}))}function Es(t,e,n){var s=g(t);return r((function(i,r){var o,a=!1;function c(){var e=t.name||"anonymous",s=new Error('Callback function "'+e+'" timed out.');s.code="ETIMEDOUT",n&&(s.info=n),a=!0,r(s)}i.push((function(){a||(r.apply(null,arguments),clearTimeout(o))})),o=setTimeout(c,e),s.apply(null,i)}))}var Rs=Math.ceil,Ds=Math.max;function Ms(t,e,n,s){for(var i=-1,r=Ds(Rs((e-t)/(n||1)),0),o=Array(r);r--;)o[s?r:++i]=t,t+=n;return o}function Is(t,e,n,s){var i=g(n);de(Ms(0,t,1),e,i,s)}var Ps=ie(Is,1/0),Vs=ie(Is,1);function Ns(t,e,n,s){arguments.length<=3&&(s=n,n=e,e=et(t)?[]:{}),s=W(s||z);var i=g(n);ae(t,(function(t,n,s){i(e,t,n,s)}),(function(t){s(t,e)}))}function qs(t,e){var n,i=null;e=e||z,Ln(t,(function(t,e){g(t)((function(t,r){n=arguments.length>2?s(arguments,1):r,i=t,e(!t)}))}),(function(){e(i,n)}))}function Ls(t){return function(){return(t.unmemoized||t).apply(null,arguments)}}function js(t,e,n){n=ee(n||z);var i=g(e);if(!t())return n(null);var r=function(e){if(e)return n(e);if(t())return i(r);var o=s(arguments,1);n.apply(null,[null].concat(o))};i(r)}function Fs(t,e,n){js((function(){return!t.apply(this,arguments)}),e,n)}var Bs=function(t,e){if(e=W(e||z),!et(t))return e(new Error("First argument to waterfall must be an array of functions"));if(!t.length)return e();var n=0;function i(e){var s=g(t[n++]);e.push(ee(r)),s.apply(null,e)}function r(r){if(r||n===t.length)return e.apply(null,arguments);i(s(arguments,1))}i([])},Us={apply:i,applyEach:he,applyEachSeries:me,asyncify:p,auto:ke,autoInject:un,cargo:dn,compose:gn,concat:bn,concatLimit:yn,concatSeries:wn,constant:xn,detect:Cn,detectLimit:An,detectSeries:On,dir:Rn,doDuring:Dn,doUntil:In,doWhilst:Mn,during:Pn,each:Nn,eachLimit:qn,eachOf:ae,eachOfLimit:se,eachOfSeries:fn,eachSeries:Ln,ensureAsync:jn,every:Bn,everyLimit:Un,everySeries:zn,filter:$n,filterLimit:Yn,filterSeries:Zn,forever:Qn,groupBy:Kn,groupByLimit:Jn,groupBySeries:ts,log:es,map:le,mapLimit:de,mapSeries:fe,mapValues:ss,mapValuesLimit:ns,mapValuesSeries:is,memoize:os,nextTick:as,parallel:us,parallelLimit:ls,priorityQueue:ps,queue:hs,race:ds,reduce:mn,reduceRight:fs,reflect:ms,reflectAll:_s,reject:vs,rejectLimit:ys,rejectSeries:bs,retry:xs,retryable:Ts,seq:_n,series:ks,setImmediate:h,some:Ss,someLimit:Cs,someSeries:As,sortBy:Os,timeout:Es,times:Ps,timesLimit:Is,timesSeries:Vs,transform:Ns,tryEach:qs,unmemoize:Ls,until:Fs,waterfall:Bs,whilst:js,all:Bn,allLimit:Un,allSeries:zn,any:Ss,anyLimit:Cs,anySeries:As,find:Cn,findLimit:An,findSeries:On,forEach:Nn,forEachSeries:Ln,forEachLimit:qn,forEachOf:ae,forEachOfSeries:fn,forEachOfLimit:se,inject:mn,foldl:mn,foldr:fs,select:$n,selectLimit:Yn,selectSeries:Zn,wrapSync:p};e.default=Us,e.apply=i,e.applyEach=he,e.applyEachSeries=me,e.asyncify=p,e.auto=ke,e.autoInject=un,e.cargo=dn,e.compose=gn,e.concat=bn,e.concatLimit=yn,e.concatSeries=wn,e.constant=xn,e.detect=Cn,e.detectLimit=An,e.detectSeries=On,e.dir=Rn,e.doDuring=Dn,e.doUntil=In,e.doWhilst=Mn,e.during=Pn,e.each=Nn,e.eachLimit=qn,e.eachOf=ae,e.eachOfLimit=se,e.eachOfSeries=fn,e.eachSeries=Ln,e.ensureAsync=jn,e.every=Bn,e.everyLimit=Un,e.everySeries=zn,e.filter=$n,e.filterLimit=Yn,e.filterSeries=Zn,e.forever=Qn,e.groupBy=Kn,e.groupByLimit=Jn,e.groupBySeries=ts,e.log=es,e.map=le,e.mapLimit=de,e.mapSeries=fe,e.mapValues=ss,e.mapValuesLimit=ns,e.mapValuesSeries=is,e.memoize=os,e.nextTick=as,e.parallel=us,e.parallelLimit=ls,e.priorityQueue=ps,e.queue=hs,e.race=ds,e.reduce=mn,e.reduceRight=fs,e.reflect=ms,e.reflectAll=_s,e.reject=vs,e.rejectLimit=ys,e.rejectSeries=bs,e.retry=xs,e.retryable=Ts,e.seq=_n,e.series=ks,e.setImmediate=h,e.some=Ss,e.someLimit=Cs,e.someSeries=As,e.sortBy=Os,e.timeout=Es,e.times=Ps,e.timesLimit=Is,e.timesSeries=Vs,e.transform=Ns,e.tryEach=qs,e.unmemoize=Ls,e.until=Fs,e.waterfall=Bs,e.whilst=js,e.all=Bn,e.allLimit=Un,e.allSeries=zn,e.any=Ss,e.anyLimit=Cs,e.anySeries=As,e.find=Cn,e.findLimit=An,e.findSeries=On,e.forEach=Nn,e.forEachSeries=Ln,e.forEachLimit=qn,e.forEachOf=ae,e.forEachOfSeries=fn,e.forEachOfLimit=se,e.inject=mn,e.foldl=mn,e.foldr=fs,e.select=$n,e.selectLimit=Yn,e.selectSeries=Zn,e.wrapSync=p,Object.defineProperty(e,"__esModule",{value:!0})}(e)},382:function(t,e,n){!function(t,e,n,s){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=i(e),o=i(n),a=i(s),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},u=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var s=n.startTime,i=n.target,r=n.timeConstant;return i+(e-i)*Math.exp((s-t)/r)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return d(t)||f(t)},_=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,s,i){var r=e[n];return void 0===r?i:m(r)||_(r)?r.value:g(r)?r.values[r.values.length-1]:p(s,t(e,n-1,r.startTime,i),r)},y=function(t,e,n,s,i){return void 0===n?[s.insertTime,i]:m(n)?[n.endTime,n.value]:_(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,i)]},b=function(t){return"cancelAndHold"===t.type},w=function(t){return"cancelScheduledValues"===t.type},x=function(t){return b(t)||w(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},T=function(t,e,n,s){var i=s.endTime,r=s.value;return n===r?r:0<n&&0<r||n<0&&r<0?n*Math.pow(r/n,(t-e)/(i-e)):0},k=function(t,e,n,s){return n+(t-e)/(s.endTime-e)*(s.value-n)},S=function(t,e){var n=Math.floor(e),s=Math.ceil(e);return n===s?t[n]:(1-(e-n))*t[n]+(1-(s-e))*t[s]},C=function(t,e){var n=e.duration,s=e.startTime,i=e.values,r=(t-s)/n*(i.length-1);return S(i,r)},A=function(t){return"setTarget"===t.type},O=function(){function t(e){o.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=x(t);if(b(t)||w(t)){var n=this._automationEvents.findIndex((function(n){return w(t)&&g(n)?n.startTime+n.duration>=e:x(n)>=e})),s=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(t)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==s&&m(s)){if(A(i))throw new Error("The internal list is malformed.");var r=g(i)?i.startTime+i.duration:x(i),o=g(i)?i.values[i.values.length-1]:i.value,a=d(s)?T(e,r,o,s):k(e,r,o,s),p=d(s)?c(a,e,this._currenTime):u(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==i&&A(i)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==i&&g(i)&&i.startTime+i.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),i.startTime,e-i.startTime))}}else{var _=this._automationEvents.findIndex((function(t){return x(t)>e})),v=-1===_?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[_-1];if(void 0!==v&&g(v)&&x(v)+v.duration>e)return!1;var y=d(t)?c(t.value,t.endTime,this._currenTime):f(t)?u(t.value,e,this._currenTime):t;if(-1===_)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>x(this._automationEvents[_]))return!1;this._automationEvents.splice(_,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return x(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),s=n[0];A(s)&&n.unshift(l(v(this._automationEvents,e-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(e){return x(e)>t})),s=this._automationEvents[n],i=x(e)<=t?e:this._automationEvents[n-1];if(void 0!==i&&A(i)&&(void 0===s||!m(s)||s.insertTime>t))return p(t,v(this._automationEvents,n-2,i.startTime,this._defaultValue),i);if(void 0!==i&&_(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==i&&g(i)&&(void 0===s||!m(s)||i.startTime+i.duration>t))return t<i.startTime+i.duration?C(t,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===s||!m(s)))return i.value;if(void 0!==s&&d(s)){var o=y(this._automationEvents,n-1,i,s,this._defaultValue),a=r.default(o,2),c=a[0],u=a[1];return T(t,c,u,s)}if(void 0!==s&&f(s)){var l=y(this._automationEvents,n-1,i,s,this._defaultValue),h=r.default(l,2),b=h[0],w=h[1];return k(t,b,w,s)}return this._defaultValue}}]),t}(),E=function(t){return{cancelTime:t,type:"cancelAndHold"}},R=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},D=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},M=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},I=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}};t.AutomationEventList=O,t.createCancelAndHoldAutomationEvent=E,t.createCancelScheduledValuesAutomationEvent=R,t.createExponentialRampToValueAutomationEvent=D,t.createLinearRampToValueAutomationEvent=M,t.createSetTargetAutomationEvent=I,t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(38),n(575),n(913))},666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,s=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,s){var i=e&&e.prototype instanceof _?e:_,r=Object.create(i.prototype),o=new O(s||[]);return r._invoke=function(t,e,n){var s=h;return function(i,r){if(s===d)throw new Error("Generator is already running");if(s===f){if("throw"===i)throw r;return R()}for(n.method=i,n.arg=r;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===h)throw s=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=d;var c=l(t,e,n);if("normal"===c.type){if(s=n.done?f:p,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(s=f,n.method="throw",n.arg=c.arg)}}}(t,n,o),r}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",d="executing",f="completed",m={};function _(){}function g(){}function v(){}var y={};y[r]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(E([])));w&&w!==n&&s.call(w,r)&&(y=w);var x=v.prototype=_.prototype=Object.create(y);function T(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,r,o,a){var c=l(t[i],t,r);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&s.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,a)}))}a(c.arg)}var i;this._invoke=function(t,s){function r(){return new e((function(e,i){n(t,s,e,i)}))}return i=i?i.then(r,r):r()}}function S(t,n){var s=t.iterator[n.method];if(s===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(s,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var r=i.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function E(t){if(t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(s.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:e,done:!0}}return g.prototype=x.constructor=v,v.constructor=g,g.displayName=c(v,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,a,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},T(k.prototype),k.prototype[o]=function(){return this},t.AsyncIterator=k,t.async=function(e,n,s,i,r){void 0===r&&(r=Promise);var o=new k(u(e,n,s,i),r);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(x),c(x,a,"Generator"),x[r]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var s=e.pop();if(s in t)return n.value=s,n.done=!1,n}return n.done=!0,n}},t.values=E,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(s,i){return a.type="throw",a.arg=t,n.next=s,i&&(n.method="next",n.arg=e),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=s.call(o,"catchLoc"),u=s.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&s.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var s=n.completion;if("throw"===s.type){var i=s.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,s){return this.delegate={iterator:E(t),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},877:(t,e,n)=>{var s=n(570),i=n(171),r=i;r.v1=s,r.v4=i,t.exports=r},327:t=>{for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var s=n||0,i=e;return[i[t[s++]],i[t[s++]],i[t[s++]],i[t[s++]],"-",i[t[s++]],i[t[s++]],"-",i[t[s++]],i[t[s++]],"-",i[t[s++]],i[t[s++]],"-",i[t[s++]],i[t[s++]],i[t[s++]],i[t[s++]],i[t[s++]],i[t[s++]]].join("")}},217:t=>{var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}},570:(t,e,n)=>{var s,i,r=n(217),o=n(327),a=0,c=0;t.exports=function(t,e,n){var u=e&&n||0,l=e||[],h=(t=t||{}).node||s,p=void 0!==t.clockseq?t.clockseq:i;if(null==h||null==p){var d=r();null==h&&(h=s=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=i=16383&(d[6]<<8|d[7]))}var f=void 0!==t.msecs?t.msecs:(new Date).getTime(),m=void 0!==t.nsecs?t.nsecs:c+1,_=f-a+(m-c)/1e4;if(_<0&&void 0===t.clockseq&&(p=p+1&16383),(_<0||f>a)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,c=m,i=p;var g=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;l[u++]=g>>>24&255,l[u++]=g>>>16&255,l[u++]=g>>>8&255,l[u++]=255&g;var v=f/4294967296*1e4&268435455;l[u++]=v>>>8&255,l[u++]=255&v,l[u++]=v>>>24&15|16,l[u++]=v>>>16&255,l[u++]=p>>>8|128,l[u++]=255&p;for(var y=0;y<6;++y)l[u+y]=h[y];return e||o(l)}},171:(t,e,n)=>{var s=n(217),i=n(327);t.exports=function(t,e,n){var r=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var a=0;a<16;++a)e[r+a]=o[a];return e||i(o)}}},s={};function i(t){if(s[t])return s[t].exports;var e=s[t]={id:t,loaded:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.loaded=!0,e.exports}i.m=n,i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>t+".soundmain.js",i.miniCssF=t=>"main."+{785:"7fa8d6c246d8473457bb",823:"081b026faa767298db28",865:"afc243ae62ac081c2c1b"}[t]+".css",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="realness:",i.l=(n,s,r)=>{if(t[n])t[n].push(s);else{var o,a;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var l=c[u];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==e+r){o=l;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",e+r),o.src=n),t[n]=[s];var h=(e,s)=>{o.onerror=o.onload=null,clearTimeout(p);var i=t[n];if(delete t[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((t=>t(s))),e)return e(s)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),a&&document.head.appendChild(o)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={179:0};i.f.j=(e,n)=>{var s=i.o(t,e)?t[e]:void 0;if(0!==s)if(s)n.push(s[2]);else{var r=new Promise(((n,i)=>{s=t[e]=[n,i]}));n.push(s[2]=r);var o=i.p+i.u(e),a=new Error;i.l(o,(n=>{if(i.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,s[1](a)}}),"chunk-"+e)}};var e=self.webpackChunkrealness=self.webpackChunkrealness||[],n=e.push.bind(e);e.push=e=>{for(var s,r,[o,a,c]=e,u=0,l=[];u<o.length;u++)r=o[u],i.o(t,r)&&t[r]&&l.push(t[r][0]),t[r]=0;for(s in a)i.o(a,s)&&(i.m[s]=a[s]);for(c&&c(i),n(e);l.length;)l.shift()()}})(),(()=>{"use strict";const t="14.7.58";var e=i(382);const n=new WeakSet,s=new WeakMap,r=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap,h=new WeakMap,p=new WeakMap,d={construct:()=>d},f=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,m=(t,e)=>{const n=[];let s=t.replace(/^[\s]+/,""),i=s.match(f);for(;null!==i;){const t=i[1].slice(1,-1),r=i[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(r),s=s.slice(i[0].length).replace(/^[\s]+/,""),i=s.match(f)}return[n.join(";"),s]},_=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},g=t=>{if(!(t=>{try{new new Proxy(t,d)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},v=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},y=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[s]=n;return t.delete(s),s},b=(t,e,n,s)=>{const i=v(t,e),r=y(i,(t=>t[0]===n&&t[1]===s));return 0===i.size&&t.delete(e),r},w=t=>v(u,t),x=t=>{if(n.has(t))throw new Error("The AudioNode is already stored.");n.add(t),w(t).forEach((t=>t(!0)))},T=t=>"port"in t,k=t=>{if(!n.has(t))throw new Error("The AudioNode is not stored.");n.delete(t),w(t).forEach((t=>t(!1)))},S=(t,e)=>{!T(t)&&e.every((t=>0===t.size))&&k(t)},C={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},A=(t,e)=>t.context===e,O=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},E=()=>new DOMException("","IndexSizeError"),R=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw E();throw t}})},D={numberOfChannels:1},M=-34028234663852886e22,I=-M,P=t=>n.has(t),V={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},N=t=>v(s,t),q=t=>v(o,t),L=(t,e)=>{const{activeInputs:n}=N(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||L(n,[...e,t])}))));const s=(t=>"playbackRate"in t)(t)?[t.playbackRate]:T(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of s){const n=q(t);void 0!==n&&n.activeInputs.forEach((([t])=>L(t,e)))}P(t)&&k(t)},j=t=>{L(t.destination,[])},F=t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t),B=t=>"context"in t,U=t=>B(t[0]),z=(t,e,n,s)=>{for(const e of t)if(n(e)){if(s)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},W=(t,e,[n,s],i)=>{z(t,[e,n,s],(t=>t[0]===e&&t[1]===n),i)},G=(t,[e,n,s],i)=>{const r=t.get(e);void 0===r?t.set(e,new Set([[n,s]])):z(r,[n,s],(t=>t[0]===n),i)},H=t=>"inputs"in t,X=(t,e,n,s)=>{if(H(e)){const i=e.inputs[s];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,s),[e,n,s]},$=(t,e,n)=>{for(const s of t)if(s[0]===e&&s[1]===n)return t.delete(s),s;return null},Y=(t,e)=>{if(!w(t).delete(e))throw new Error("Missing the expected event listener.")},Z=(t,e,n)=>{const s=v(t,e),i=y(s,(t=>t[0]===n));return 0===s.size&&t.delete(e),i},Q=(t,e,n,s)=>{H(e)?t.disconnect(e.inputs[s],n,0):t.disconnect(e,n,s)},J=t=>v(r,t),K=t=>v(a,t),tt=t=>l.has(t),et=t=>!n.has(t),nt=t=>new Promise((e=>{const n=t.createScriptProcessor(256,1,1),s=t.createGain(),i=t.createBuffer(1,2,44100),r=i.getChannelData(0);r[0]=1,r[1]=1;const o=t.createBufferSource();o.buffer=i,o.loop=!0,o.connect(n).connect(t.destination),o.connect(s),o.disconnect(s),n.onaudioprocess=s=>{const i=s.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(t=>1===t))?e(!0):e(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(t.destination)},o.start()})),st=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},it=t=>"context"in t,rt=t=>{const e=new Map;t.connect=(t=>(n,s=0,i=0)=>{const r=it(n)?t(n,s,i):t(n,s),o=e.get(n);return void 0===o?e.set(n,[{input:i,output:s}]):o.every((t=>t.input!==i||t.output!==s))&&o.push({input:i,output:s}),r})(t.connect.bind(t)),t.disconnect=(n=>(s,i,r)=>{if(n.apply(t),void 0===s)e.clear();else if("number"==typeof s)for(const[t,n]of e){const i=n.filter((t=>t.output!==s));0===i.length?e.delete(t):e.set(t,i)}else if(e.has(s))if(void 0===i)e.delete(s);else{const t=e.get(s);if(void 0!==t){const n=t.filter((t=>t.output!==i&&(t.input!==r||void 0===r)));0===n.length?e.delete(s):e.set(s,n)}}for(const[n,s]of e)s.forEach((e=>{it(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},ot=(t,e,n,s)=>{const{activeInputs:i,passiveInputs:r}=q(e),{outputs:o}=N(t),a=w(t),c=o=>{const a=J(t),c=K(e);if(o){const e=Z(r,t,n);W(i,t,e,!1),s||tt(t)||a.connect(c,n)}else{const e=((t,e,n)=>y(t,(t=>t[0]===e&&t[1]===n)))(i,t,n);G(r,e,!1),s||tt(t)||a.disconnect(c,n)}};return!!z(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(c),P(t)?W(i,t,[n,c],!0):G(r,[t,n,c],!0),!0)},at=(t,e,n,s,i)=>{const[r,o]=((t,e,n,s)=>{const{activeInputs:i,passiveInputs:r}=N(e),o=$(i[s],t,n);if(null===o)return[b(r,t,n,s)[2],!1];return[o[2],!0]})(t,n,s,i);if(null!==r&&(Y(t,r),!o||e||tt(t)||Q(J(t),J(n),s,i)),P(n)){const{activeInputs:t}=N(n);S(n,t)}},ct=(t,e,n,s)=>{const[i,r]=((t,e,n)=>{const{activeInputs:s,passiveInputs:i}=q(e),r=$(s,t,n);if(null===r)return[Z(i,t,n)[1],!1];return[r[2],!0]})(t,n,s);null!==i&&(Y(t,i),!r||e||tt(t)||J(t).disconnect(K(n),s))};class ut{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,s)=>t.call(e,n,s,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const lt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function ht(t,e,n,s,i){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],s,i);else{const r=t.getChannelData(s);if(0===e[n].byteLength)e[n]=r.slice(i,i+128);else{const t=new Float32Array(r.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const pt=(t,e,n,s,i)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],s,i):0!==e[n].byteLength&&t.getChannelData(s).set(e[n],i)},dt=(t,e)=>{const n=[];for(let s=0;s<t;s+=1){const t=[],i="number"==typeof e?e:e[s];for(let e=0;e<i;e+=1)t.push(new Float32Array(128));n.push(t)}return n},ft=async(t,e,n,s,i,r,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=s.channelCount*s.numberOfInputs,u=i.reduce(((t,e)=>t+e),0),l=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===r)throw new Error("Missing the processor constructor.");const h=N(t),d=await((t,e)=>{const n=v(p,t),s=J(e);return v(n,s)})(n,t),f=dt(s.numberOfInputs,s.channelCount),m=dt(s.numberOfOutputs,i),_=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let u=0;u<a;u+=128){if(s.numberOfInputs>0&&null!==e)for(let t=0;t<s.numberOfInputs;t+=1)for(let n=0;n<s.channelCount;n+=1)ht(e,f[t],n,n,u);void 0!==r.parameterDescriptors&&null!==e&&r.parameterDescriptors.forEach((({name:t},n)=>{ht(e,_,t,c+n,u)}));for(let t=0;t<s.numberOfInputs;t+=1)for(let e=0;e<i[t];e+=1)0===m[t][e].byteLength&&(m[t][e]=new Float32Array(128));try{const t=f.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(u/n.sampleRate,n.sampleRate,(()=>d.process(t,m,_)));if(null!==l)for(let t=0,e=0;t<s.numberOfOutputs;t+=1){for(let n=0;n<i[t];n+=1)pt(l,m[t],n,e+n,u);e+=i[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},mt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},_t={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},gt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},vt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},yt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},bt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},wt=(t,e,n)=>{const s=e[n];if(void 0===s)throw t();return s},xt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Tt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},kt=()=>new DOMException("","InvalidStateError"),St=()=>new DOMException("","InvalidAccessError"),Ct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},At=(t,e,n,s,i,r,o,a,c,u,l)=>{const h=u.length;let p=a;for(let a=0;a<h;a+=1){let h=n[0]*u[a];for(let e=1;e<i;e+=1){const s=p-e&c-1;h+=n[e]*r[s],h-=t[e]*o[s]}for(let t=i;t<s;t+=1)h+=n[t]*r[p-t&c-1];for(let n=i;n<e;n+=1)h-=t[n]*o[p-n&c-1];r[p]=u[a],o[p]=h,p=p+1&c-1,l[a]=h}return p},Ot={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Et=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Rt={numberOfChannels:1},Dt=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n]&&(t[n]=s)},Mt=(t,e)=>{Dt(t,e,"channelCount"),Dt(t,e,"channelCountMode"),Dt(t,e,"channelInterpretation")},It=t=>"function"==typeof t.getFloatTimeDomainData,Pt=(t,e,n)=>{const s=e[n];void 0!==s&&s!==t[n].value&&(t[n].value=s)},Vt=t=>{t.start=(e=>(n=0,s=0,i)=>{if("number"==typeof i&&i<0||s<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,s,i)})(t.start)},Nt=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},qt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Lt=async(t,e)=>new t(await(t=>new Promise(((e,n)=>{const{port1:s,port2:i}=new MessageChannel;s.onmessage=({data:t})=>{s.close(),i.close(),e(t)},s.onmessageerror=({data:t})=>{s.close(),i.close(),n(t)},i.postMessage(t)})))(e)),jt=(t,e)=>{const n=t.createBiquadFilter();return Mt(n,e),Pt(n,e,"Q"),Pt(n,e,"detune"),Pt(n,e,"frequency"),Pt(n,e,"gain"),Dt(n,e,"type"),n},Ft=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Mt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw kt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw kt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw kt()}})})(n),n},Bt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ut=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Mt(n,e),Pt(n,e,"delayTime"),n},zt=(t,e)=>{const n=t.createGain();return Mt(n,e),Pt(n,e,"gain"),n};function Wt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Gt(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)i=e,n=[(s=n)[0]*i[0]-s[1]*i[1],s[0]*i[1]+s[1]*i[0]],n[0]+=t[r];var s,i;return n}const Ht=(t,e,n,s)=>t.createScriptProcessor(e,n,s),Xt=()=>new DOMException("","NotSupportedError"),$t={numberOfChannels:1},Yt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Zt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Qt={disableNormalization:!1},Jt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Kt=()=>new DOMException("","UnknownError"),te={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ee=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ne=(t,e,n,s)=>{let i=Object.getPrototypeOf(t);for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:r,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(r),set:s(o)})},se=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ie=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},re=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},oe=(t,e)=>{const n=e.createGain();t.connect(n);const s=(e=>()=>{e.call(t,n),t.removeEventListener("ended",s)})(t.disconnect);t.addEventListener("ended",s),Bt(t,n),t.stop=(e=>{let s=!1;return(i=0)=>{if(s)try{e.call(t,i)}catch{n.gain.setValueAtTime(0,i)}else e.call(t,i),s=!0}})(t.stop)},ae=(t,e)=>n=>{const s={value:t};return Object.defineProperties(n,{currentTarget:s,target:s}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},ce=(t=>(e,n,[s,i,r],o)=>{t(e[i],[n,s,r],(t=>t[0]===n&&t[1]===s),o)})(z),ue=(t=>(e,n,[s,i,r],o)=>{const a=e.get(s);void 0===a?e.set(s,new Set([[i,n,r]])):t(a,[i,n,r],(t=>t[0]===i&&t[1]===n),o)})(z),le=(t=>(e,n,s,i)=>t(e[i],(t=>t[0]===n&&t[1]===s)))(y),he=new WeakMap,pe=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(he),de=(fe=new Map,me=new WeakMap,(t,e)=>{const n=me.get(t);if(void 0!==n)return n;const s=fe.get(t);if(void 0!==s)return s;try{const n=e();return n instanceof Promise?(fe.set(t,n),n.catch((()=>!1)).then((e=>(fe.delete(t),me.set(t,e),e)))):(me.set(t,n),n)}catch{return me.set(t,!1),!1}});var fe,me;const _e="undefined"==typeof window?null:window,ge=((t,e)=>(n,s)=>{const i=n.createAnalyser();if(Mt(i,s),!(s.maxDecibels>s.minDecibels))throw e();return Dt(i,s,"fftSize"),Dt(i,s,"maxDecibels"),Dt(i,s,"minDecibels"),Dt(i,s,"smoothingTimeConstant"),t(It,(()=>It(i)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const s=Math.max(n.length,t.fftSize);for(let t=0;t<s;t+=1)e[t]=.0078125*(n[t]-128);return e}})(i),i})(de,E),ve=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(N),ye=((t,e,n)=>async(s,i,r,o)=>{const a=t(s),c=[...o,s];await Promise.all(a.activeInputs.map(((t,o)=>Array.from(t).filter((([t])=>!c.includes(t))).map((async([t,a])=>{const u=e(t),l=await u.render(t,i,c),h=s.context.destination;n(t)||s===h&&n(s)||l.connect(r,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(N,ve,tt),be=((t,e,n)=>()=>{const s=new WeakMap;return{render(i,r,o){const a=s.get(r);return void 0!==a?Promise.resolve(a):(async(i,r,o)=>{let a=e(i);if(!A(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(r,e)}return s.set(r,a),await n(i,r,a,o),a})(i,r,o)}}})(ge,J,ye),we=(xe=c,t=>{const e=xe.get(t);if(void 0===e)throw kt();return e});var xe;const Te=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(_e),ke=(t=>e=>null!==t&&e instanceof t)(Te),Se=new WeakMap,Ce=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,s){if(null!==n){let i=this._listeners.get(n);void 0===i&&(i=t(this,n),"function"==typeof n&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(e,i,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const s=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===s?null:s,n)}})(ae),Ae=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(_e),Oe=(t=>e=>null!==t&&e instanceof t)(Ae),Ee=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(_e),Re=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(_e),De=((t,e,n,s,i,o,a,c,l,h,p,d,f,m,_)=>class extends h{constructor(e,s,i,o){super(i),this._context=e,this._nativeAudioNode=i;const a=p(e);d(a)&&!0!==n(nt,(()=>nt(a)))&&rt(i),r.set(this,i),u.set(this,new Set),"closed"!==e.state&&s&&x(this),t(this,o,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,r=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw i();const c=p(this._context),u=_(c);if(f(t)||m(t))throw o();if(B(t)){const i=J(t);try{const e=X(this._nativeAudioNode,i,n,r),s=et(this);(u||s)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!s&&et(t)&&x(t)}catch(t){if(12===t.code)throw o();throw t}if(e(this,t,n,r,u)){const e=l([this],t);st(e,s(u))}return t}const h=K(t);if("playbackRate"===h.name)throw a();try{this._nativeAudioNode.connect(h,n),(u||et(this))&&this._nativeAudioNode.disconnect(h,n)}catch(t){if(12===t.code)throw o();throw t}if(ot(this,t,n,u)){const e=l([this],t);st(e,s(u))}}disconnect(t,e,n){let s;const r=p(this._context),a=_(r);if(void 0===t)s=((t,e)=>{const n=N(t),s=[];for(const i of n.outputs)U(i)?at(t,e,...i):ct(t,e,...i),s.push(i[0]);return n.outputs.clear(),s})(this,a);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw i();s=((t,e,n)=>{const s=N(t),i=[];for(const r of s.outputs)r[1]===n&&(U(r)?at(t,e,...r):ct(t,e,...r),i.push(r[0]),s.outputs.delete(r));return i})(this,a,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw i();if(B(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw i();if(s=((t,e,n,s,i)=>{const r=N(t);return Array.from(r.outputs).filter((t=>!(t[0]!==n||void 0!==s&&t[1]!==s||void 0!==i&&t[2]!==i))).map((n=>(U(n)?at(t,e,...n):ct(t,e,...n),r.outputs.delete(n),n[0])))})(this,a,t,e,n),0===s.length)throw o()}for(const t of s){const e=l([this],t);st(e,c)}}})((Me=s,(t,e,n)=>{const s=[];for(let t=0;t<n.numberOfInputs;t+=1)s.push(new Set);Me.set(t,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,s,i,r,o,a,c,u,l,h,p)=>(d,f,m,_,g)=>{const{activeInputs:v,passiveInputs:y}=r(f),{outputs:w}=r(d),T=a(d),k=r=>{const a=c(f),u=c(d);if(r){const e=b(y,d,m,_);t(v,d,e,!1),g||h(d)||n(u,a,m,_),p(f)&&x(f)}else{const t=s(v,d,m,_);e(y,_,t,!1),g||h(d)||i(u,a,m,_);const n=o(f);0===n?l(f)&&S(f,v):setTimeout((()=>{l(f)&&S(f,v)}),1e3*n)}};return!!u(w,[f,m,_],(t=>t[0]===f&&t[1]===m&&t[2]===_),!0)&&(T.add(k),l(d)?t(v,d,[m,_,k],!0):e(y,_,[d,m,k],!0),!0)})(ce,ue,X,le,Q,N,pe,w,J,z,P,tt,et),de,((t,e,n,s,i,r)=>o=>(a,c)=>{const u=t.get(a);if(void 0===u){if(!o&&r(a)){const t=s(a),{outputs:r}=n(a);for(const n of r)if(U(n)){const i=s(n[0]);e(t,i,n[1],n[2])}else{const e=i(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,u+c)})(l,Q,N,J,K,P),E,St,Xt,((t,e,n,s,i,r,o,a)=>(c,u)=>{const l=e.get(c);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=r(c.context),p=a(h);if(l===u){if(e.delete(c),!p&&o(c)){const e=s(c),{outputs:r}=n(c);for(const n of r)if(U(n)){const i=s(n[0]);t(e,i,n[1],n[2])}else{const t=i(n[0]);e.connect(t,n[1])}}}else e.set(c,l-u)})(X,l,N,J,K,we,P,ke),((t,e,n)=>function s(i,r){const o=B(r)?r:n(t,r);if((t=>"delayTime"in t)(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>s([...i,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Se,N,v),Ce,we,Oe,Ee,Re,ke);var Me;const Ie=((t,e,n,s,i,r)=>class extends t{constructor(t,n){const o=i(t),a={...C,...n},c=s(o,a);super(t,!1,c,r(o)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(De,be,E,ge,we,ke),Pe=new WeakSet,Ve=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(_e),Ne=(qe=new Uint32Array(1),t=>(qe[0]=t,qe[0]));var qe;const Le=((t,e)=>n=>{n.copyFromChannel=(s,i,r=0)=>{const o=t(r),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=s.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)s[t]=u[t+o]},n.copyToChannel=(s,i,r=0)=>{const o=t(r),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=s.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)u[t+o]=s[t]}})(Ne,E),je=(t=>e=>{e.copyFromChannel=(n=>(s,i,r=0)=>{const o=t(r),a=t(i);if(o<e.length)return n.call(e,s,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(s,i,r=0)=>{const o=t(r),a=t(i);if(o<e.length)return n.call(e,s,a,o)})(e.copyToChannel)})(Ne),Fe=((t,e,n,s,i,r,o,a)=>{let c=null;return class u{constructor(u){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:p}={...D,...u};null===c&&(c=new i(1,1,44100));const d=null!==s&&e(r,r)?new s({length:l,numberOfChannels:h,sampleRate:p}):c.createBuffer(h,l,p);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(o(d),R(d)):e(O,(()=>O(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e)}}})(Pe,de,Xt,Ve,Te,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Ve),Le,je),Be=(t=>(e,n)=>{const s=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(s).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(s),s.disconnect()};n.addEventListener("ended",i)})(zt),Ue=((t,e,n)=>async(s,i,r,o)=>{const a=e(s);await Promise.all(Array.from(a.activeInputs).map((async([e,s])=>{const a=t(e),c=await a.render(e,i,o);n(e)||c.connect(r,s)})))})(ve,q,tt),ze=(t=>(e,n,s,i)=>t(n,e,s,i))(Ue),We=((t,e,n,s,i,r,o,a,c,u,l)=>(h,p)=>{const d=h.createBufferSource();return Mt(d,p),Pt(d,p,"playbackRate"),Dt(d,p,"buffer"),Dt(d,p,"loop"),Dt(d,p,"loopEnd"),Dt(d,p,"loopStart"),e(n,(()=>n(h)))||(t=>{t.start=(e=>{let n=!1;return(s=0,i=0,r)=>{if(n)throw kt();e.call(t,s,i,r),n=!0}})(t.start)})(d),e(s,(()=>s(h)))||c(d),e(i,(()=>i(h)))||u(d,h),e(r,(()=>r(h)))||Vt(d),e(o,(()=>o(h)))||l(d,h),e(a,(()=>a(h)))||Nt(d),t(h,d),d})(Be,de,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),se,ie,re,(t=>{t.start=(e=>(n=0,s=0,i)=>{const r=t.buffer,o=null===r?s:Math.min(r.duration,s);null!==r&&o>r.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)}),(t=>(e,n)=>{const s=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=s),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===s?null:n}),(t=>n=>t.call(e,null===n?s:n)))})(ne),oe),Ge=((t,e)=>(n,s,i,r)=>(t(s).replay(i),e(s,n,i,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(q),Ue),He=((t,e,n,s,i)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u,l){const h=r.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const p=A(h,u);if(!p){const t={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,t),null!==o&&h.start(...o),null!==a&&h.stop(a)}return r.set(u,h),p?await t(u,c.playbackRate,h.playbackRate,l):await s(u,c.playbackRate,h.playbackRate,l),await i(c,u,h,l),h})(c,u,l)}}})(ze,We,J,Ge,ye),Xe=((t,n,s,i,r,o,a,c,u,l,h,p)=>(d,f,m,_=null,g=null)=>{const v=new e.AutomationEventList(m.defaultValue),y=f?i(v):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,b.setValueAtTime(t,d.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===y&&v.flush(d.context.currentTime),v.add(r(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(d.context.currentTime),v.add(r(t));const n=Array.from(v).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:t=>(null===y&&v.flush(d.context.currentTime),v.add(o(t)),m.cancelScheduledValues(t),b),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(d.context.currentTime),v.add(a(t,e)),m.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(c(t,e)),m.linearRampToValueAtTime(t,e),b),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(d.context.currentTime),v.add(u(t,e,n)),m.setTargetAtTime(t,e,n),b),setValueAtTime:(t,e)=>(null===y&&v.flush(d.context.currentTime),v.add(l(t,e)),m.setValueAtTime(t,e),b),setValueCurveAtTime(t,e,n){const s=t instanceof Float32Array?t:new Float32Array(t);if(null!==p&&"webkitAudioContext"===p.name){const t=e+n,i=d.context.sampleRate,r=Math.ceil(e*i),o=Math.floor(t*i),a=o-r,c=new Float32Array(a);for(let t=0;t<a;t+=1){const o=(s.length-1)/n*((r+t)/i-e),a=Math.floor(o),u=Math.ceil(o);c[t]=a===u?s[a]:(1-(o-a))*s[a]+(1-(u-o))*s[u]}null===y&&v.flush(d.context.currentTime),v.add(h(c,e,n)),m.setValueCurveAtTime(c,e,n);const u=o/i;u<t&&b.setValueAtTime(c[c.length-1],u),b.setValueAtTime(s[s.length-1],t)}else null===y&&v.flush(d.context.currentTime),v.add(h(s,e,n)),m.setValueCurveAtTime(s,e,n);return b}};return s.set(b,m),n.set(b,d),t(b,y),b})(($e=o,(t,e)=>{$e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Se,a,(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:s}=n;e.exponentialRampToValueAtTime(s,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:s}=n;e.linearRampToValueAtTime(s,t)}else if("setTarget"===n.type){const{startTime:t,target:s,timeConstant:i}=n;e.setTargetAtTime(s,t,i)}else if("setValue"===n.type){const{startTime:t,value:s}=n;e.setValueAtTime(s,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:s,values:i}=n;e.setValueCurveAtTime(i,s,t)}}}})),e.createCancelAndHoldAutomationEvent,e.createCancelScheduledValuesAutomationEvent,e.createExponentialRampToValueAutomationEvent,e.createLinearRampToValueAutomationEvent,e.createSetTargetAutomationEvent,e.createSetValueAutomationEvent,e.createSetValueCurveAutomationEvent,Ae);var $e;const Ye=((t,e,n,s,i,r,o,a)=>class extends t{constructor(t,s){const a=r(t),c={...V,...s},u=i(a,c),l=o(a),h=l?e():null;super(t,!1,u,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,I,M)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){x(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(De,He,Xe,kt,We,we,ke,ae),Ze=((t,e,n,s,i,r,o,a)=>class extends t{constructor(t,n){const s=r(t),c=o(s),u=i(s,n,c);super(t,!1,u,c?e(a):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=u}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(De,(t=>{let e=null;return{render:(n,s,i)=>(null===e&&(e=(async(e,n,s)=>{const i=n.destination;return await t(e,n,i,s),i})(n,s,i)),e)}}),E,kt,((t,e)=>(n,s,i)=>{const r=n.destination;if(r.channelCount!==s)try{r.channelCount=s}catch{}i&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:s});const o=t(n,{channelCount:s,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{r.channelCount=e}catch(t){if(e>r.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o})(zt,ne),we,ke,ye),Qe=((t,e,n,s,i)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=A(u,a);if(!l){const t={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(a,t)}return r.set(a,u),l?(await t(a,o.Q,u.Q,c),await t(a,o.detune,u.detune,c),await t(a,o.frequency,u.frequency,c),await t(a,o.gain,u.gain,c)):(await s(a,o.Q,u.Q,c),await s(a,o.detune,u.detune,c),await s(a,o.frequency,u.frequency,c),await s(a,o.gain,u.gain,c)),await i(o,a,u,c),u})(o,a,c)}}})(ze,jt,J,Ge,ye),Je=(t=>(e,n)=>t.set(e,n))(he),Ke=((t,e,n,s,i,r,o,a)=>class extends t{constructor(t,s){const c=r(t),u={...mt,...s},l=i(c,u),h=o(c);super(t,!1,l,h?n():null),this._Q=e(this,h,l.Q,I,M),this._detune=e(this,h,l.detune,1200*Math.log2(I),-1200*Math.log2(I)),this._frequency=e(this,h,l.frequency,t.sampleRate/2,0),this._gain=e(this,h,l.gain,40*Math.log10(I),M),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n),t.length!==e.length||e.length!==n.length)throw s()}})(De,Xe,Qe,St,jt,we,ke,Je),tn=((t,e)=>(n,s,i)=>{const r=new Set;return n.connect=(i=>(o,a=0,c=0)=>{const u=0===r.size;if(e(o))return i.call(n,o,a,c),t(r,[o,a,c],(t=>t[0]===o&&t[1]===a&&t[2]===c),!0),u&&s(),o;i.call(n,o,a),t(r,[o,a],(t=>t[0]===o&&t[1]===a),!0),u&&s()})(n.connect),n.disconnect=(t=>(s,o,a)=>{const c=r.size>0;if(void 0===s)t.apply(n),r.clear();else if("number"==typeof s){t.call(n,s);for(const t of r)t[1]===s&&r.delete(t)}else{e(s)?t.call(n,s,o,a):t.call(n,s,o);for(const t of r)t[0]!==s||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||r.delete(t)}const u=0===r.size;c&&u&&i()})(n.disconnect),n})(z,Ee),en=((t,e)=>(n,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(s,(()=>{const t=s.numberOfInputs;for(let e=0;e<t;e+=1)i.connect(s,0,e)}),(()=>i.disconnect(s)))})(kt,tn),nn=((t,e)=>(n,s)=>{const i=n.createChannelMerger(s.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,i),Mt(i,s),i})(Ae,en),sn=((t,e,n,s,i)=>class extends t{constructor(t,r){const o=s(t),a={..._t,...r};super(t,!1,n(o,a),i(o)?e():null)}})(De,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,r,o){const a=s.get(r);return void 0!==a?Promise.resolve(a):(async(i,r,o)=>{let a=e(i);if(!A(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(r,e)}return s.set(r,a),await n(i,r,a,o),a})(i,r,o)}}})(nn,J,ye),nn,we,ke),rn=((t,e,n,s,i,r)=>class extends t{constructor(t,o){const a=s(t),c=r({...gt,...o});super(t,!1,n(a,c),i(a)?e():null)}})(De,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,r,o){const a=s.get(r);return void 0!==a?Promise.resolve(a):(async(i,r,o)=>{let a=e(i);if(!A(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(r,e)}return s.set(r,a),await n(i,r,a,o),a})(i,r,o)}}})(Ft,J,ye),Ft,we,ke,(t=>({...t,channelCount:t.numberOfOutputs}))),on=((t,e,n,s)=>(i,{offset:r,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(i,{...o,gain:r}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(i,c),s(Bt(h,u),(()=>c.connect(u)),(()=>c.disconnect(u)))})(Be,We,zt,tn),an=((t,e,n,s,i)=>(r,o)=>{if(void 0===r.createConstantSource)return n(r,o);const a=r.createConstantSource();return Mt(a,o),Pt(a,o,"offset"),e(s,(()=>s(r)))||Vt(a),e(i,(()=>i(r)))||Nt(a),t(r,a),a})(Be,de,on,se,re),cn=((t,e,n,s,i,r,o)=>class extends t{constructor(t,o){const a=i(t),c={...vt,...o},u=s(a,c),l=r(a),h=l?n():null;super(t,!1,u,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=u,this._offset=e(this,l,u.offset,I,M),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){x(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(De,Xe,((t,e,n,s,i)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u,l){const h=r.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const p=A(h,u);if(!p){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,t),null!==o&&h.start(o),null!==a&&h.stop(a)}return r.set(u,h),p?await t(u,c.offset,h.offset,l):await s(u,c.offset,h.offset,l),await i(c,u,h,l),h})(c,u,l)}}})(ze,an,J,Ge,ye),an,we,ke,ae),un=((t,e)=>(n,s)=>{const i=n.createConvolver();if(Mt(i,s),s.disableNormalization===i.normalize&&(i.normalize=!s.disableNormalization),Dt(i,s,"buffer"),s.channelCount>2)throw t();if(e(i,"channelCount",(t=>()=>t.call(i)),(e=>n=>{if(n>2)throw t();return e.call(i,n)})),"max"===s.channelCountMode)throw t();return e(i,"channelCountMode",(t=>()=>t.call(i)),(e=>n=>{if("max"===n)throw t();return e.call(i,n)})),i})(Xt,ne),ln=((t,e,n,s,i,r)=>class extends t{constructor(t,o){const a=s(t),c={...yt,...o},u=n(a,c);super(t,!1,u,i(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==c.buffer&&r(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(De,((t,e,n)=>()=>{const s=new WeakMap;return{render(i,r,o){const a=s.get(r);return void 0!==a?Promise.resolve(a):(async(i,r,o)=>{let a=e(i);if(!A(a,r)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(r,e)}return s.set(r,a),H(a)?await n(i,r,a.inputs[0],o):await n(i,r,a,o),a})(i,r,o)}}})(un,J,ye),un,we,ke,Je),hn=((t,e,n,s,i,r,o)=>class extends t{constructor(t,a){const c=i(t),u={...bt,...a},l=s(c,u),h=r(c);super(t,!1,l,h?n(u.maxDelayTime):null),this._delayTime=e(this,h,l.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}})(De,Xe,((t,e,n,s,i)=>r=>{const o=new WeakMap;return{render(a,c,u){const l=o.get(c);return void 0!==l?Promise.resolve(l):(async(a,c,u)=>{let l=n(a);const h=A(l,c);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:r};l=e(c,t)}return o.set(c,l),h?await t(c,a.delayTime,l.delayTime,u):await s(c,a.delayTime,l.delayTime,u),await i(a,c,l,u),l})(a,c,u)}}})(ze,Ut,J,Ge,ye),Ut,we,ke,Je),pn=(t=>(e,n)=>{const s=e.createDynamicsCompressor();if(Mt(s,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Pt(s,n,"attack"),Pt(s,n,"knee"),Pt(s,n,"ratio"),Pt(s,n,"release"),Pt(s,n,"threshold"),s})(Xt),dn=((t,e,n,s,i,r,o,a)=>class extends t{constructor(t,i){const c=r(t),u={...xt,...i},l=s(c,u),h=o(c);super(t,!1,l,h?n():null),this._attack=e(this,h,l.attack),this._knee=e(this,h,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,h,l.ratio),this._release=e(this,h,l.release),this._threshold=e(this,h,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(De,Xe,((t,e,n,s,i)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=A(u,a);if(!l){const t={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(a,t)}return r.set(a,u),l?(await t(a,o.attack,u.attack,c),await t(a,o.knee,u.knee,c),await t(a,o.ratio,u.ratio,c),await t(a,o.release,u.release,c),await t(a,o.threshold,u.threshold,c)):(await s(a,o.attack,u.attack,c),await s(a,o.knee,u.knee,c),await s(a,o.ratio,u.ratio,c),await s(a,o.release,u.release,c),await s(a,o.threshold,u.threshold,c)),await i(o,a,u,c),u})(o,a,c)}}})(ze,pn,J,Ge,ye),pn,Xt,we,ke,Je),fn=((t,e,n,s,i,r)=>class extends t{constructor(t,o){const a=i(t),c={...Tt,...o},u=s(a,c),l=r(a);super(t,!1,u,l?n():null),this._gain=e(this,l,u.gain,I,M)}get gain(){return this._gain}})(De,Xe,((t,e,n,s,i)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=A(u,a);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(a,t)}return r.set(a,u),l?await t(a,o.gain,u.gain,c):await s(a,o.gain,u.gain,c),await i(o,a,u,c),u})(o,a,c)}}})(ze,zt,J,Ge,ye),zt,we,ke),mn=((t,e,n,s)=>(i,r,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=qt(r,i.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),d=l instanceof Float64Array?l:new Float64Array(l),f=p.length,m=d.length,_=Math.min(f,m);if(0===f||f>20)throw s();if(0===p[0])throw e();if(0===m||m>20)throw s();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<m;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=n(i,h,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=c;const v=[],y=[],b=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),b.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,s=e.numberOfChannels;for(let t=0;t<s;t+=1){const s=e.getChannelData(t),i=n.getChannelData(t);v[t]=At(p,f,d,m,_,y[t],b[t],v[t],32,s,i)}};const w=i.sampleRate/2;return Bt({get bufferSize(){return h},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,s){if(e.length!==n.length||n.length!==s.length)throw t();const i=e.length;for(let t=0;t<i;t+=1){const i=-Math.PI*(e[t]/w),r=[Math.cos(i),Math.sin(i)],o=Wt(Gt(d,r),Gt(p,r));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),s[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(St,kt,Ht,Xt),_n=((t,e,n,s)=>i=>t(Et,(()=>Et(i)))?Promise.resolve(t(s,s)).then((t=>{if(!t){const t=n(i,512,0,1);i.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>i.currentTime,t.connect(i.destination)}return i.startRendering()})):new Promise((t=>{const n=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(i.destination),i.startRendering()})))(de,zt,Ht,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),s=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{s.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(zt,Te)),gn=((t,e,n,s,i)=>(r,o)=>{const a=new WeakMap;let c=null;const u=async(u,l,h)=>{let p=null,d=e(u);const f=A(d,l);if(void 0===l.createIIRFilter?p=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(d=l.createIIRFilter(o,r)),a.set(l,null===p?d:p),null!==p){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(u.context.destination.channelCount,u.context.length,l.sampleRate);c=(async()=>{await s(u,t,t.destination,h);return((t,e,n,s)=>{const i=n instanceof Float64Array?n:new Float64Array(n),r=s instanceof Float64Array?s:new Float64Array(s),o=i.length,a=r.length,c=Math.min(o,a);if(1!==i[0]){for(let t=0;t<o;t+=1)r[t]/=i[0];for(let t=1;t<a;t+=1)i[t]/=i[0]}const u=new Float32Array(32),l=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const n=t.getChannelData(e),s=h.getChannelData(e);u.fill(0),l.fill(0),At(i,o,r,a,c,u,l,0,32,n,s)}return h})(await i(t),l,r,o)})()}const t=await c;return p.buffer=t,p.start(0),p}return await s(u,l,d,h),d};return{render(t,e,n){const s=a.get(e);return void 0!==s?Promise.resolve(s):u(t,e,n)}}})(We,J,Te,ye,_n),vn=((t,e,n,s,i,r)=>class extends t{constructor(t,o){const a=s(t),c=i(a),u={...Ct,...o},l=e(a,c?null:t.baseLatency,u);super(t,!1,l,c?n(u.feedback,u.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,s,i)=>{if(n.length!==s.length||s.length!==i.length)throw St();return e.call(t,n,s,i)})})(l),this._nativeIIRFilterNode=l,r(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(De,(t=>(e,n,s)=>{if(void 0===e.createIIRFilter)return t(e,n,s);const i=e.createIIRFilter(s.feedforward,s.feedback);return Mt(i,s),i})(mn),gn,we,ke,Je),yn=((t,e,n,s,i)=>(r,o)=>{const a=o.listener,{forwardX:c,forwardY:u,forwardZ:l,positionX:h,positionY:p,positionZ:d,upX:f,upY:m,upZ:_}=void 0===a.forwardX?(()=>{const c=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),u=i(o),l=s(o,256,9,0),h=(e,s)=>{const i=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:s});return i.connect(c,0,e),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>s}),t({context:r},u,i.offset,I,M)};let p=[0,0,-1,0,1,0],d=[0,0,0];return l.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some(((t,e)=>t!==p[e]))&&(a.setOrientation(...e),p=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some(((t,e)=>t!==d[e]))&&(a.setPosition(...n),d=n)},c.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}})():a;return{get forwardX(){return c},get forwardY(){return u},get forwardZ(){return l},get positionX(){return h},get positionY(){return p},get positionZ(){return d},get upX(){return f},get upY(){return m},get upZ(){return _}}})(Xe,nn,an,Ht,ke),bn=new WeakMap,wn=((t,e,n,s,i,r)=>class extends n{constructor(n,r){super(n),this._nativeContext=n,c.set(this,n),s(n)&&i.set(n,new Set),this._destination=new t(this,r),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?r(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Ze,yn,Ce,ke,bn,ae),xn=((t,e,n,s,i,r)=>(o,a)=>{const c=o.createOscillator();return Mt(c,a),Pt(c,a,"detune"),Pt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):Dt(c,a,"type"),e(n,(()=>n(o)))||Vt(c),e(s,(()=>s(o)))||r(c,o),e(i,(()=>i(o)))||Nt(c),t(o,c),c})(Be,de,se,ie,re,oe),Tn=((t,e,n,s,i)=>()=>{const r=new WeakMap;let o=null,a=null,c=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){c=t},render(u,l,h){const p=r.get(l);return void 0!==p?Promise.resolve(p):(async(u,l,h)=>{let p=n(u);const d=A(p,l);if(!d){const t={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===o?void 0:o,type:p.type};p=e(l,t),null!==a&&p.start(a),null!==c&&p.stop(c)}return r.set(l,p),d?(await t(l,u.detune,p.detune,h),await t(l,u.frequency,p.frequency,h)):(await s(l,u.detune,p.detune,h),await s(l,u.frequency,p.frequency,h)),await i(u,l,p,h),p})(u,l,h)}}})(ze,xn,J,Ge,ye),kn=((t,e,n,s,i,r,o)=>class extends t{constructor(t,o){const a=i(t),c={...Yt,...o},u=n(a,c),l=r(a),h=l?s():null,p=t.sampleRate/2;super(t,!1,u,h),this._detune=e(this,l,u.detune,153600,-153600),this._frequency=e(this,l,u.frequency,p,-p),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){x(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),P(this)&&k(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(De,Xe,xn,Tn,we,ke,ae),Sn=(t=>(e,n)=>{const s=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return s.buffer=i,s.loop=!0,s.connect(n),s.start(),()=>{s.stop(),s.disconnect(n)}})(We),Cn=((t,e,n,s,i)=>(r,{curve:o,oversample:a,...c})=>{const u=r.createWaveShaper(),l=r.createWaveShaper();Mt(u,c),Mt(l,c);const h=n(r,{...c,gain:1}),p=n(r,{...c,gain:-1}),d=n(r,{...c,gain:1}),f=n(r,{...c,gain:-1});let m=null,_=!1,g=null;const v={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){h.channelCount=t,p.channelCount=t,u.channelCount=t,d.channelCount=t,l.channelCount=t,f.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){h.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t},get context(){return u.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),s=new Float32Array(t+2-t%2);e[0]=n[0],s[0]=-n[t-1];const i=Math.ceil((t+1)/2),r=(t+1)/2-1;for(let o=1;o<i;o+=1){const a=o/i*r,c=Math.floor(a),u=Math.ceil(a);e[o]=c===u?n[c]:(1-(a-c))*n[c]+(1-(u-a))*n[u],s[o]=c===u?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(u-a))*n[t-1-u]}e[i]=t%2==1?n[i-1]:(n[i-2]+n[i-1])/2,u.curve=e,l.curve=s}g=n,_&&(s(g)&&null===m?m=t(r,h):null!==m&&(m(),m=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(t){u.oversample=t,l.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a);return i(Bt(v,d),(()=>{h.connect(u).connect(d),h.connect(p).connect(l).connect(f).connect(d),_=!0,s(g)&&(m=t(r,h))}),(()=>{h.disconnect(u),u.disconnect(d),h.disconnect(p),p.disconnect(l),l.disconnect(f),f.disconnect(d),_=!1,null!==m&&(m(),m=null)}))})(Sn,kt,zt,ee,tn),An=((t,e,n,s,i,r,o)=>(a,c)=>{const u=a.createWaveShaper();if(null!==r&&"webkitAudioContext"===r.name)return n(a,c);Mt(u,c);const l=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==l&&l.length<2)throw e();Dt(u,{curve:l},"curve"),Dt(u,c,"oversample");let h=null,p=!1;o(u,"curve",(t=>()=>t.call(u)),(e=>n=>(e.call(u,n),p&&(s(n)&&null===h?h=t(a,u):s(n)||null===h||(h(),h=null)),n)));return i(u,(()=>{p=!0,s(u.curve)&&(h=t(a,u))}),(()=>{p=!1,null!==h&&(h(),h=null)}))})(Sn,kt,Cn,ee,tn,Ae,ne),On=(t=>(e,n)=>{const s=e.createPanner();return void 0===s.orientationX?t(e,n):(Mt(s,n),Pt(s,n,"orientationX"),Pt(s,n,"orientationY"),Pt(s,n,"orientationZ"),Pt(s,n,"positionX"),Pt(s,n,"positionY"),Pt(s,n,"positionZ"),Dt(s,n,"coneInnerAngle"),Dt(s,n,"coneOuterAngle"),Dt(s,n,"coneOuterGain"),Dt(s,n,"distanceModel"),Dt(s,n,"maxDistance"),Dt(s,n,"panningModel"),Dt(s,n,"refDistance"),Dt(s,n,"rolloffFactor"),s)})(((t,e,n,s,i,r,o,a,c)=>(u,{coneInnerAngle:l,coneOuterAngle:h,coneOuterGain:p,distanceModel:d,maxDistance:f,orientationX:m,orientationY:_,orientationZ:g,panningModel:v,positionX:y,positionY:b,positionZ:w,refDistance:x,rolloffFactor:T,...k})=>{const S=u.createPanner();if(k.channelCount>2)throw o();if("max"===k.channelCountMode)throw o();Mt(S,k);const C={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(u,{...C,channelInterpretation:"speakers",numberOfInputs:6}),O=s(u,{...k,gain:1}),E=s(u,{...C,gain:1}),R=s(u,{...C,gain:0}),D=s(u,{...C,gain:0}),M=s(u,{...C,gain:0}),I=s(u,{...C,gain:0}),P=s(u,{...C,gain:0}),V=i(u,256,6,1),N=r(u,{...C,curve:new Float32Array([1,1]),oversample:"none"});let q=[m,_,g],L=[y,b,w];V.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some(((t,e)=>t!==q[e]))&&(S.setOrientation(...e),q=e);const n=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some(((t,e)=>t!==L[e]))&&(S.setPosition(...n),L=n)},Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0});const j={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(t){if(t>2)throw o();O.channelCount=t,S.channelCount=t},get channelCountMode(){return S.channelCountMode},set channelCountMode(t){if("max"===t)throw o();O.channelCountMode=t,S.channelCountMode=t},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(t){O.channelInterpretation=t,S.channelInterpretation=t},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(t){S.coneInnerAngle=t},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(t){S.coneOuterAngle=t},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();S.coneOuterGain=t},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(t){S.distanceModel=t},get inputs(){return[O]},get maxDistance(){return S.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;S.maxDistance=t},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return R.gain},get orientationZ(){return D.gain},get panningModel(){return S.panningModel},set panningModel(t){S.panningModel=t},get positionX(){return M.gain},get positionY(){return I.gain},get positionZ(){return P.gain},get refDistance(){return S.refDistance},set refDistance(t){if(t<0)throw new RangeError;S.refDistance=t},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;S.rolloffFactor=t},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])};l!==j.coneInnerAngle&&(j.coneInnerAngle=l),h!==j.coneOuterAngle&&(j.coneOuterAngle=h),p!==j.coneOuterGain&&(j.coneOuterGain=p),d!==j.distanceModel&&(j.distanceModel=d),f!==j.maxDistance&&(j.maxDistance=f),m!==j.orientationX.value&&(j.orientationX.value=m),_!==j.orientationY.value&&(j.orientationY.value=_),g!==j.orientationZ.value&&(j.orientationZ.value=g),v!==j.panningModel&&(j.panningModel=v),y!==j.positionX.value&&(j.positionX.value=y),b!==j.positionY.value&&(j.positionY.value=b),w!==j.positionZ.value&&(j.positionZ.value=w),x!==j.refDistance&&(j.refDistance=x),T!==j.rolloffFactor&&(j.rolloffFactor=T),1===q[0]&&0===q[1]&&0===q[2]||S.setOrientation(...q),0===L[0]&&0===L[1]&&0===L[2]||S.setPosition(...L);return c(Bt(j,S),(()=>{O.connect(S),t(O,N,0,0),N.connect(E).connect(A,0,0),N.connect(R).connect(A,0,1),N.connect(D).connect(A,0,2),N.connect(M).connect(A,0,3),N.connect(I).connect(A,0,4),N.connect(P).connect(A,0,5),A.connect(V).connect(u.destination)}),(()=>{O.disconnect(S),a(O,N,0,0),N.disconnect(E),E.disconnect(A),N.disconnect(R),R.disconnect(A),N.disconnect(D),D.disconnect(A),N.disconnect(M),M.disconnect(A),N.disconnect(I),I.disconnect(A),N.disconnect(P),P.disconnect(A),A.disconnect(V),V.disconnect(u.destination)}))})(X,kt,nn,zt,Ht,An,Xt,Q,tn)),En=((t,e,n,s,i,r,o,a,c,u)=>()=>{const l=new WeakMap;let h=null;return{render(p,d,f){const m=l.get(d);return void 0!==m?Promise.resolve(m):(async(p,d,f)=>{let m=null,_=r(p);const g={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},v={...g,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},y=A(_,d);if("bufferSize"in _)m=s(d,{...g,gain:1});else if(!y){const t={...v,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=i(d,t)}if(l.set(d,null===m?_:m),null!==m){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,p.context.length,d.sampleRate),s=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});s.connect(t.destination),h=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,s)=>{const i=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===s?1:0});return await a(t,e,i.offset,f),i})));for(let t=0;t<6;t+=1)e[t].connect(s,0,t),e[t].start(0);return u(t)})()}const t=await h,r=s(d,{...g,gain:1});await c(p,d,r,f);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let _=[l[0][0],l[1][0],l[2][0]],y=[l[3][0],l[4][0],l[5][0]],b=s(d,{...g,gain:1}),w=i(d,{...v,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]});r.connect(b).connect(w.inputs[0]),w.connect(m);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==_[e]))||n.some(((t,e)=>t!==y[e]))){_=t,y=n;const o=e/d.sampleRate;b.gain.setValueAtTime(0,o),b=s(d,{...g,gain:0}),w=i(d,{...v,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]}),b.gain.setValueAtTime(1,o),r.connect(b).connect(w.inputs[0]),w.connect(m)}}return m}return y?(await t(d,p.orientationX,_.orientationX,f),await t(d,p.orientationY,_.orientationY,f),await t(d,p.orientationZ,_.orientationZ,f),await t(d,p.positionX,_.positionX,f),await t(d,p.positionY,_.positionY,f),await t(d,p.positionZ,_.positionZ,f)):(await a(d,p.orientationX,_.orientationX,f),await a(d,p.orientationY,_.orientationY,f),await a(d,p.orientationZ,_.orientationZ,f),await a(d,p.positionX,_.positionX,f),await a(d,p.positionY,_.positionY,f),await a(d,p.positionZ,_.positionZ,f)),H(_)?await c(p,d,_.inputs[0],f):await c(p,d,_,f),_})(p,d,f)}}})(ze,nn,an,zt,On,J,Te,Ge,ye,_n),Rn=((t,e,n,s,i,r,o)=>class extends t{constructor(t,a){const c=i(t),u={...Zt,...a},l=n(c,u),h=r(c);super(t,!1,l,h?s():null),this._nativePannerNode=l,this._orientationX=e(this,h,l.orientationX,I,M),this._orientationY=e(this,h,l.orientationY,I,M),this._orientationZ=e(this,h,l.orientationZ,I,M),this._positionX=e(this,h,l.positionX,I,M),this._positionY=e(this,h,l.positionY,I,M),this._positionZ=e(this,h,l.positionZ,I,M),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(De,Xe,On,En,we,ke,Je),Dn=((t,e,n,s)=>class i{constructor(i,r){const o=e(i),a=s({...Qt,...r}),c=t(o,a);return n.add(c),c}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:s,real:i})=>{const r=s instanceof Float32Array?s:new Float32Array(s),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,r,{disableNormalization:n});if(Array.from(s).length<2)throw t();return a})(E),we,new WeakSet,(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})),Mn=((t,e)=>(n,s)=>{const i=s.channelCountMode;if("clamped-max"===i)throw e();if(void 0===n.createStereoPanner)return t(n,s);const r=n.createStereoPanner();return Mt(r,s),Pt(r,s,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>i,set:t=>{if(t!==i)throw e()}}),r})(((t,e,n,s,i,r)=>{const o=16385,a=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(t,r,h,p,d)=>{if(1===r)return((t,e,i,r)=>{const h=new Float32Array(o),p=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*c;h[t]=Math.cos(e),p[t]=Math.sin(e)}const d=n(t,{...u,gain:0}),f=s(t,{...l,curve:h}),m=s(t,{...l,curve:a}),_=n(t,{...u,gain:0}),g=s(t,{...l,curve:p});return{connectGraph(){e.connect(d),e.connect(m.inputs[0]),e.connect(_),m.connect(i),i.connect(f.inputs[0]),i.connect(g.inputs[0]),f.connect(d.gain),g.connect(_.gain),d.connect(r,0,0),_.connect(r,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(m.inputs[0]),e.disconnect(_),m.disconnect(i),i.disconnect(f.inputs[0]),i.disconnect(g.inputs[0]),f.disconnect(d.gain),g.disconnect(_.gain),d.disconnect(r,0,0),_.disconnect(r,0,1)}}})(t,h,p,d);if(2===r)return((t,i,r,h)=>{const p=new Float32Array(o),d=new Float32Array(o),f=new Float32Array(o),m=new Float32Array(o),_=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>_){const e=(t-_)/(16384-_)*c;p[t]=Math.cos(e),d[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-_)*c;p[t]=1,d[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...u,gain:0}),y=s(t,{...l,curve:p}),b=n(t,{...u,gain:0}),w=s(t,{...l,curve:d}),x=s(t,{...l,curve:a}),T=n(t,{...u,gain:0}),k=s(t,{...l,curve:f}),S=n(t,{...u,gain:0}),C=s(t,{...l,curve:m});return{connectGraph(){i.connect(g),i.connect(x.inputs[0]),g.connect(v,0),g.connect(b,0),g.connect(T,1),g.connect(S,1),x.connect(r),r.connect(y.inputs[0]),r.connect(w.inputs[0]),r.connect(k.inputs[0]),r.connect(C.inputs[0]),y.connect(v.gain),w.connect(b.gain),k.connect(T.gain),C.connect(S.gain),v.connect(h,0,0),T.connect(h,0,0),b.connect(h,0,1),S.connect(h,0,1)},disconnectGraph(){i.disconnect(g),i.disconnect(x.inputs[0]),g.disconnect(v,0),g.disconnect(b,0),g.disconnect(T,1),g.disconnect(S,1),x.disconnect(r),r.disconnect(y.inputs[0]),r.disconnect(w.inputs[0]),r.disconnect(k.inputs[0]),r.disconnect(C.inputs[0]),y.disconnect(v.gain),w.disconnect(b.gain),k.disconnect(T.gain),C.disconnect(S.gain),v.disconnect(h,0,0),T.disconnect(h,0,0),b.disconnect(h,0,1),S.disconnect(h,0,1)}}})(t,h,p,d);throw i()};return(e,{channelCount:s,channelCountMode:o,pan:a,...c})=>{if("max"===o)throw i();const u=t(e,{...c,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...c,channelCount:s,channelCountMode:o,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=h(e,s,l,p,u);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(_&&f(),({connectGraph:d,disconnectGraph:f}=h(e,t,l,p,u)),_&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw i();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let _=!1;return r(Bt(m,u),(()=>{d(),_=!0}),(()=>{f(),_=!1}))}})(nn,Ft,zt,An,Xt,tn),Xt),In=((t,e,n,s,i)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=A(u,a);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(a,t)}return r.set(a,u),l?await t(a,o.pan,u.pan,c):await s(a,o.pan,u.pan,c),H(u)?await i(o,a,u.inputs[0],c):await i(o,a,u,c),u})(o,a,c)}}})(ze,Mn,J,Ge,ye),Pn=((t,e,n,s,i,r)=>class extends t{constructor(t,o){const a=i(t),c={...Jt,...o},u=n(a,c),l=r(a);super(t,!1,u,l?s():null),this._pan=e(this,l,u.pan)}get pan(){return this._pan}})(De,Xe,Mn,In,we,ke),Vn=((t,e,n)=>()=>{const s=new WeakMap;return{render(i,r,o){const a=s.get(r);return void 0!==a?Promise.resolve(a):(async(i,r,o)=>{let a=e(i);if(!A(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(r,e)}return s.set(r,a),H(a)?await n(i,r,a.inputs[0],o):await n(i,r,a,o),a})(i,r,o)}}})(An,J,ye),Nn=((t,e,n,s,i,r,o)=>class extends t{constructor(t,e){const a=i(t),c={...te,...e},u=n(a,c);super(t,!0,u,r(a)?s():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=u,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(De,kt,An,Vn,we,ke,Je),qn=(t=>null!==t&&t.isSecureContext)(_e),Ln=(t=>(e,n,s)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return s()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(_e),jn=new WeakMap,Fn=((t,e)=>n=>{let s=t.get(n);if(void 0!==s)return s;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,8e3),t.set(n,s),s})(jn,Te),Bn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(_e),Un=qn?((t,e,n,s,i,r,o,a,c,u,l,p)=>(d,f,v={credentials:"omit"})=>{const y=r(d),b=new URL(f,p.location.href).toString();if(void 0!==y.audioWorklet)return Promise.all([i(f),Promise.resolve(t(l,l))]).then((([t,e])=>{const[n,s]=m(t,b),i=e?s:s.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),r=new Blob([`${n};(registerProcessor=>{${i}\n})((n,p)=>registerProcessor(n,class extends p{${e?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${e?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(r);return y.audioWorklet.addModule(c,v).then((()=>{if(a(y))return;return o(y).audioWorklet.addModule(c,v)})).finally((()=>URL.revokeObjectURL(c)))}));const w=u.get(d);if(void 0!==w&&w.has(f))return Promise.resolve();const x=c.get(d);if(void 0!==x){const t=x.get(f);if(void 0!==t)return t}const T=i(f).then((t=>{const[e,s]=m(t,b);return n(`${e};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${s}\n})})(window,'_AWGS')`)})).then((()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;s(y.currentTime,y.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const s=h.get(y);if(void 0!==s){if(s.has(t))throw e();g(n),_(n.parameterDescriptors),s.set(t,n)}else g(n),_(n.parameterDescriptors),h.set(y,new Map([[t,n]]))}),y.sampleRate,void 0,void 0)))}));return void 0===x?c.set(d,new Map([[f,T]])):x.set(f,T),T.then((()=>{const t=u.get(d);void 0===t?u.set(d,new Set([f])):t.add(f)})).finally((()=>{const t=c.get(d);void 0!==t&&t.delete(f)})),T})(de,Xt,(t=>e=>new Promise(((n,s)=>{if(null===t)return void s(new SyntaxError);const i=t.document.head;if(null===i)s(new SyntaxError);else{const r=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,u=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,i,r,o)=>n===a||n===t.location.href&&1===i&&1===r?(u(),s(o),!1):null!==c?c(e,n,i,r,o):void 0,r.onerror=()=>{u(),s(new SyntaxError)},r.onload=()=>{u(),n()},r.src=a,r.type="module",i.appendChild(r)}})))(_e),Ln,(t=>async e=>{try{const t=await fetch(e);if(t.ok)return t.text()}catch{}throw t()})((()=>new DOMException("","AbortError"))),we,Fn,ke,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,8e3),i=URL.createObjectURL(n);let r=!1,o=!1;try{await s.audioWorklet.addModule(i);const e=new t(s,"a",{numberOfOutputs:0}),n=s.createOscillator();e.port.onmessage=()=>r=!0,e.onprocessorerror=()=>o=!0,n.connect(e),await s.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return r&&!o})(Bn,Te),_e):void 0,zn=((t,e)=>n=>t(n)||e(n))(Oe,ke),Wn=((t,e,n,s,i,r,o,a,c,u,l)=>(h,p)=>{const d=o(h)?h:r(h);if(i.has(p)){const t=n();return Promise.reject(t)}try{i.add(p)}catch{}return e(c,(()=>c(d)))?d.decodeAudioData(p).then((n=>(e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const i=()=>{try{(t=>{const{port1:e}=new MessageChannel;e.postMessage(t,[t])})(p)}catch{}},r=t=>{n(t),i()};try{d.decodeAudioData(p,(n=>{"function"!=typeof n.copyFromChannel&&(u(n),R(n)),t.add(n),i(),e(n)}),(t=>{r(null===t?s():t)}))}catch(t){r(t)}}))})(Pe,de,(()=>new DOMException("","DataCloneError")),(()=>new DOMException("","EncodingError")),new WeakSet,we,zn,O,Et,Le,je),Gn=((t,e,n,s,i,r,o,a,c,u,l,h,p,d,f,m,_,g,v,y)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(t,e,s){return new n({length:e,numberOfChannels:t,sampleRate:s})}createBufferSource(){return new s(this)}createChannelMerger(t=6){return new r(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new _(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t))).catch((t=>{throw"function"==typeof n&&n(t),t}))}})(Un,Ie,Fe,Ye,Ke,sn,rn,cn,ln,Wn,hn,dn,fn,vn,wn,kn,Rn,Dn,Pn,Nn),Hn=((t,e,n,s)=>class extends t{constructor(t,i){const r=n(t),o=e(r,i);if(s(r))throw TypeError();super(t,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(De,((t,e)=>t.createMediaElementSource(e.mediaElement)),we,ke),Xn=((t,e,n,s)=>class extends t{constructor(t,i){const r=n(t);if(s(r))throw new TypeError;const o={...Ot,...i},a=e(r,o);super(t,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(De,((t,e)=>{const n=t.createMediaStreamDestination();return Mt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n}),we,ke),$n=((t,e,n,s)=>class extends t{constructor(t,i){const r=n(t),o=e(r,i);if(s(r))throw new TypeError;super(t,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(De,((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const s=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(i,"mediaStream",{value:e}),i}),we,ke),Yn=((t,e,n)=>class extends t{constructor(t,s){const i=n(t);super(t,!0,e(i,s),null)}})(De,((t,e)=>(n,{mediaStreamTrack:s})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(s);const i=new MediaStream([s]),r=n.createMediaStreamSource(i);if("audio"!==s.kind)throw t();if(e(n))throw new TypeError;return r})(kt,ke),we),Zn=((t,e,n,s,i,r,o,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw s();if(!F(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:i}=t,{sampleRate:r}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===i?512/r:"interactive"===i||void 0===i?256/r:"playback"===i?1024/r:128*Math.max(2,Math.min(128,Math.round(i*r/128)))/r,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),j(this)})))}createMediaElementSource(t){return new i(this,{mediaElement:t})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(Gn,kt,Xt,Kt,Hn,Xn,$n,Yn,Ae),Qn=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(bn),Jn=(t=>(e,n)=>{t(e).add(n)})(Qn),Kn=(t=>(e,n,s=0,i=0)=>{const r=e[s];if(void 0===r)throw t();return it(n)?r.connect(n,0,i):r.connect(n,0)})(E),ts=(t=>(e,n)=>{t(e).delete(n)})(Qn),es=(t=>(e,n,s,i=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?wt(t,e,n).disconnect():it(n)?void 0===s?e.forEach((t=>t.disconnect(n))):void 0===i?wt(t,e,s).disconnect(n,0):wt(t,e,s).disconnect(n,0,i):void 0===s?e.forEach((t=>t.disconnect(n))):wt(t,e,s).disconnect(n,0))(E),ns=new WeakMap,ss=((t,e)=>n=>e(t,n))(ns,v),is=((t,e,n,s,i,r,o,a,c,u,l,h,d)=>(f,m,_,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some((t=>t<1)))throw c();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const y=g.channelCount*g.numberOfInputs,b=v.reduce(((t,e)=>t+e),0),w=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length;if(y+w>6||b>6)throw c();const x=new MessageChannel,T=[],k=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(o(f,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),k.push(i(f,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const S=[];if(void 0!==_.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:s}of _.parameterDescriptors){const i=r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[s]?g.parameterData[s]:void 0===t?0:t});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?I:e},minValue:{get:()=>void 0===n?M:n}}),S.push(i)}const C=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+w)}),A=qt(m,f.sampleRate),O=a(f,A,y+w,Math.max(1,b)),E=i(f,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),R=[];for(let t=0;t<g.numberOfOutputs;t+=1)R.push(s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[t].connect(C,e,t*g.channelCount+e)}const D=new ut(void 0===_.parameterDescriptors?[]:_.parameterDescriptors.map((({name:t},e)=>{const n=S[e];return n.connect(C,0,y+e),n.start(0),[t,n.offset]})));C.connect(O);let P=g.channelInterpretation,V=null;const N=0===g.numberOfOutputs?[O]:R,q={get bufferSize(){return A},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return P},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;P=t},get context(){return O.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return V},set onprocessorerror(t){"function"==typeof V&&q.removeEventListener("processorerror",V),V="function"==typeof t?t:null,"function"==typeof V&&q.addEventListener("processorerror",V)},get parameters(){return D},get port(){return x.port2},addEventListener:(...t)=>O.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,N),disconnect:u.bind(null,N),dispatchEvent:(...t)=>O.dispatchEvent(t[0]),removeEventListener:(...t)=>O.removeEventListener(t[0],t[1],t[2])},L=new Map;var j,F;x.port1.addEventListener=(j=x.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=L.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(f.currentTime,f.sampleRate,(()=>e(t)))},L.set(e,t[1]))}}return j.call(x.port1,t[0],t[1],t[2])}),x.port1.removeEventListener=(F=x.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=L.get(t[1]);void 0!==e&&(L.delete(t[1]),t[1]=e)}return F.call(x.port1,t[0],t[1],t[2])});let B=null;Object.defineProperty(x.port1,"onmessage",{get:()=>B,set:t=>{"function"==typeof B&&x.port1.removeEventListener("message",B),B="function"==typeof t?t:null,"function"==typeof B&&(x.port1.addEventListener("message",B),x.port1.start())}}),_.prototype.port=x.port1;let U=null;((t,e,n,s)=>{let i=p.get(t);void 0===i&&(i=new WeakMap,p.set(t,i));const r=Lt(n,s);return i.set(e,r),r})(f,q,_,g).then((t=>U=t));const z=dt(g.numberOfInputs,g.channelCount),W=dt(g.numberOfOutputs,v),G=void 0===_.parameterDescriptors?[]:_.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let H=!0;const X=()=>{g.numberOfOutputs>0&&O.disconnect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=R[t];for(let s=0;s<v[t];s+=1)E.disconnect(n,e+s,s);e+=v[t]}},$=new Map;O.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==U){const n=h(q);for(let s=0;s<A;s+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)ht(t,z[e],n,n,s);void 0!==_.parameterDescriptors&&_.parameterDescriptors.forEach((({name:e},n)=>{ht(t,G,e,y+n,s)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===W[t][e].byteLength&&(W[t][e]=new Float32Array(128));try{const t=z.map(((t,e)=>{if(n[e].size>0)return $.set(e,A/128),t;const s=$.get(e);return void 0===s?[]:(t.every((t=>t.every((t=>0===t))))&&(1===s?$.delete(e):$.set(e,s-1)),t)})),i=l(f.currentTime+s/f.sampleRate,f.sampleRate,(()=>U.process(t,W,G)));H=i;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let i=0;i<v[t];i+=1)pt(e,W[t],i,n+i,s);n+=v[t]}}catch(t){H=!1,q.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!H){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(k[t]);for(let e=0;e<g.channelCount;e+=1)k[s].disconnect(C,e,t*g.channelCount+e)}if(void 0!==_.parameterDescriptors){const t=_.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=S[e];t.disconnect(C,0,y+e),t.stop()}}C.disconnect(O),O.onaudioprocess=null,Y?X():J();break}}}};let Y=!1;const Z=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Q=()=>O.connect(Z).connect(f.destination),J=()=>{O.disconnect(Z),Z.disconnect()};return Q(),d(q,(()=>{if(H){J(),g.numberOfOutputs>0&&O.connect(E);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=R[t];for(let s=0;s<v[t];s+=1)E.connect(n,e+s,s);e+=v[t]}}Y=!0}),(()=>{H&&(Q(),X()),Y=!1}))})(Kn,E,kt,nn,Ft,an,zt,Ht,Xt,es,Ln,ss,tn),rs=((t,e,n,s,i)=>(r,o,a,c,u,l)=>{if(null!==a)try{const e=new a(r,c,l),s=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=s.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},s.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=s.get(t[1]);void 0!==e&&(s.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(t).connect(r.destination);return i(e,(()=>t.disconnect()),(()=>t.connect(r.destination)))}return e}catch(t){if(11===t.code)throw s();throw t}var h,p;if(void 0===u)throw s();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(r,o,u,l)})(kt,is,zt,Xt,tn),os=((t,e,n,s,i,r,o,a,c,u,l,h,p,d,f,m)=>(_,g,v)=>{const y=new WeakMap;let b=null;return{render(w,x,T){a(x,w);const k=y.get(x);return void 0!==k?Promise.resolve(k):(async(a,w,x)=>{let T=l(a),k=null;const S=A(T,w),C=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===h){const t=C.reduce(((t,e)=>t+e),0),n=i(w,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),r=[];for(let t=0;t<a.numberOfOutputs;t+=1)r.push(s(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:C[t]}));const u=o(w,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});u.connect=e.bind(null,r),u.disconnect=c.bind(null,r),k=[n,r,u]}else S||(T=new h(w,_));if(y.set(w,null===k?T:k[2]),null!==k){if(null===b){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,c=async()=>{const c=new p(n,128*Math.ceil(a.context.length/128),w.sampleRate),u=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)u.push(o(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(i(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=r(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset,x),e}))),_=s(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){u[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(_,e,t*g.channelCount+e)}for(const[e,n]of h.entries())n.connect(_,0,t+e),n.start(0);return _.connect(c.destination),await Promise.all(u.map((t=>f(a,c,t,x)))),m(c)};b=ft(a,0===n?null:await c(),w,g,C,v,u)}const t=await b,e=n(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,l,h]=k;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let s=0;s<C[t];s+=1)c.connect(n,e+s,s);e+=C[t]}return h}if(S)for(const[e,n]of a.parameters.entries())await t(w,n,T.parameters.get(e),x);else for(const[t,e]of a.parameters.entries())await d(w,e,T.parameters.get(t),x);return await f(a,w,T,x),T})(w,x,T)}}})(ze,Kn,We,nn,Ft,an,zt,ts,es,Ln,J,Bn,Te,Ge,ye,_n),as=(t=>e=>t.get(e))(jn),cs=(t=>(e,n)=>{t.set(e,n)})(ns),us=qn?((t,e,n,s,i,r,o,a,c,u,l,p,d)=>class extends e{constructor(e,d,f){var m;const _=a(e),g=c(_),v=l({...lt,...f}),y=h.get(_),b=null==y?void 0:y.get(d),w=g||"closed"!==_.state?_:null!==(m=o(_))&&void 0!==m?m:_,x=i(w,g?null:e.baseLatency,u,d,b,v);super(e,!0,x,g?s(d,v,b):null);const T=[];x.parameters.forEach(((t,e)=>{const s=n(this,g,t);T.push([e,s])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new ut(T),g&&t(_,this);const{activeInputs:k}=r(this);p(x,k)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(Jn,De,Xe,os,rs,N,as,we,ke,Bn,(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))})),cs,ae):void 0,ls=(((t,e,n,s,i)=>{})(kt,Xt,Kt,wn,Ae),((t,e)=>(n,s,i)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,s,i)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Xt,Te)),hs=((t,e,n,s,i,r,o,a)=>{const c=[];return(u,l)=>n(u).render(u,l,c).then((()=>Promise.all(Array.from(s(l)).map((t=>n(t).render(t,l,c)))))).then((()=>i(l))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),R(n)):e(r,(()=>r(n)))||a(n),t.add(n),n)))})(Pe,de,ve,Qn,_n,O,Le,je),ds=(((t,e,n,s,i)=>{})(de,kt,ls,wn,hs),((t,e,n,s,i)=>class extends t{constructor(t,n,i){let r;if("number"==typeof t&&void 0!==n&&void 0!==i)r={length:n,numberOfChannels:t,sampleRate:i};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");r=t}const{length:o,numberOfChannels:a,sampleRate:c}={...$t,...r},u=s(a,o,c);e(Et,(()=>Et(u)))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,a),this._length=o,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,j(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(Gn,de,kt,ls,hs)),fs=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(c,Oe),ms=((t,e)=>n=>t.has(n)||e(n))(r,Ee),_s=((t,e)=>n=>t.has(n)||e(n))(a,Re),gs=((t,e)=>n=>{const s=t.get(n);return e(s)||e(n)})(c,ke);function vs(t,e){if(!t)throw new Error(e)}function ys(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function bs(t){t.isOffline||"running"===t.state||xs('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let ws=console;function xs(...t){ws.warn(...t)}function Ts(t){return void 0===t}function ks(t){return!Ts(t)}function Ss(t){return"number"==typeof t}function Cs(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function As(t){return"boolean"==typeof t}function Os(t){return Array.isArray(t)}function Es(t){return"string"==typeof t}function Rs(t){return Es(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ds(t,e,n){return new ds(t,e,n)}const Ms="object"==typeof self?self:null,Is=Ms&&(Ms.hasOwnProperty("AudioContext")||Ms.hasOwnProperty("webkitAudioContext"));function Ps(t,e,n,s){var i,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,s);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(r<3?i(o):r>3?i(e,n,o):i(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function Vs(t,e,n,s){return new(n||(n=Promise))((function(i,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((s=s.apply(t,e||[])).next())}))}Object.create;Object.create;class Ns{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function qs(t){return _s(t)}function Ls(t){return ms(t)}function js(t){return gs(t)}function Fs(t){return fs(t)}function Bs(t){return t instanceof AudioBuffer}function Us(t,e){return"value"===t||qs(e)||Ls(e)||Bs(e)}function zs(t,...e){if(!e.length)return t;const n=e.shift();if(Cs(t)&&Cs(n))for(const e in n)Us(e,n[e])?t[e]=n[e]:Cs(n[e])?(t[e]||Object.assign(t,{[e]:{}}),zs(t[e],n[e])):Object.assign(t,{[e]:n[e]});return zs(t,...e)}function Ws(t,e,n=[],s){const i={},r=Array.from(e);if(Cs(r[0])&&s&&!Reflect.has(r[0],s)){Object.keys(r[0]).some((e=>Reflect.has(t,e)))||(zs(i,{[s]:r[0]}),n.splice(n.indexOf(s),1),r.shift())}if(1===r.length&&Cs(r[0]))zs(i,r[0]);else for(let t=0;t<n.length;t++)ks(r[t])&&(i[n[t]]=r[t]);return zs(t,i)}function Gs(t,e){return Ts(t)?e:t}function Hs(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class Xs{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Ms&&this.toString()===Ms.TONE_DEBUG_CLASS)&&function(...t){ws.log(...t)}(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Xs.version=t;const $s=1e-6;function Ys(t,e){return t>e+$s}function Zs(t,e){return Ys(t,e)||Js(t,e)}function Qs(t,e){return t+$s<e}function Js(t,e){return Math.abs(t-e)<$s}class Ks extends Xs{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Ws(Ks.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(vs(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];vs(Zs(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Js(this._timeline[e].time,t)){for(let n=e;n>=0&&Js(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Zs(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][e]<=t)return s-1;for(;n<i;){let s=Math.floor(n+(i-n)/2);const r=this._timeline[s],o=this._timeline[s+1];if(Js(r[e],t)){for(let n=s;n<this._timeline.length;n++){if(!Js(this._timeline[n][e],t))break;s=n}return s}if(Qs(r[e],t)&&Ys(o[e],t))return s;Ys(r[e],t)?i=s:n=s+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let s=this._search(t),i=this._search(e);return-1!==s&&-1!==i?(this._timeline[s].time!==t&&(s+=1),this._timeline[i].time===e&&(i-=1),this._iterate(n,s,i)):-1===s&&this._iterate(n,0,i),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&Js(this._timeline[n].time,t)){let s=n;for(let e=n;e>=0&&Js(this._timeline[e].time,t);e--)s=e;this._iterate((t=>{e(t)}),s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const ti=[];function ei(t){ti.push(t)}const ni=[];function si(t){ni.push(t)}class ii extends Xs{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Ts(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...s)=>{e(...s),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Ts(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Ts(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,s=n.length;t<s;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(ii.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class ri extends ii{constructor(){super(...arguments),this.isOffline=!1}}class oi extends ri{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Ks,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Ws(oi.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Zn(t)}({latencyHint:t.latencyHint}),this._ticker=new Ns(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,ti.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){vs(Fs(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(t)}createMediaStreamDestination(){vs(Fs(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){vs(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){vs(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){vs(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){vs(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return vs(ks(us),"This node only works in a secure context (https or localhost)"),new us(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Vs(this,void 0,void 0,(function*(){vs(ks(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Vs(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Es(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&Fs(this._context)?this._context.resume():Promise.resolve()}close(){return Vs(this,void 0,void 0,(function*(){var t;Fs(this._context)&&(yield this._context.close()),this._initialized&&(t=this,ni.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=e,s.loop=!0,s.start(0),this._constants.set(t,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{t(),s()},id:n,time:i+e})};return s(),n}}function ai(t,e){Os(e)?e.forEach((e=>ai(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function ci(t,e){Os(e)?e.forEach((e=>ci(t,e))):Object.defineProperty(t,e,{writable:!0})}const ui=()=>{};class li extends Xs{constructor(){super(),this.name="ToneAudioBuffer",this.onload=ui;const t=Ws(li.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Bs(t.url)||t.url instanceof li?this.set(t.url):Es(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:ui,onload:ui,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:fi().sampleRate}set(t){return t instanceof li?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Vs(this,void 0,void 0,(function*(){const e=li.load(t).then((t=>{this.set(t),this.onload(this)}));li.downloads.push(e);try{yield e}finally{const t=li.downloads.indexOf(e);li.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Os(t)&&t[0].length>0,n=e?t.length:1,s=e?t[0].length:t.length,i=fi(),r=i.createBuffer(n,s,i.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)r.copyToChannel(o[t],t);return this._buffer=r,this}toMono(t){if(Ss(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(Ss(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),s=Math.floor(e*this.sampleRate);vs(n<s,"The start time must be less than the end time");const i=s-n,r=fi().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)r.copyToChannel(this.getChannelData(t).subarray(n,s),t);return new li(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new li).fromArray(t)}static fromUrl(t){return Vs(this,void 0,void 0,(function*(){const e=new li;return yield e.load(t)}))}static load(t){return Vs(this,void 0,void 0,(function*(){const e=t.match(/\[(.+\|?)+\]$/);if(e){const n=e[1].split("|");let s=n[0];for(const t of n)if(li.supportsType(t)){s=t;break}t=t.replace(e[0],s)}const n=""===li.baseUrl||li.baseUrl.endsWith("/")?li.baseUrl:li.baseUrl+"/",s=yield fetch(n+t);if(!s.ok)throw new Error(`could not load url: ${t}`);const i=yield s.arrayBuffer();return yield fi().decodeAudioData(i)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Vs(this,void 0,void 0,(function*(){for(yield Promise.resolve();li.downloads.length;)yield li.downloads[0]}))}}li.baseUrl="",li.downloads=[];class hi extends oi{constructor(){super({clockSource:"offline",context:js(arguments[0])?arguments[0]:Ds(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:js(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=js(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Vs(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Vs(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new li(e)}))}close(){return Promise.resolve()}}const pi=new class extends ri{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Vs(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let di=pi;function fi(){return di===pi&&Is&&mi(new oi),di}function mi(t){di=Fs(t)?new oi(t):js(t)?new hi(t):t}function _i(){return di.resume()}if(Ms&&!Ms.TONE_SILENCE_LOGGING){let t="v";0;const e=` * Tone.js ${t}14.7.58 * `;console.log(`%c${e}`,"background: #000; color: #fff")}function gi(t){return Math.log(t)/Math.LN10*20}function vi(t){return Math.pow(2,t/12)}let yi=440;function bi(t){return Math.round(wi(t))}function wi(t){return 69+12*Math.log2(t/yi)}function xi(t){return yi*Math.pow(2,(t-69)/12)}class Ti extends Xs{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),s="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let s=0;return t&&"0"!==t&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Ti&&this.fromType(this._val),Ts(this._val))return this._noArg();if(Es(this._val)&&Ts(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Cs(this._val)){let t=0;for(const e in this._val)if(ks(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(ks(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Es(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class ki extends Ti{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new ki(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),s=this.valueOf();return s+(Math.round(s/n)*n-s)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],s=new ki(this.context,e[0]).toSeconds();return e.forEach((e=>{const i=new ki(this.context,e).toSeconds();Math.abs(i-t)<Math.abs(s-t)&&(n=e,s=i)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let s=e%1*4;e=Math.floor(e)%this._getTimeSignature();const i=s.toString();i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3)));return[n,e,s].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return bi(this.toFrequency())}_now(){return this.context.now()}}class Si extends ki{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return yi}static set A4(t){!function(t){yi=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Si.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Ci[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Si.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let s=1;return t&&"0"!==t&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(t){return new Si(this.context,this.valueOf()*vi(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return bi(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Si.A4);let n=Math.round(12*e)+57;const s=Math.floor(n/12);s<0&&(n+=-12*s);return Ai[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return xi(t)}static ftom(t){return bi(t)}}const Ci={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Ai=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Oi extends ki{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Ei extends Xs{constructor(){super();const t=Ws(Ei.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:fi()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new ki(this.context,t).toSeconds()}toFrequency(t){return new Si(this.context,t).toFrequency()}toTicks(t){return new Oi(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Ts(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];ks(n)&&ks(n.value)&&ks(n.setValueAtTime)?t[e]=n.value:n instanceof Ei?t[e]=n._getPartialProperties(t[e]):Os(n)||Ss(n)||Es(n)||As(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&ks(this[e])&&(this[e]&&ks(this[e].value)&&ks(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Ei?this[e].set(t[e]):this[e]=t[e])})),this}}class Ri extends Ks{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return ys(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class Di extends Ei{constructor(){super(Ws(Di.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Ws(Di.getDefaults(),arguments,["param","units","convert"]);for(vs(ks(t.param)&&(qs(t.param)||t.param instanceof Di),"param must be an AudioParam");!qs(t.param);)t.param=t.param._param;this._swappable=!!ks(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Ks(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,ks(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ei.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return ks(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return ks(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return ks(this.maxValue)&&ks(this.minValue)&&ys(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e}_toType(t){return this.convert&&"decibels"===this.units?gi(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),s=this._fromType(t);return vs(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),s=this._events.get(e);let i=this._initialValue;if(null===s)i=this._initialValue;else if("setTargetAtTime"!==s.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=s.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=s.value;if("setTargetAtTime"===s.type){const e=this._events.getBefore(s.time);t=null===e?this._initialValue:e.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(s.time,t,n.time,n.value,e):this._exponentialInterpolate(s.time,t,n.time,n.value,e)}else i=s.value;else{const t=this._events.getBefore(s.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===s.type&&(i=this._exponentialApproach(s.time,n,s.value,s.constant,e))}return this._toType(i)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),s=this.toSeconds(e);return vs(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Math.max(this._minOutput,n),this._assertRange(n);const s=this.toSeconds(e);return vs(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,s),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const s=this._fromType(t);vs(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(e);return this._assertRange(s),vs(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",t,i,n),this._param.setTargetAtTime(s,i,n),this}setValueCurveAtTime(t,e,n,s=1){n=this.toSeconds(n),e=this.toSeconds(e);const i=this._fromType(t[0])*s;this.setValueAtTime(this._toType(i),e);const r=n/(t.length-1);for(let n=1;n<t.length;n++){const i=this._fromType(t[n])*s;this.linearRampToValueAtTime(this._toType(i),e+n*r)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return vs(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));vs(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const s=this._events.get(e),i=this._events.getAfter(e);return s&&Js(s.time,e)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const s=this._events.getAfter(n.time),i=s?s.time:e+2,r=(i-e)/10;for(let n=e;n<i;n+=r)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){vs(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,s,i){return n+(e-n)*Math.exp(-(i-t)/s)}_linearInterpolate(t,e,n,s,i){return e+(i-t)/(n-t)*(s-e)}_exponentialInterpolate(t,e,n,s,i){return e*Math.pow(s/e,(i-t)/(n-t))}}class Mi extends Ei{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return ks(this.input)?qs(this.input)||this.input instanceof Di?1:this.input.numberOfInputs:0}get numberOfOutputs(){return ks(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return ks(t)&&(t instanceof Mi||Ls(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();vs(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Pi(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return xs("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Vi(this,t,e,n),this}chain(...t){return Ii(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),ks(this.input)&&(this.input instanceof Mi?this.input.dispose():Ls(this.input)&&this.input.disconnect()),ks(this.output)&&(this.output instanceof Mi?this.output.dispose():Ls(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Ii(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Mi?t.connect(e):Ls(t)&&Pi(t,e),e)),e)}function Pi(t,e,n=0,s=0){for(vs(ks(t),"Cannot connect from undefined node"),vs(ks(e),"Cannot connect to undefined node"),(e instanceof Mi||Ls(e))&&vs(e.numberOfInputs>0,"Cannot connect to node with no inputs"),vs(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Mi||e instanceof Di;)ks(e.input)&&(e=e.input);for(;t instanceof Mi;)ks(t.output)&&(t=t.output);qs(e)?t.connect(e,n):t.connect(e,n,s)}function Vi(t,e,n=0,s=0){if(ks(e))for(;e instanceof Mi;)e=e.input;for(;!Ls(t);)ks(t.output)&&(t=t.output);qs(e)?t.disconnect(e,n):Ls(e)?t.disconnect(e,n,s):t.disconnect()}class Ni extends Mi{constructor(){super(Ws(Ni.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Ws(Ni.getDefaults(),arguments,["gain","units"]);this.gain=new Di({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),ai(this,"gain")}static getDefaults(){return Object.assign(Mi.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class qi extends Mi{constructor(t){super(t),this.onended=ui,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ni({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Mi.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:ui})}_startGain(t,e=1){vs(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){vs(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==ui&&(this.onended(this),this.onended=ui,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),vs(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Li extends qi{constructor(){super(Ws(Li.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Ws(Li.getDefaults(),arguments,["offset"]);Pi(this._source,this._gainNode),this.offset=new Di({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(qi.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class ji extends Mi{constructor(){super(Ws(ji.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Ws(ji.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Li({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Mi.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Fi(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,s){return this._param.setValueCurveAtTime(t,e,n,s),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Fi(t,e,n,s){(e instanceof Di||qs(e)||e instanceof ji&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof ji&&(e.overridden=!0)),Pi(t,e,n,s)}class Bi extends Di{constructor(){super(Ws(Bi.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Ks(1/0),this._multiplier=1;const t=Ws(Bi.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Di.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const s=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(1/n,1));for(let t=0;t<=r;t++){const r=n*t+e,o=this._exponentialApproach(i.time,i.value,s,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),r=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(r,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const s=this._events.get(n),i=this._events.previousEvent(s),r=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),s=this._events.get(e),i=Math.round(Math.max(10*(e-s.time),1)),r=(e-s.time)/i;for(let t=0;t<=i;t++){const i=r*t+s.time,o=this._exponentialInterpolate(s.time,s.value,e,n,i);this.linearRampToValueAtTime(this._toType(o),i)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Ts(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let s=this._fromType(this.getValueAtTime(e));const i=this._events.get(e);return i&&i.time===e&&"setValueAtTime"===i.type&&(s=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+s)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(e);return this.getTimeOfTick(s+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const s=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-e.time),r=Math.sqrt(Math.pow(s,2)-2*i*(e.ticks-t)),o=(-s+r)/i,a=(-s-r)/i;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),s=this.toSeconds(t),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-i}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Ui extends ji{constructor(){super(Ws(Ui.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Ws(Ui.getDefaults(),arguments,["value"]);this.input=this._param=new Bi({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(ji.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class zi extends Ei{constructor(){super(Ws(zi.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Ri,this._tickOffset=new Ks;const t=Ws(zi.getDefaults(),arguments,["frequency"]);this.frequency=new Ui({context:this.context,units:t.units,value:t.frequency}),ai(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Ei.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ks(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);let i=n,r=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.ticks,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),i=t})),this._state.remove(s),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let s=e,i=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(i=n.seconds,e=n.time),"started"===s.state&&"started"!==t.state&&(i+=t.time-e),s=t})),this._state.remove(n),i}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),s=this._state.get(e),i=Math.max(n.time,s.time),r=this.frequency.getTicksAtTime(i)+t-n.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(t,e,n){let s=this._state.get(t);this._state.forEachBetween(t,e,(e=>{s&&"started"===s.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(s.time,t),e.time-this.sampleTime,n),s=e}));let i=null;if(s&&"started"===s.state){const r=Math.max(s.time,t),o=this.frequency.getTicksAtTime(r),a=o-this.frequency.getTicksAtTime(s.time);let c=Math.ceil(a)-a;c=Js(c,1)?0:c;let u=this.frequency.getTimeOfTick(o+c);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(t){i=t;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Wi extends Ei{constructor(){super(Ws(Wi.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=ui,this._lastUpdate=0,this._state=new Ri("stopped"),this._boundLoop=this._loop.bind(this);const t=Ws(Wi.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new zi({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,ai(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Ei.getDefaults(),{callback:ui,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){bs(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ii.mixin(Wi);class Gi extends Mi{constructor(){super(Ws(Gi.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=Ws(Gi.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new Di({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),ai(this,"delayTime")}static getDefaults(){return Object.assign(Mi.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Hi extends Xs{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Ws(Hi.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:ui,onload:ui,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return vs(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=ui,s=ui){return Es(e)?this._buffers.set(t.toString(),new li(this.baseUrl+e,n,s)):this._buffers.set(t.toString(),new li(e,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class Xi extends Si{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return bi(super._frequencyToUnits(t))}_ticksToUnits(t){return bi(super._ticksToUnits(t))}_beatsToUnits(t){return bi(super._beatsToUnits(t))}_secondsToUnits(t){return bi(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return xi(this.toMidi())}transpose(t){return new Xi(this.context,this.toMidi()+t)}}class $i extends Oi{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Yi extends Ei{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Ks,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}ei((t=>{t.draw=new Yi({context:t})})),si((t=>{t.draw.dispose()}));class Zi extends Xs{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){vs(ks(t.time),"Events must have a time property"),vs(ks(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Qi(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),s=t.right;s&&(t.right=s.left,s.left=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),s=t.left;s&&(t.left=s.right,s.right=t),null!==e?n?e.left=s:e.right=s:this._setRoot(s)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Qi{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Ji extends Mi{constructor(){super(Ws(Ji.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Ws(Ji.getDefaults(),arguments,["volume"]);this.input=this.output=new Ni({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,ai(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Mi.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Ki extends Mi{constructor(){super(Ws(Ki.getDefaults(),arguments)),this.name="Destination",this.input=new Ji({context:this.context}),this.output=new Ni({context:this.context}),this.volume=this.input.volume;const t=Ws(Ki.getDefaults(),arguments);Ii(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Mi.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Ii(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}ei((t=>{t.destination=new Ki({context:t})})),si((t=>{t.destination.dispose()}));class tr extends Xs{constructor(t){super(),this.name="TimelineValue",this._timeline=new Ks({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class er{constructor(t,e){this.id=er._eventId++;const n=Object.assign(er.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:ui,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}er._eventId=0;class nr extends er{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(nr.getDefaults(),e);this.duration=new $i(t.context,n.duration).valueOf(),this._interval=new $i(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},er.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new $i(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new $i(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new $i(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class sr extends Ei{constructor(){super(Ws(sr.getDefaults(),arguments)),this.name="Transport",this._loop=new tr(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Ks,this._repeatedEvents=new Zi,this._syncedSignals=[],this._swingAmount=0;const t=Ws(sr.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new Wi({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),ai(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Ei.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),s=Math.sin(n*Math.PI)*this._swingAmount;t+=new $i(this.context,2*this._swingTicks/3).toSeconds()*s}this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new er(this,{callback:t,time:new Oi(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,s=1/0){const i=new nr(this,{callback:t,duration:new ki(this.context,s).toTicks(),interval:new ki(this.context,e).toTicks(),time:new Oi(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(t,e){const n=new er(this,{callback:t,once:!0,time:new Oi(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new $i(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return ks(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Os(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new ki(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new ki(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new $i(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new $i(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),s=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",s),this._clock.setTicksAtTime(t,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const s=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/s}else e=0}const n=new Ni(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),ci(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ii.mixin(sr),ei((t=>{t.transport=new sr({context:t})})),si((t=>{t.transport.dispose()}));class ir extends Mi{constructor(t){super(t),this.input=void 0,this._state=new Ri("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=ui,this._syncedStop=ui,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Ji({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,ai(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Mi.getDefaults(),{mute:!1,onstop:ui,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let s=Ts(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(s=this._clampToCurrentTime(s),this._synced||"started"!==this._state.getValueAtTime(s))if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const t=this._state.get(s);t&&(t.offset=this.toSeconds(Gs(e,0)),t.duration=n?this.toSeconds(n):void 0);const i=this.context.transport.schedule((t=>{this._start(t,e,n)}),s);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else bs(this.context),this._start(s,e,n);else vs(Ys(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,e,n);return this}stop(t){let e=Ts(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||ks(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const s=e-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-s),this._start(t,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=ui,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class rr extends qi{constructor(){super(Ws(rr.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Ws(rr.getDefaults(),arguments,["url","onload"]);Pi(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Di({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new li(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(qi.getDefaults(),{url:new li,loop:!1,loopEnd:0,loopStart:0,onload:ui,onerror:ui,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,s=1){vs(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(t);this._startGain(i,s),e=this.loop?Gs(e,this.loopStart):Gs(e,0);let r=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;Zs(r,t)&&(r=(r-e)%n+e),Js(r,this.buffer.duration)&&(r=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Qs(r,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,r)),ks(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(i+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class or extends ir{constructor(){super(Ws(or.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=Ws(or.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ir.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(vs(t in ur,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=ur[this._type];this._source=new rr({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const ar=220500,cr={brown:null,pink:null,white:null},ur={get brown(){if(!cr.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ar);t[e]=n;let s=0;for(let t=0;t<ar;t++){const e=2*Math.random()-1;n[t]=(s+.02*e)/1.02,s=n[t],n[t]*=3.5}}cr.brown=(new li).fromArray(t)}return cr.brown},get pink(){if(!cr.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ar);let s,i,r,o,a,c,u;t[e]=n,s=i=r=o=a=c=u=0;for(let t=0;t<ar;t++){const e=2*Math.random()-1;s=.99886*s+.0555179*e,i=.99332*i+.0750759*e,r=.969*r+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,n[t]=s+i+r+o+a+c+u+.5362*e,n[t]*=.11,u=.115926*e}}cr.pink=(new li).fromArray(t)}return cr.pink},get white(){if(!cr.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(ar);t[e]=n;for(let t=0;t<ar;t++)n[t]=2*Math.random()-1}cr.white=(new li).fromArray(t)}return cr.white}};function lr(t,e){return Vs(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,s=new hi(1,n,t.context.sampleRate);new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:s})).toDestination().start(0);return(yield s.render()).getChannelData(0)}))}class hr extends qi{constructor(){super(Ws(hr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Ws(hr.getDefaults(),arguments,["frequency","type"]);Pi(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Di({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Di({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),ai(this,["frequency","detune"])}static getDefaults(){return Object.assign(qi.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class pr extends ir{constructor(){super(Ws(pr.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Ws(pr.getDefaults(),arguments,["frequency","type"]);this.frequency=new ji({context:this.context,units:"frequency",value:t.frequency}),ai(this,"frequency"),this.detune=new ji({context:this.context,units:"cents",value:t.detune}),ai(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ir.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new hr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return pr._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}))}{const t=pr._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(ks(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),s=this.context.createPeriodicWave(e,n);this._wave=s,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),pr._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),pr._periodicWaveCache.length>100&&pr._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){ys(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const s=new Float32Array(n),i=new Float32Array(n);let r=1;if("custom"===t){if(r=this._partials.length+1,this._partialCount=this._partials.length,n=r,0===this._partials.length)return[s,i]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(r=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],r=Math.max(r,2),n=r):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=r?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(s[o]=-a*Math.sin(e*o),i[o]=a*Math.cos(e*o)):(s[o]=0,i[o]=0)}return[s,i]}_inverseFFT(t,e,n){let s=0;const i=t.length;for(let r=0;r<i;r++)s+=t[r]*Math.cos(r*n)+e[r]*Math.sin(r*n);return s}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const s=2*Math.PI;for(let i=0;i<32;i++)n=Math.max(this._inverseFFT(t,e,i/32*s),n);return i=-this._inverseFFT(t,e,this._phase)/n,r=-1,o=1,Math.max(Math.min(i,o),r);var i,r,o}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}pr._periodicWaveCache=[];class dr extends Mi{constructor(){super(Object.assign(Ws(dr.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Fi(this,t,e,n),this}}class fr extends dr{constructor(){super(Object.assign(Ws(fr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Ws(fr.getDefaults(),arguments,["mapping","length"]);Os(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(ji.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let s=0,i=e;s<i;s++){const e=s/(i-1)*2-1;n[s]=t(e,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){vs(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class mr extends dr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new fr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class _r extends ji{constructor(){super(Object.assign(Ws(_r.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Ws(_r.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ni({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ji.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class gr extends ir{constructor(){super(Ws(gr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new mr({context:this.context}),this._modulationNode=new Ni({context:this.context});const t=Ws(gr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new pr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new pr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new _r({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),ai(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(pr.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class vr extends ir{constructor(){super(Ws(vr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ni({context:this.context,gain:0});const t=Ws(vr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new pr({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new ji({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new pr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new _r({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new _r({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),ai(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(pr.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class yr extends ir{constructor(){super(Ws(yr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ni({context:this.context,gain:0}),this._thresh=new fr({context:this.context,mapping:t=>t<=0?-1:1});const t=Ws(yr.getDefaults(),arguments,["frequency","width"]);this.width=new ji({context:this.context,units:"audioRange",value:t.width}),this._triangle=new pr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),ai(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ir.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class br extends ir{constructor(){super(Ws(br.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Ws(br.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new ji({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ji({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,ai(this,["frequency","detune"])}static getDefaults(){return Object.assign(pr.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,s)=>t.detune.value=e+n*s))}}get count(){return this._oscillators.length}set count(t){if(ys(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new pr({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):ui});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class wr extends ir{constructor(){super(Ws(wr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new _r({context:this.context,value:2});const t=Ws(wr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new yr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new pr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),ai(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ir.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const xr={am:gr,fat:br,fm:vr,oscillator:pr,pulse:yr,pwm:wr};class Tr extends ir{constructor(){super(Ws(Tr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Ws(Tr.getDefaults(),arguments,["frequency","type"]);this.frequency=new ji({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ji({context:this.context,units:"cents",value:t.detune}),ai(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(pr.getDefaults(),vr.getDefaults(),gr.getDefaults(),br.getDefaults(),yr.getDefaults(),wr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=xr[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof xr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&Ss(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&Ss(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Es(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){return lr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class kr extends ji{constructor(){super(Object.assign(Ws(kr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Ni({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Ii(this._constantSource,this._sum)}static getDefaults(){return Object.assign(ji.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Sr extends dr{constructor(){super(Object.assign(Ws(Sr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=Ws(Sr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new _r({context:this.context,value:t.max-t.min}),this._add=this.output=new kr({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(dr.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Cr extends dr{constructor(){super(Object.assign(Ws(Cr.getDefaults(),arguments))),this.name="Zero",this._gain=new Ni({context:this.context}),this.output=this._gain,this.input=void 0,Pi(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Vi(this.context.getConstant(0),this._gain),this}}class Ar extends Mi{constructor(){super(Ws(Ar.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Di.prototype._fromType,this._toType=Di.prototype._toType,this._is=Di.prototype._is,this._clampValue=Di.prototype._clampValue;const t=Ws(Ar.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new pr({context:this.context,frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Ni({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new ji({context:this.context,units:"audioRange",value:0}),this._zeros=new Cr({context:this.context}),this._a2g=new mr({context:this.context}),this._scaler=this.output=new Sr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._a2g,this._amplitudeGain,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),ai(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(Mi.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof Di||t instanceof ji)&&(this.convert=t.convert,this.units=t.units),Fi(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Or(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ys(s,t,e),n.set(this,s)}})}}function Er(t,e=1/0){const n=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){ys(this.toSeconds(s),t,e),n.set(this,s)}})}}class Rr extends ir{constructor(){super(Ws(Rr.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Ws(Rr.getDefaults(),arguments,["url","onload"]);this._buffer=new li({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ir.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:ui,onerror:ui,playbackRate:1,reverse:!1})}load(t){return Vs(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=ui){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Gs(e,this._loopStart):Gs(e,0);let s=this.toSeconds(e);this._synced&&(s*=this._playbackRate);const i=n;n=Gs(n,Math.max(this._buffer.duration-s,0));let r=this.toSeconds(n);r/=this._playbackRate,t=this.toSeconds(t);const o=new rr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+r),this._state.setStateAtTime("stopped",t+r,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Ts(i)?o.start(t,s):o.start(t,s,r-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&ys(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&ys(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Ps([Er(0)],Rr.prototype,"fadeIn",void 0),Ps([Er(0)],Rr.prototype,"fadeOut",void 0);class Dr extends ir{constructor(){super(Ws(Dr.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=Ws(Dr.getDefaults(),arguments,["url","onload"]);this.buffer=new li({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new Wi({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(ir.getDefaults(),{onload:ui,onerror:ui,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=Gs(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const s=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/s),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const s=n<this._overlap?0:this._overlap,i=new rr({context:this.context,url:this.buffer,fadeIn:s,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:vi(this.detune/100)}).connect(this.output);i.start(t,this._grainSize*e),i.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){ys(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&ys(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&ys(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);ys(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class Mr extends dr{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new fr({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ir extends Mi{constructor(){super(Ws(Ir.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new ji({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Ws(Ir.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Mi.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Es(t))return t;{let n;for(n in Pr)if(Pr[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Es(n)&&Reflect.has(Pr,n)){const s=Pr[n];Cs(s)?"_decayCurve"!==t&&(this[t]=s[e]):this[t]=s}else{if(!Os(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){vs(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){n=(1-i)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let s=this._attackCurve;for(let t=1;t<s.length;t++)if(s[t-1]<=i&&i<=s[t]){s=this._attackCurve.slice(t),s[0]=i;break}this._sig.setValueCurveAtTime(s,t,n,e)}if(s&&this.sustain<1){const i=e*this.sustain,r=t+n;this.log("decay",r),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,s+r):this._sig.exponentialApproachValueAtTime(i,r,s)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(vs(Os(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Fi(this,t,e,n),this}asArray(t=1024){return Vs(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new hi(1,e,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),r=.1*i,o=i+r,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));a._sig.toDestination(),a.triggerAttackRelease(e*(s+r)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Ps([Er(0)],Ir.prototype,"attack",void 0),Ps([Er(0)],Ir.prototype,"decay",void 0),Ps([Or(0,1)],Ir.prototype,"sustain",void 0),Ps([Er(0)],Ir.prototype,"release",void 0);const Pr=(()=>{const t=128;let e,n;const s=[];for(e=0;e<t;e++)s[e]=Math.sin(e/127*(Math.PI/2));const i=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=t/10+.83*n}i[127]=1;const r=[];for(e=0;e<t;e++)r[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,s=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(s*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(a),Out:a},cosine:{In:s,Out:(u=s,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:c(i)},sine:{In:o,Out:c(o)},step:{In:r,Out:c(r)}};var u})();class Vr extends Mi{constructor(){super(Ws(Vr.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Ws(Vr.getDefaults(),arguments);this._volume=this.output=new Ji({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ai(this,"volume")}static getDefaults(){return Object.assign(Mi.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const s=t[e],i=this.context.transport.schedule((s=>{t[e]=s,n.apply(this,t)}),s);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,s){const i=this.toSeconds(n),r=this.toSeconds(e);return this.triggerAttack(t,i,s),this.triggerRelease(i+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Nr extends Vr{constructor(){super(Ws(Nr.getDefaults(),arguments));const t=Ws(Nr.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Vr.getDefaults(),{detune:0,onsilence:ui,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const s=this.toSeconds(e);return this._triggerEnvelopeAttack(s,n),this.setNote(t,s),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),s=t instanceof Si?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,t,n)}else this.frequency.setValueAtTime(s,n);return this}}Ps([Er(0)],Nr.prototype,"portamento",void 0);class qr extends Ir{constructor(){super(Ws(qr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ni({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Lr extends Nr{constructor(){super(Ws(Lr.getDefaults(),arguments)),this.name="Synth";const t=Ws(Lr.getDefaults(),arguments);this.oscillator=new Tr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new qr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),ai(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{envelope:Object.assign(Hs(Ir.getDefaults(),Object.keys(Mi.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Hs(Tr.getDefaults(),[...Object.keys(ir.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class jr extends Nr{constructor(){super(Ws(jr.getDefaults(),arguments)),this.name="ModulationSynth";const t=Ws(jr.getDefaults(),arguments);this._carrier=new Lr({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Lr({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new ji({context:this.context,units:"frequency"}),this.detune=new ji({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new _r({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Ni({context:this.context,gain:0}),ai(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Nr.getDefaults(),{harmonicity:3,oscillator:Object.assign(Hs(Tr.getDefaults(),[...Object.keys(ir.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Hs(Ir.getDefaults(),Object.keys(Mi.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Hs(Tr.getDefaults(),[...Object.keys(ir.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Hs(Ir.getDefaults(),Object.keys(Mi.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Fr extends Mi{constructor(){super(Ws(Fr.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=Ws(Fr.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Di({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new Di({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new Di({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new Di({context:this.context,units:"gain",value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Mi.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){vs(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const s=19980*Math.pow(n/t,2)+20;e[n]=s}const n=new Float32Array(t),s=new Float32Array(t),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(e,n,s),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Br extends Mi{constructor(){super(Ws(Br.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Ni({context:this.context}),this.output=new Ni({context:this.context}),this._filters=[];const t=Ws(Br.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new ji({context:this.context,units:"positive",value:t.Q}),this.frequency=new ji({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ji({context:this.context,units:"cents",value:t.detune}),this.gain=new ji({context:this.context,units:"decibels",value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,ai(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Mi.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){vs(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=Ss(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let s=n.indexOf(e);vs(-1!==s,`rolloff can only be ${n.join(", ")}`),s+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(s);for(let t=0;t<s;t++){const e=new Fr({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,Ii(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Fr({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>n[e]*=t))})),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),ci(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class Ur extends jr{constructor(){super(Ws(Ur.getDefaults(),arguments)),this.name="FMSynth";const t=Ws(Ur.getDefaults(),arguments);this.modulationIndex=new _r({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(jr.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}class zr extends Lr{constructor(){super(Ws(zr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Ws(zr.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,ai(this,["oscillator","envelope"])}static getDefaults(){return zs(Nr.getDefaults(),Lr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),s=this.toFrequency(t instanceof Si?t.toFrequency():t),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ps([Or(0)],zr.prototype,"octaves",void 0),Ps([Er(0)],zr.prototype,"pitchDecay",void 0);const Wr=new Set;function Gr(t){Wr.add(t)}function Hr(t,e){const n=`registerProcessor("${t}", ${e})`;Wr.add(n)}class Xr extends Mi{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=ui;const e=URL.createObjectURL(new Blob([Array.from(Wr).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Gr('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Gr("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Gr("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const $r="feedback-comb-filter";Hr($r,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Yr extends Xr{constructor(){super(Ws(Yr.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=Ws(Yr.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Ni({context:this.context}),this.output=new Ni({context:this.context}),this.delayTime=new Di({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Di({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),ai(this,["resonance","delayTime"])}_audioWorkletName(){return $r}static getDefaults(){return Object.assign(Mi.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){Ii(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class Zr extends Mi{constructor(){super(Ws(Zr.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=Ws(Zr.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new Ni({context:this.context}),this.output=new Ni({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(Mi.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const s=19980*Math.pow(n/t,2)+20;e[n]=s}const n=new Float32Array(t),s=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,s),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Qr extends Mi{constructor(){super(Ws(Qr.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=Ws(Qr.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Yr({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Zr({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(Mi.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Jr extends Vr{constructor(){super(Ws(Jr.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=Ws(Jr.getDefaults(),arguments,["voice","options"]);vs(!Ss(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Vr.getDefaults(),{maxPolyphony:32,options:{},voice:Lr})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}xs("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const s=new Xi(this.context,t).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(t,e,n),this._activeVoices.push({midi:s,voice:i,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new Xi(this.context,t).toMidi(),s=this._activeVoices.find((({midi:t,released:e})=>t===n&&!e));s&&(s.voice.triggerRelease(e),s.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,s){vs(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,s):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,s)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("attack",t,s,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,s){const i=this.toSeconds(n);if(this.triggerAttack(t,i,s),Os(e)){vs(Os(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const s=e[Math.min(n,e.length-1)],r=this.toSeconds(s);vs(r>0,"The duration must be greater than 0"),this.triggerRelease(t[n],i+r)}}else{const n=this.toSeconds(e);vs(n>0,"The duration must be greater than 0"),this.triggerRelease(t,i+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=Hs(t,["onsilence","context"]);return this.options=zs(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Kr extends Vr{constructor(){super(Ws(Kr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Ws(Kr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const s=parseInt(n,10);if(vs(Rs(n)||Ss(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),Rs(n)){const s=new Si(this.context,n).toMidi();e[s]=t.urls[n]}else Ss(s)&&isFinite(s)&&(e[s]=t.urls[s])})),this._buffers=new Hi({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Vr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:ui,onerror:ui,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const s=wi(new Si(this.context,t).toFrequency()),i=Math.round(s),r=s-i,o=this._findClosest(i),a=i-o,c=this._buffers.get(a),u=vi(o+r),l=new rr({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);l.start(e,0,c.duration/u,n),Os(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const t=this._activeSources.get(i),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Si(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;){t.shift().stop(e)}})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,s=1){const i=this.toSeconds(n);return this.triggerAttack(t,i,s),Os(e)?(vs(Os(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const s=e[Math.min(n,e.length-1)];this.triggerRelease(t,i+this.toSeconds(s))}))):this.triggerRelease(t,i+this.toSeconds(e)),this}add(t,e,n){if(vs(Rs(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Rs(t)){const s=new Si(this.context,t).toMidi();this._buffers.add(s,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Ps([Er(0)],Kr.prototype,"attack",void 0),Ps([Er(0)],Kr.prototype,"release",void 0);class to extends Ei{constructor(){super(Ws(to.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Ri("stopped"),this._startOffset=0;const t=Ws(to.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(Ei.getDefaults(),{callback:ui,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Ss(this._loop)&&this._loop>1){e=1/0,Ss(this._loop)&&(e=this._loop*this._getLoopDuration());const s=this._state.getAfter(n);null!==s&&(e=Math.min(e,s.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new $i(this.context,e));const i=new $i(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new $i(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new $i(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=Gs(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;As(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new $i(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new $i(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class eo extends Ei{constructor(){super(Ws(eo.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=Ws(eo.getDefaults(),arguments,["callback","interval"]);this._event=new to({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(Ei.getDefaults(),{interval:"4n",callback:ui,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class no extends Mi{constructor(){super(Object.assign(Ws(no.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Mr({context:this.context}),this.a=new Ni({context:this.context,gain:0}),this.b=new Ni({context:this.context,gain:0}),this.output=new Ni({context:this.context}),this._internalChannels=[this.a,this.b];const t=Ws(no.getDefaults(),arguments,["fade"]);this.fade=new ji({context:this.context,units:"normalRange",value:t.fade}),ai(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Pi(this._split,this.a.gain,0),Pi(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Mi.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class so extends Mi{constructor(t){super(t),this.name="Effect",this._dryWet=new no({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Ni({context:this.context}),this.effectReturn=new Ni({context:this.context}),this.input=new Ni({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],ai(this,"wet")}static getDefaults(){return Object.assign(Mi.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class io extends Mi{constructor(){super(Object.assign(Ws(io.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Ws(io.getDefaults(),arguments,["pan"]);this.pan=new Di({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",ai(this,"pan")}static getDefaults(){return Object.assign(Mi.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}Hr("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class ro extends Mi{constructor(){super(Ws(ro.getDefaults(),arguments,["channels"])),this.name="Split";const t=Ws(ro.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Mi.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class oo extends Mi{constructor(){super(Ws(oo.getDefaults(),arguments,["channels"])),this.name="Merge";const t=Ws(oo.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(Mi.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class ao extends Mi{constructor(t){super(t),this.name="StereoEffect",this.input=new Ni({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new no({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new ro({context:this.context,channels:2}),this._merge=new oo({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),ai(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),Ii(...t),Pi(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),Ii(...t),Pi(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Mi.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class co extends ao{constructor(t){super(t),this.feedback=new ji({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new Ni({context:this.context}),this._feedbackR=new Ni({context:this.context}),this._feedbackSplit=new ro({context:this.context,channels:2}),this._feedbackMerge=new oo({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),ai(this,["feedback"])}static getDefaults(){return Object.assign(ao.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class uo extends co{constructor(){super(Ws(uo.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=Ws(uo.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new Ar({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new Ar({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Gi({context:this.context}),this._delayNodeR=new Gi({context:this.context}),this.frequency=this._lfoL.frequency,ai(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(co.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class lo extends so{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new Ni({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,ai(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(so.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class ho extends lo{constructor(){super(Ws(ho.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=Ws(ho.getDefaults(),arguments,["pitch"]);this._frequency=new ji({context:this.context}),this._delayA=new Gi({maxDelay:1,context:this.context}),this._lfoA=new Ar({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Gi({maxDelay:1,context:this.context}),this._lfoB=new Ar({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new no({context:this.context}),this._crossFadeLFO=new Ar({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Gi({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,ai(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(lo.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=vi(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=vi(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class po extends so{constructor(){super(Ws(po.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=Ws(po.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(so.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){ys(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){ys(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Vs(this,void 0,void 0,(function*(){const t=this.ready,e=new hi(2,this._decay+this._preDelay,this.context.sampleRate),n=new or({context:e}),s=new or({context:e}),i=new oo({context:e});n.connect(i,0,0),s.connect(i,0,1);const r=new Ni({context:e}).toDestination();i.connect(r),n.start(0),s.start(0),r.gain.setValueAtTime(0,0),r.gain.setValueAtTime(1,this._preDelay),r.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(ui),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class fo extends Mi{constructor(){super(Ws(fo.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=Ws(fo.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Ni({context:this.context}),this._split=new ro({context:this.context,channels:t.channels}),this.input.connect(this._split),ys(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(Mi.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){vs("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class mo extends Mi{constructor(){super(Ws(mo.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new fo({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class _o extends mo{constructor(){super(Ws(_o.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=Ws(_o.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new fo({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(mo.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return xs("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map((t=>{const e=t.reduce(((t,e)=>t+e*e),0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:gi(this._rms)}));return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class go extends Mi{constructor(){super(Ws(go.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Ws(go.getDefaults(),arguments,["solo"]);this.input=this.output=new Ni({context:this.context}),go._allSolos.has(this.context)||go._allSolos.set(this.context,new Set),go._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Mi.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),go._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){go._soloed.has(this.context)||go._soloed.set(this.context,new Set),go._soloed.get(this.context).add(this)}_removeSolo(){go._soloed.has(this.context)&&go._soloed.get(this.context).delete(this)}_isSoloed(){return go._soloed.has(this.context)&&go._soloed.get(this.context).has(this)}_noSolos(){return!go._soloed.has(this.context)||go._soloed.has(this.context)&&0===go._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),go._allSolos.get(this.context).delete(this),this._removeSolo(),this}}go._allSolos=new Map,go._soloed=new Map;class vo extends Mi{constructor(){super(Ws(vo.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Ws(vo.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new io({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Ji({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,ai(this,["pan","volume"])}static getDefaults(){return Object.assign(Mi.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class yo extends Mi{constructor(){super(Ws(yo.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Ws(yo.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new go({solo:t.solo,context:this.context}),this._panVol=this.output=new vo({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),ai(this,["pan","volume"])}static getDefaults(){return Object.assign(Mi.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return yo.buses.has(t)||yo.buses.set(t,new Ni({context:this.context})),yo.buses.get(t)}send(t,e=0){const n=this._getBus(t),s=new Ni({context:this.context,units:"decibels",gain:e});return this.connect(s),s.connect(n),s}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}yo.buses=new Map;class bo extends Mi{constructor(){super(...arguments),this.name="Listener",this.positionX=new Di({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Di({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Di({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Di({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Di({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Di({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Di({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Di({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Di({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Mi.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}ei((t=>{t.listener=new bo({context:t})})),si((t=>{t.listener.dispose()}));class wo extends Mi{constructor(){super(Ws(wo.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=Ws(wo.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Di({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new Di({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new Di({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new Di({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new Di({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),ai(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Mi.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class xo extends Mi{constructor(){super(Object.assign(Ws(xo.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=Ws(xo.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new wo({context:this.context,ratio:20,attack:0,release:0,threshold:t.threshold}),this.threshold=this._compressor.threshold,ai(this,"threshold")}static getDefaults(){return Object.assign(Mi.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}function To(){return fi().now()}fi().transport;fi().destination,fi().destination;fi().listener;fi().draw;fi();i(666),i(195);const ko=class{constructor(t,e,n=2){fi().rawContext.suspend(),this.grains=[],this.presets=[],this.isStopped=!1,this.numVoices=n,this.buffer=t,this.nodes=[],this.toneContext=e,this.transport=this.toneContext.transport,this.dest=this.toneContext.destination,this.dest.name="Grainsynth Destination",this.effectsChain=[],this.grainOutput=new Ni(1),this.grainOutput.name="Grain Output",this.filter=new Br(1e4,"lowpass",-24,4),this.compressor=new wo({ratio:20,threshold:-24,release:1,attack:.003}),this.pitchShifter=new ho({pitch:-12});for(let t=0;t<this.numVoices;t++)window.safari?(this.grains[t]=new Dr({url:this.buffer,sampleRate:11025}),this.grains[t].channelCount=1):this.grains[t]=new Dr(this.buffer);this.setupMaster(),this.grains.forEach((async t=>{t.loop=!0,t.connect(this.grainOutput)})),this.grainOutput.connect(this.filter)}getNodes(){Object.entries(this).forEach((t=>{const e=t[1];"object"==typeof e&&e.connect&&console.log(e)}))}debug(){this.grains.forEach((t=>{t.debug=!0,t.playbackRate=1,t.grainSize=.5})),this.setClockFrequency(1)}setupMaster(){this.output=new Ni(1),this.output.name="Output",this.output.gain.setValueAtTime(.7/this.numVoices,To()),this.pitchShifter.windowSize=1,this.filter.connect(this.compressor),window.isMp3?(this.compressor.connect(this.pitchShifter),this.pitchShifter.connect(this.output)):(this.pitchShifter.dispose(),this.compressor.dispose(),this.filter.connect(this.output)),this.output.connect(this.dest)}isGrainLoaded(t){return new Promise(((e,n)=>{t.onerror&&n("couldn't load grains"),t.loaded&&e(t.loaded)}))}async play(t=1){this.transport.start(),this.output.gain.setValueAtTime(1/this.numVoices,To());const e=this.grains.map((t=>this.isGrainLoaded(t)));await Promise.all(e),this.grains.forEach((async(e,n)=>{e.start(`+${n}`,n+t)})),this.isStopped=!1}stop(){this.grains.forEach((t=>{t.stop()})),this.isStopped=!0}kill(){this.grains.forEach((t=>t.dispose()))}chainEffect(t){if(this.effectsChain.push(t),this.effectsChain.length>1){const t=this.effectsChain[0],e=this.effectsChain[this.effectsChain.length-1];this.input.disconnect(),e&&e.disconnect(),this.input.connect(t);for(let t=0;t<this.effectsChain.length-1;t++)this.effectsChain[t].connect(this.effectsChain[t+1]);e.connect(this.dest)}}setClockFrequency(t,e){this.grains.forEach((n=>n._clock.frequency.targetRampTo(t,e)))}detuneLFO(){this.grains.forEach((t=>{const e=new Ar({frequency:Math.random().toFixed(2),max:10,min:-10});e.connect(t.detune),e.start()}))}swellLFO(){this.volumeLFO=new Ar({frequency:Math.random().toFixed(2)/4,max:.5}),this.volumeLFO.connect(this.output.gain),this.volumeLFO.start()}randomStarts(){this.grains.forEach((t=>{t.stop(),t.start(To(),Math.random()*t.buffer.duration)}))}randRange(t,e){return Math.random()*(e-t)+t}randomizeParameters(){const{randRange:t}=this;this.stop(),this.setDetune(t(-100,100)),this.setPitchShift(-12,12),this.setGrainSize(t(.1,1)),this.setOverlap(t(.1,1)),this.setRate(t(-1,2)),this.setVolume(.5),this.play(),this.randomStarts()}getCurrentValues(){const t=[];return["detune","overlap","grainSize","loopStart","loopEnd","playbackRate"].forEach((e=>{t.push(t[e]=this.getGrainValues(e))})),t}setCurrentValues(t){this.grains.forEach(((e,n)=>{e.detune=t.detune[n],e.overlap=t.overlap[n],e.grainSize=t.grainSize[n],e.loopEnd=t.loopEnd[n],e.playbackRate=t.playbackRate[n],e.reverse=Math.random()<.2}))}randArrayFromRange(t,e,n){return Array.from({length:t},(()=>this.randRange(e,n)))}feedbackCombFilter(){this.combFilter=new Qr(.5,.9,1e3),this.chainEffect(this.combFilter)}randomInterpolate(){const t=this.grains.length,e=(this.getCurrentValues(),{detune:this.randArrayFromRange(t,-1e3,100),overlap:this.randArrayFromRange(t,.01,1),grainSize:this.randArrayFromRange(t,.001,.05),playbackRate:this.randArrayFromRange(t,.01,.05),loopEnd:this.randArrayFromRange(t,0,this.grains[0].buffer.duration)});this.setClockFrequency(1*Math.random(),10),this.setCurrentValues(e)}randomLoop(t){this.loop=new eo((()=>{this.randomInterpolate(),this.grains.forEach((t=>{Math.random()<.2?t.stop():t.start(To())}))}),t).start()}setPitchShift(t){this.pitchShifter.pitch=Number(t)}getPitchShift(){return this.pitchShifter.pitch}setDetune(t){const e=t/2;this.grains.forEach((n=>n.detune=Math.random()*t-e))}getDetune(){}getGrainValues(t){const e=[];return this.grains.forEach((n=>{t in n&&e.push(n[t])})),e}setRate(t){this.grains.forEach((e=>e.playbackRate=t))}setOverlap(t){this.grains.forEach((e=>e.overlap=t))}setGrainSize(t){this.grains.forEach((e=>e.grainSize=t))}setLoopStart(t){this.grains.forEach((e=>e.loopStart=t))}setLoopEnd(t){this.grains.forEach((e=>e.loopEnd=t))}setVolume(t){this.output.gain.setValueAtTime(t,this.toneContext.currentTime)}rampVolume(t,e){this.output.gain.rampTo(t,e)}};var So=function(t,e){return(So=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Co(t,e){function n(){this.constructor=t}So(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ao=function(){return(Ao=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Oo(t,e,n,s){return new(n||(n=Promise))((function(i,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((s=s.apply(t,e||[])).next())}))}function Eo(t,e){var n,s,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,s=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],s=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function Ro(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Do(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var s,i,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(s=r.next()).done;)o.push(s.value)}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function Mo(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Do(arguments[e]));return t}function Io(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,i++)s[i]=r[o];return s}var Po=function(t){for(var e=[],n=0,s=0;s<t.length;s++){var i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&s+1<t.length&&56320==(64512&t.charCodeAt(s+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++s)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e};function Vo(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=Vo(t[n],e[n]));return t}var No=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,s){n?e.reject(n):e.resolve(s),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,s))}},t}();function qo(){try{return"[object process]"===Object.prototype.toString.call(i.g.process)}catch(t){return!1}}var Lo=function(t){function e(n,s,i){var r=t.call(this,s)||this;return r.code=n,r.customData=i,r.name="FirebaseError",Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,jo.prototype.create),r}return Co(e,t),e}(Error),jo=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var s=e[0]||{},i=this.service+"/"+t,r=this.errors[t],o=r?Fo(r,s):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new Lo(i,a,s);return c},t}();function Fo(t,e){return t.replace(Bo,(function(t,n){var s=e[n];return null!=s?String(s):"<"+n+"?>"}))}var Bo=/\{\$([^}]+)}/g;function Uo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var s=0;s<16;s++)n[s]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(s=0;s<16;s++)n[s]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(s=16;s<80;s++){var i=n[s-3]^n[s-8]^n[s-14]^n[s-16];n[s]=4294967295&(i<<1|i>>>31)}var r,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(s=0;s<80;s++){s<40?s<20?(r=l^c&(u^l),o=1518500249):(r=c^u^l,o=1859775393):s<60?(r=c&u|l&(c|u),o=2400959708):(r=c^u^l,o=3395469782);i=(a<<5|a>>>27)+r+h+o+n[s]&4294967295;h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,s=0,i=this.buf_,r=this.inbuf_;s<e;){if(0===r)for(;s<=n;)this.compress_(t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(i[r]=t.charCodeAt(s),++s,++r===this.blockSize){this.compress_(i),r=0;break}}else for(;s<e;)if(i[r]=t[s],++s,++r===this.blockSize){this.compress_(i),r=0;break}}this.inbuf_=r,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var s=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[s]=this.chain_[n]>>i&255,++s;return t}}();function zo(t,e){var n=new Wo(t,e);return n.subscribe.bind(n)}var Wo=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var s,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(s=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,s=e;n<s.length;n++){var i=s[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(s.next=Go),void 0===s.error&&(s.error=Go),void 0===s.complete&&(s.complete=Go);var r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?s.error(i.finalError):s.complete()}catch(t){}})),this.observers.push(s),r},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function Go(){}var Ho=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Xo="[DEFAULT]",$o=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=Xo);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new No;this.instancesDeferred.set(e,n);try{var s=this.getOrInitializeService(e);s&&n.resolve(s)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Ao({identifier:Xo,optional:!1},t),n=e.identifier,s=e.optional,i=this.normalizeInstanceIdentifier(n);try{var r=this.getOrInitializeService(i);if(!r){if(s)return null;throw Error("Service "+this.name+" is not available")}return r}catch(t){if(s)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(Xo)}catch(t){}try{for(var s=Ro(this.instancesDeferred.entries()),i=s.next();!i.done;i=s.next()){var r=Do(i.value,2),o=r[0],a=r[1],c=this.normalizeInstanceIdentifier(o);try{var u=this.getOrInitializeService(c);a.resolve(u)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Xo),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Oo(this,void 0,void 0,(function(){var t;return Eo(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Mo(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===Xo?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:Xo:t},t}();var Yo,Zo=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new $o(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function Qo(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var s=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,i++)s[i]=r[o];return s}var Jo,Ko=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Jo||(Jo={}));var ta,ea={debug:Jo.DEBUG,verbose:Jo.VERBOSE,info:Jo.INFO,warn:Jo.WARN,error:Jo.ERROR,silent:Jo.SILENT},na=Jo.INFO,sa=((Yo={})[Jo.DEBUG]="log",Yo[Jo.VERBOSE]="log",Yo[Jo.INFO]="info",Yo[Jo.WARN]="warn",Yo[Jo.ERROR]="error",Yo),ia=function(t,e){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];if(!(e<t.logLevel)){var i=(new Date).toISOString(),r=sa[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[r].apply(console,Qo(["["+i+"]  "+t.name+":"],n))}},ra=function(){function t(t){this.name=t,this._logLevel=na,this._logHandler=ia,this._userLogHandler=null,Ko.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in Jo))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?ea[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Qo([this,Jo.DEBUG],t)),this._logHandler.apply(this,Qo([this,Jo.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Qo([this,Jo.VERBOSE],t)),this._logHandler.apply(this,Qo([this,Jo.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Qo([this,Jo.INFO],t)),this._logHandler.apply(this,Qo([this,Jo.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Qo([this,Jo.WARN],t)),this._logHandler.apply(this,Qo([this,Jo.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Qo([this,Jo.ERROR],t)),this._logHandler.apply(this,Qo([this,Jo.ERROR],t))},t}();function oa(t){Ko.forEach((function(e){e.setLogLevel(t)}))}var aa,ca=((ta={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",ta["bad-app-name"]="Illegal App name: '{$appName}",ta["duplicate-app"]="Firebase App named '{$appName}' already exists",ta["app-deleted"]="Firebase App named '{$appName}' already deleted",ta["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",ta["invalid-log-argument"]="First argument to `onLog` must be null or a function.",ta),ua=new jo("app","Firebase",ca),la="@firebase/app",ha="[DEFAULT]",pa=((aa={})[la]="fire-core",aa["@firebase/analytics"]="fire-analytics",aa["@firebase/auth"]="fire-auth",aa["@firebase/database"]="fire-rtdb",aa["@firebase/functions"]="fire-fn",aa["@firebase/installations"]="fire-iid",aa["@firebase/messaging"]="fire-fcm",aa["@firebase/performance"]="fire-perf",aa["@firebase/remote-config"]="fire-rc",aa["@firebase/storage"]="fire-gcs",aa["@firebase/firestore"]="fire-fst",aa["fire-js"]="fire-js",aa["firebase-wrapper"]="fire-js-all",aa),da=new ra("@firebase/app"),fa=function(){function t(t,e,n){var s,i,r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Vo(void 0,t),this.container=new Zo(e.name),this._addComponent(new Ho("app",(function(){return r}),"PUBLIC"));try{for(var o=Ro(this.firebase_.INTERNAL.components.values()),a=o.next();!a.done;a=o.next()){var c=a.value;this._addComponent(c)}}catch(t){s={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(s)throw s.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=ha),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=ha),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){da.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ua.create("app-deleted",{appName:this.name_})},t}();fa.prototype.name&&fa.prototype.options||fa.prototype.delete||console.log("dc");function ma(t){var e={},n=new Map,s={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var r=i;void 0===r.name&&(r.name=ha);var o=r.name;if("string"!=typeof o||!o)throw ua.create("bad-app-name",{appName:String(o)});if(Uo(e,o))throw ua.create("duplicate-app",{appName:o});var a=new t(n,r,s);return e[o]=a,a},app:i,registerVersion:function(t,e,n){var s,i=null!==(s=pa[t])&&void 0!==s?s:t;n&&(i+="-"+n);var o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&c.push("and"),a&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void da.warn(c.join(" "))}r(new Ho(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:oa,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw ua.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=function(n){var s=null;e&&e.level&&(s=ea[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=s?s:e.logLevel)&&t({level:Jo[n].toLowerCase(),message:o,args:i,type:e.name})}},s=0,i=Ko;s<i.length;s++)n(i[s])}(t,e)},apps:null,SDK_VERSION:"8.0.1",INTERNAL:{registerComponent:r,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(!Uo(e,t=t||ha))throw ua.create("no-app",{appName:t});return e[t]}function r(r){var o,a,c=r.name;if(n.has(c))return da.debug("There were multiple attempts to register component "+c+"."),"PUBLIC"===r.type?s[c]:null;if(n.set(c,r),"PUBLIC"===r.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[c])throw ua.create("invalid-app-argument",{appName:c});return t[c]()};void 0!==r.serviceProps&&Vo(u,r.serviceProps),s[c]=u,t.prototype[c]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,c);return n.apply(this,r.multipleInstances?t:[])}}try{for(var l=Ro(Object.keys(e)),h=l.next();!h.done;h=l.next()){var p=h.value;e[p]._addComponent(r)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return"PUBLIC"===r.type?s[c]:null}return s.default=s,Object.defineProperty(s,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,s}var _a=function t(){var e=ma(fa);return e.INTERNAL=Ao(Ao({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Vo(e,t)},createSubscribe:zo,ErrorFactory:jo,deepExtend:Vo}),e}(),ga=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){da.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var va=self.firebase.SDK_VERSION;va&&va.indexOf("LITE")>=0&&da.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var ya=_a.initializeApp;_a.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qo()&&da.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),ya.apply(void 0,t)};var ba=_a;!function(t,e){t.INTERNAL.registerComponent(new Ho("platform-logger",(function(t){return new ga(t)}),"PRIVATE")),t.registerVersion(la,"0.6.13",e),t.registerVersion("fire-js","")}(ba);const wa=ba;wa.registerVersion("firebase","8.0.2","app");var xa="firebasestorage.googleapis.com",Ta=function(t){function e(n,s){var i=t.call(this,za(n),"Firebase Storage: "+s+" ("+za(n)+")")||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return Co(e,t),e.prototype.codeEquals=function(t){return za(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(Lo),ka="unknown",Sa="object-not-found",Ca="quota-exceeded",Aa="unauthenticated",Oa="unauthorized",Ea="retry-limit-exceeded",Ra="canceled",Da="invalid-url",Ma="invalid-default-bucket",Ia="no-default-bucket",Pa="cannot-slice-blob",Va="server-file-wrong-size",Na="no-download-url",qa="invalid-argument",La="app-deleted",ja="invalid-root-operation",Fa="invalid-format",Ba="internal-error",Ua="unsupported-environment";function za(t){return"storage/"+t}function Wa(){return new Ta(ka,"An unknown error occurred, please check the error payload for server response.")}function Ga(){return new Ta(Ra,"User canceled the upload/download.")}function Ha(){return new Ta(Pa,"Cannot slice blob for upload. Please retry the upload.")}function Xa(t){return new Ta(qa,t)}function $a(){return new Ta(La,"The Firebase app was deleted.")}function Ya(t){return new Ta(ja,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Za(t,e){return new Ta(Fa,"String does not match format '"+t+"': "+e)}function Qa(t){throw new Ta(Ba,"Internal error: "+t)}var Ja={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Ka=function(t,e){this.data=t,this.contentType=e||null};function tc(t,e){switch(t){case Ja.RAW:return new Ka(ec(e));case Ja.BASE64:case Ja.BASE64URL:return new Ka(nc(t,e));case Ja.DATA_URL:return new Ka((n=new sc(e)).base64?nc(Ja.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw Za(Ja.DATA_URL,"Malformed data URL.")}return ec(e)}(n.rest),function(t){return new sc(t).contentType}(e))}var n;throw Wa()}function ec(t){for(var e=[],n=0;n<t.length;n++){var s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|63&s);else if(55296==(64512&s))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))s=65536|(1023&s)<<10|1023&t.charCodeAt(++n),e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|63&s);else e.push(239,191,189);else 56320==(64512&s)?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|63&s)}return new Uint8Array(e)}function nc(t,e){switch(t){case Ja.BASE64:var n=-1!==e.indexOf("-"),s=-1!==e.indexOf("_");if(n||s)throw Za(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Ja.BASE64URL:var i=-1!==e.indexOf("+"),r=-1!==e.indexOf("/");if(i||r)throw Za(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var o;try{o=atob(e)}catch(e){throw Za(t,"Invalid character found")}for(var a=new Uint8Array(o.length),c=0;c<o.length;c++)a[c]=o.charCodeAt(c);return a}var sc=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Za(Ja.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(s=n,i=";base64",s.length>=i.length&&s.substring(s.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var s,i};var ic,rc={STATE_CHANGED:"state_changed"},oc="running",ac="pausing",cc="paused",uc="success",lc="canceling",hc="canceled",pc="error",dc={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function fc(t){switch(t){case oc:case ac:case lc:return dc.RUNNING;case cc:return dc.PAUSED;case uc:return dc.SUCCESS;case hc:return dc.CANCELED;case pc:default:return dc.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(ic||(ic={}));var mc=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ic.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=ic.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=ic.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,s){if(this.sent_)throw Qa("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==s)for(var i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Qa("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Qa("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Qa("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),_c=function(){function t(){}return t.prototype.createXhrIo=function(){return new mc},t}();function gc(t){return"string"==typeof t||t instanceof String}function vc(t){return yc()&&t instanceof Blob}function yc(){return"undefined"!=typeof Blob}function bc(t,e,n,s){if(s<e)throw new Ta(qa,"Invalid value for '"+t+"'. Expected "+e+" or greater.");if(s>n)throw new Ta(qa,"Invalid value for '"+t+"'. Expected "+n+" or less.")}function wc(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function xc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=wc();if(void 0!==n){for(var s=new n,i=0;i<t.length;i++)s.append(t[i]);return s.getBlob()}if(yc())return new Blob(t);throw new Ta(Ua,"This browser doesn't seem to support creating Blobs")}var Tc=function(){function t(t,e){var n=0,s="";vc(t)?(this.data_=t,n=t.size,s=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=s}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(vc(this.data_)){var s=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===s?null:new t(s)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(yc()){var s=e.map((function(e){return e instanceof t?e.data_:e}));return new t(xc.apply(null,s))}var i=e.map((function(t){return gc(t)?tc(Ja.RAW,t).data:t.data_})),r=0;i.forEach((function(t){r+=t.byteLength}));var o=new Uint8Array(r),a=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)o[a++]=t[e]})),new t(o,!0)},t.prototype.uploadData=function(){return this.data_},t}(),kc=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw new Ta(Ma,"Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,s="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+s+"(/(.*))?$","i");function r(t){t.path_=decodeURIComponent(t.path)}for(var o=xa.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+o+"/v[A-Za-z0-9_]+/b/"+s+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:r},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+s+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:r}],c=0;c<a.length;c++){var u=a[c],l=u.regex.exec(e);if(l){var h=l[u.indices.bucket],p=l[u.indices.path];p||(p=""),n=new t(h,p),u.postModify(n);break}}if(null==n)throw function(t){return new Ta(Da,"Invalid URL '"+t+"'.")}(e);return n},t}();function Sc(t){var e,n;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e}function Cc(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Ac(t){return"https://"+xa+"/v0"+t}function Oc(t){var e=encodeURIComponent,n="?";for(var s in t){if(t.hasOwnProperty(s))n=n+(e(s)+"="+e(t[s]))+"&"}return n=n.slice(0,-1)}function Ec(t,e){return e}var Rc=function(t,e,n,s){this.server=t,this.local=e||t,this.writable=!!n,this.xform=s||Ec},Dc=null;function Mc(){if(Dc)return Dc;var t=[];t.push(new Rc("bucket")),t.push(new Rc("generation")),t.push(new Rc("metageneration")),t.push(new Rc("name","fullPath",!0));var e=new Rc("name");e.xform=function(t,e){return function(t){return!gc(t)||t.length<2?t:Cc(t)}(e)},t.push(e);var n=new Rc("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Rc("timeCreated")),t.push(new Rc("updated")),t.push(new Rc("md5Hash",null,!0)),t.push(new Rc("cacheControl",null,!0)),t.push(new Rc("contentDisposition",null,!0)),t.push(new Rc("contentEncoding",null,!0)),t.push(new Rc("contentLanguage",null,!0)),t.push(new Rc("contentType",null,!0)),t.push(new Rc("metadata","customMetadata",!0)),Dc=t}function Ic(t,e,n){for(var s={type:"file"},i=n.length,r=0;r<i;r++){var o=n[r];s[o.local]=o.xform(s,e[o.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,s=t.fullPath,i=new kc(n,s);return e.makeStorageReference(i)}})}(s,t),s}function Pc(t,e,n){var s=Sc(e);return null===s?null:Ic(t,s,n)}function Vc(t,e){for(var n={},s=e.length,i=0;i<s;i++){var r=e[i];r.writable&&(n[r.server]=t[r.local])}return JSON.stringify(n)}function Nc(t,e,n){var s=Sc(n);return null===s?null:function(t,e,n){var s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,r=n.prefixes;i<r.length;i++){var o=r[i].replace(/\/$/,""),a=t.makeStorageReference(new kc(e,o));s.prefixes.push(a)}if(n.items)for(var c=0,u=n.items;c<u.length;c++){var l=u[c];a=t.makeStorageReference(new kc(e,l.name)),s.items.push(a)}return s}(t,e,s)}var qc=function(t,e,n,s){this.url=t,this.method=e,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Lc(t){if(!t)throw Wa()}function jc(t,e){return function(n,s){var i=Pc(t,s,e);return Lc(null!==i),i}}function Fc(t,e){return function(n,s){var i=Pc(t,s,e);return Lc(null!==i),function(t,e){var n=Sc(e);if(null===n)return null;if(!gc(n.downloadTokens))return null;var s=n.downloadTokens;if(0===s.length)return null;var i=encodeURIComponent;return s.split(",").map((function(e){var n=t.bucket,s=t.fullPath;return Ac("/b/"+i(n)+"/o/"+i(s))+Oc({alt:"media",token:e})}))[0]}(i,s)}}function Bc(t){return function(e,n){var s,i,r;return 401===e.getStatus()?s=new Ta(Aa,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(r=t.bucket,s=new Ta(Ca,"Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,s=new Ta(Oa,"User does not have permission to access '"+i+"'.")):s=n,s.serverResponse=n.serverResponse,s}}function Uc(t){var e=Bc(t);return function(n,s){var i,r=e(n,s);return 404===n.getStatus()&&(i=t.path,r=new Ta(Sa,"Object '"+i+"' does not exist.")),r.serverResponse=s.serverResponse,r}}function zc(t,e,n){var s=Ac(e.fullServerUrl()),i=t.maxOperationRetryTime,r=new qc(s,"GET",jc(t,n),i);return r.errorHandler=Uc(e),r}function Wc(t,e,n,s,i){var r={};e.isRoot?r.prefix="":r.prefix=e.path+"/",n&&n.length>0&&(r.delimiter=n),s&&(r.pageToken=s),i&&(r.maxResults=i);var o=Ac(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,c=new qc(o,"GET",function(t,e){return function(n,s){var i=Nc(t,e,s);return Lc(null!==i),i}}(t,e.bucket),a);return c.urlParams=r,c.errorHandler=Bc(e),c}function Gc(t,e,n){var s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),s}var Hc=function(t,e,n,s){this.current=t,this.total=e,this.finalized=!!n,this.metadata=s||null};function Xc(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Lc(!1)}return Lc(!!n&&-1!==(e||["active"]).indexOf(n)),n}var $c=262144;function Yc(t,e,n,s,i,r,o,a){var c=new Hc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw new Ta(Va,"Server recorded incorrect upload file size, please retry the upload.");var u=c.total-c.current,l=u;i>0&&(l=Math.min(l,i));var h=c.current,p=h+l,d={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},f=s.slice(h,p);if(null===f)throw Ha();var m=e.maxUploadRetryTime,_=new qc(n,"POST",(function(t,n){var i,o=Xc(t,["active","final"]),a=c.current+l,u=s.size();return i="final"===o?jc(e,r)(t,n):null,new Hc(a,u,"final"===o,i)}),m);return _.headers=d,_.body=f.uploadData(),_.progressCallback=a||null,_.errorHandler=Bc(t),_}var Zc=function(t,e,n){if("function"==typeof t||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var s=t;this.next=s.next,this.error=s.error,this.complete=s.complete}},Qc=function(t,e,n,s,i,r){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=s,this.task=i,this.ref=r};function Jc(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Kc=function(){function t(t,e,n){var s=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Mc(),this._resumable=this._shouldDoResumable(this._blob),this._state=oc,this._errorHandler=function(t){s._request=void 0,s._chunkMultiplier=1,t.codeEquals(Ra)?(s._needToFetchStatus=!0,s.completeTransitions_()):(s._error=t,s._transition(pc))},this._metadataErrorHandler=function(t){s._request=void 0,t.codeEquals(Ra)?s.completeTransitions_():(s._error=t,s._transition(pc))},this._promise=new Promise((function(t,e){s._resolve=t,s._reject=e,s._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){this._state===oc&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage.getAuthToken().then((function(n){switch(e._state){case oc:t(n);break;case lc:e._transition(hc);break;case ac:e._transition(cc)}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,s,i){var r=e.bucketOnlyServerUrl(),o=Gc(e,s,i),a={name:o.fullPath},c=Ac(r),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":s.size(),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=Vc(o,n),h=t.maxUploadRetryTime,p=new qc(c,"POST",(function(t){var e;Xc(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Lc(!1)}return Lc(gc(e)),e}),h);return p.urlParams=a,p.headers=u,p.body=l,p.errorHandler=Bc(e),p}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),s=t._ref.storage.makeRequest(n,e);t._request=s,s.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var s=function(t,e,n,s){var i=t.maxUploadRetryTime,r=new qc(n,"POST",(function(t){var e=Xc(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Lc(!1)}n||Lc(!1);var i=Number(n);return Lc(!isNaN(i)),new Hc(i,s.size(),"final"===e)}),i);return r.headers={"X-Goog-Upload-Command":"query"},r.errorHandler=Bc(e),r}(t._ref.storage,t._ref._location,e,t._blob),i=t._ref.storage.makeRequest(s,n);t._request=i,i.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=$c*this._chunkMultiplier,n=new Hc(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((function(i){var r;try{r=Yc(t._ref._location,t._ref.storage,s,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition(pc)}var o=t._ref.storage.makeRequest(r,i);t._request=o,o.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition(uc)):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){$c*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=zc(t._ref.storage,t._ref._location,t._mappings),s=t._ref.storage.makeRequest(n,e);t._request=s,s.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition(uc)}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,s,i){var r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;var c=Gc(e,s,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Vc(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=Tc.getBlob(u,s,l);if(null===h)throw Ha();var p={name:c.fullPath},d=Ac(r),f=t.maxUploadRetryTime,m=new qc(d,"POST",jc(t,n),f);return m.urlParams=p,m.headers=o,m.body=h.uploadData(),m.errorHandler=Bc(e),m}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),s=t._ref.storage.makeRequest(n,e);t._request=s,s.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition(uc)}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case lc:case ac:this._state=t,void 0!==this._request&&this._request.cancel();break;case oc:var e=this._state===cc;this._state=t,e&&(this._notifyObservers(),this._start());break;case cc:this._state=t,this._notifyObservers();break;case hc:this._error=Ga(),this._state=t,this._notifyObservers();break;case pc:case uc:this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case ac:this._transition(cc);break;case lc:this._transition(hc);break;case oc:this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=fc(this._state);return new Qc(this._transferred,this._blob.size(),t,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,s){var i=this,r=new Zc(e,n,s);return this._addObserver(r),function(){i._removeObserver(r)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(fc(this._state)){case dc.SUCCESS:Jc(this._resolve.bind(null,this.snapshot))();break;case dc.CANCELED:case dc.ERROR:Jc(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(fc(this._state)){case dc.RUNNING:case dc.PAUSED:t.next&&Jc(t.next.bind(t,this.snapshot))();break;case dc.SUCCESS:t.complete&&Jc(t.complete.bind(t))();break;case dc.CANCELED:case dc.ERROR:t.error&&Jc(t.error.bind(t,this._error))();break;default:t.error&&Jc(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t=this._state===cc||this._state===ac;return t&&this._transition(oc),t},t.prototype.pause=function(){var t=this._state===oc;return t&&this._transition(ac),t},t.prototype.cancel=function(){var t=this._state===oc||this._state===ac;return t&&this._transition(lc),t},t}(),tu=function(){function t(t,e){this._service=t,this._location=e instanceof kc?e:kc.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype.newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new kc(this._location.bucket,"");return this.newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Cc(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new kc(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Ya(t)},t}();function eu(t){var e={prefixes:[],items:[]};return nu(t,e).then((function(){return e}))}function nu(t,e,n){return Oo(this,void 0,void 0,(function(){var s,i,r;return Eo(this,(function(o){switch(o.label){case 0:return[4,su(t,{pageToken:n})];case 1:return s=o.sent(),(i=e.prefixes).push.apply(i,s.prefixes),(r=e.items).push.apply(r,s.items),null==s.nextPageToken?[3,3]:[4,nu(t,e,s.nextPageToken)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function su(t,e){return Oo(this,void 0,void 0,(function(){var n,s,i;return Eo(this,(function(r){switch(r.label){case 0:return null!=e&&"number"==typeof e.maxResults&&bc("options.maxResults",1,1e3,e.maxResults),[4,t.storage.getAuthToken()];case 1:return n=r.sent(),s=e||{},i=Wc(t.storage,t._location,"/",s.pageToken,s.maxResults),[2,t.storage.makeRequest(i,n).getPromise()]}}))}))}function iu(t,e){return Oo(this,void 0,void 0,(function(){var n,s;return Eo(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage.getAuthToken()];case 1:return n=i.sent(),s=function(t,e,n,s){var i=Ac(e.fullServerUrl()),r=Vc(n,s),o=t.maxOperationRetryTime,a=new qc(i,"PATCH",jc(t,s),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=r,a.errorHandler=Uc(e),a}(t.storage,t._location,e,Mc()),[2,t.storage.makeRequest(s,n).getPromise()]}}))}))}function ru(t){return Oo(this,void 0,void 0,(function(){var e,n;return Eo(this,(function(s){switch(s.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage.getAuthToken()];case 1:return e=s.sent(),n=function(t,e,n){var s=Ac(e.fullServerUrl()),i=t.maxOperationRetryTime,r=new qc(s,"GET",Fc(t,n),i);return r.errorHandler=Uc(e),r}(t.storage,t._location,Mc()),[2,t.storage.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new Ta(Na,"The given file does not have any download URLs.");return t}))]}}))}))}function ou(t){return Oo(this,void 0,void 0,(function(){var e,n;return Eo(this,(function(s){switch(s.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage.getAuthToken()];case 1:return e=s.sent(),n=function(t,e){var n=Ac(e.fullServerUrl()),s=t.maxOperationRetryTime,i=new qc(n,"DELETE",(function(t,e){}),s);return i.successCodes=[200,204],i.errorHandler=Uc(e),i}(t.storage,t._location),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}function au(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),s=new kc(t._location.bucket,n);return new tu(t.storage,s)}var cu=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),uu=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new cu(this._delegate.snapshot,this,this._ref)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new cu(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,s){var i=this,r=void 0;return e&&(r="function"==typeof e?function(t){return e(new cu(t,i,i._ref))}:{next:e.next?function(t){return e.next(new cu(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,r,n||void 0,s||void 0)},t}(),lu=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new hu(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new hu(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),hu=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(au(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new uu(function(t,e,n){return void 0===n&&(n=null),t._throwIfRoot("uploadBytesResumable"),new Kc(t,new Tc(e),n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){return void 0===e&&(e=Ja.RAW),this._throwIfRoot("putString"),new uu(function(t,e,n,s){void 0===n&&(n=Ja.RAW),t._throwIfRoot("putString");var i=tc(n,e),r=Ao({},s);return null==r.contentType&&null!=i.contentType&&(r.contentType=i.contentType),new Kc(t,new Tc(i.data,!0),r)}(this._delegate,t,e,n),this)},t.prototype.listAll=function(){var t=this;return eu(this._delegate).then((function(e){return new lu(e,t.storage)}))},t.prototype.list=function(t){var e=this;return su(this._delegate,t).then((function(t){return new lu(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return Oo(this,void 0,void 0,(function(){var e,n;return Eo(this,(function(s){switch(s.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage.getAuthToken()];case 1:return e=s.sent(),n=zc(t.storage,t._location,Mc()),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}(this._delegate)},t.prototype.updateMetadata=function(t){return iu(this._delegate,t)},t.prototype.getDownloadURL=function(){return ru(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),ou(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Ya(t)},t}(),pu=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();var du=function(){function t(t,e,n,s,i,r,o,a,c,u,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=s,this.successCodes_=i.slice(),this.additionalRetryCodes_=r.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var s,i=t.resolve_,r=t.reject_,o=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(o,o.getResponseText());void 0!==a?i(a):i()}catch(t){r(t)}else null!==o?((s=Wa()).serverResponse=o.getResponseText(),t.errorCallback_?r(t.errorCallback_(o,s)):r(s)):n.canceled?r(s=t.appDelete_?$a():Ga()):r(s=new Ta(Ea,"Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new fu(!1,null,!0)):this.backoffId_=function(t,e,n){var s=1,i=null,r=!1,o=0;function a(){return 2===o}var c=!1;function u(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];c||(c=!0,e.apply(null,t))}function l(e){i=setTimeout((function(){i=null,t(h,a())}),e)}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)u.call.apply(u,Io([null,t],e));else{var i;a()||r?u.call.apply(u,Io([null,t],e)):(s<64&&(s*=2),1===o?(o=2,i=0):i=1e3*(s+Math.random()),l(i))}}var p=!1;function d(t){p||(p=!0,c||(null!==i?(t||(o=2),clearTimeout(i),l(0)):t||(o=1)))}return l(0),setTimeout((function(){r=!0,d(!0)}),n),d}((function(e,n){if(n)e(!1,new fu(!1,null,!0));else{var s=t.pool_.createXhrIo();t.pendingXhr_=s,null!==t.progressCallback_&&s.addUploadProgressListener(i),s.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var s=(n=n).getErrorCode()===ic.NO_ERROR,r=n.getStatus();if(s&&!t.isRetryStatusCode_(r)){var o=-1!==t.successCodes_.indexOf(r);e(!0,new fu(o,n))}else{var a=n.getErrorCode()===ic.ABORT;e(!1,new fu(!1,null,a))}}))}function i(e){var n=e.loaded,s=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,s)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),s=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||s},t}(),fu=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function mu(t,e,n,s){var i=Oc(t.urlParams),r=t.url+i,o=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(o,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(o,n),function(t){var e=void 0!==wa?wa.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new du(r,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s)}function _u(t){return/^[A-Za-z]+:\/\//.test(t)}function gu(t,e){if(t instanceof wu){var n=t;if(null==n._bucket)throw new Ta(Ia,"No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var s=new tu(n,n._bucket);return null!=e?gu(s,e):s}if(void 0!==e){if(e.includes(".."))throw Xa('`path` param cannot contain ".."');return au(t,e)}return t}function vu(t,e){if(e&&_u(e)){if(t instanceof wu)return new tu(t,e);throw Xa("To use ref(service, url), the first argument must be a Storage instance.")}return gu(t,e)}var yu,bu,wu=function(){function t(t,e,n,s){var i,r;this.app=t,this._authProvider=e,this._pool=n,this._url=s,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=s?kc.makeFromBucketSpec(s):(i=this.app.options,null==(r=null==i?void 0:i.storageBucket)?null:kc.makeFromBucketSpec(r))}return Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){bc("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){bc("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype.getAuthToken=function(){return Oo(this,void 0,void 0,(function(){var t,e;return Eo(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype.makeStorageReference=function(t){return new tu(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this._deleted)return new pu($a());var s=mu(t,this._appId,e,this._pool);return this._requests.add(s),s.getPromise().then((function(){return n._requests.delete(s)}),(function(){return n._requests.delete(s)})),s},t}(),xu=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(_u(t))throw Xa("ref() expected a child path but got a URL, use refFromURL instead.");return new hu(vu(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!_u(t))throw Xa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{kc.makeFromUrl(t)}catch(t){throw Xa("refFromUrl() expected a valid full URL but got an invalid one.")}return new hu(vu(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t}();function Tu(t,e){var n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal");return new xu(n,new wu(n,s,new _c,e))}bu={TaskState:dc,TaskEvent:rc,StringFormat:Ja,Storage:wu,Reference:hu},(yu=wa).INTERNAL.registerComponent(new Ho("storage",Tu,"PUBLIC").setServiceProps(bu).setMultipleInstances(!0)),yu.registerVersion("@firebase/storage","0.4.2");var ku=i(877);const Su=class{constructor(t,e="audio/mpeg-3"){this.firebaseConfig={apiKey:"AIzaSyAbb8-7skMg99nzAlvUaqR6vfQvD7q_7Vs",authDomain:"test-a201f.firebaseapp.com",databaseURL:"https://test-a201f.firebaseio.com",projectId:"test-a201f",storageBucket:"test-a201f.appspot.com",messagingSenderId:"120555329679",appId:"1:120555329679:web:a8734f69a5da95480df8fa",measurementId:"G-QLSEEEE02P"},this.suffix="audio/mpeg-3"===e?"mp3":"aac",wa.initializeApp(this.firebaseConfig),this.audioCtx=t,this.storage=wa.storage(),this.storageRef=this.storage.ref(),this.audioRef=this.storageRef.child(`audio-${(0,ku.v4)()}.${this.suffix}`)}async listAll(){this.files=await this.storageRef.listAll()}async getRandomSample(){const t=this.files.items[~~(Math.random()*this.files.items.length)];this.audioFile=await t.getDownloadURL()}async downloadSample(t){return fetch(t,{cors:"opaque"}).then((t=>t.arrayBuffer())).then((t=>this.audioCtx.decodeAudioData(t))).catch((t=>console.log(t)))}async uploadSample(t){console.log(t),this.uploadTask=this.audioRef.put(t,{contentType:t.type}),this.uploadTask.on("state_changed",(t=>{this.progress=t.bytesTransferred/t.totalBytes*100,wa.storage.TaskState.RUNNING}),(t=>{}),(()=>{this.uploadTask.snapshot.ref.getDownloadURL().then((function(t){console.log("File available at",t)}))}))}};const Cu=class{constructor(t=800,e){this.length=t,this.audioCtx=e}async getPermissions(){return new Promise((async(t,e)=>{try{const e=navigator.mediaCapabilities.decodingInfo({type:"file",audio:{contentType:"audio/mp3"}}).then((t=>t.supported));!0===await e?this.type="audio/mpeg-3":this.type="audio/aac";const n=await navigator.mediaDevices.getUserMedia({audio:!0});this.stream=n,t(n)}catch(t){return console.log(t),!1}}))}async recordChunks(){return new Promise(((t,e)=>{this.recording=!0,this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.start(),this.audioChunks=[],this.mediaRecorder.addEventListener("dataavailable",(e=>{this.audioChunks.push(e.data),t(!0)}))}))}async stopRecording(){return new Promise(((t,e)=>{this.mediaRecorder.stop(),this.recording=!1,this.mediaRecorder.addEventListener("stop",(()=>{this.audioBlob=new Blob(this.audioChunks,{type:this.type}),this.audioUrl=URL.createObjectURL(this.audioBlob),t(this.audioBlob)}))}))}readBlobAsArrayBuffer(t){const e=new FileReader;return new Promise(((n,s)=>{e.onerror=()=>{e.abort(),s(new DOMException("Problem parsing input file."))},e.onload=()=>{n(e.result)},e.readAsArrayBuffer(t)}))}async loadToBuffer(t){if(!this.recording){const e=await this.readBlobAsArrayBuffer(t);let n;this.arrayBuffer=e,console.log(this.arrayBuffer);try{n=await this.audioCtx.decodeAudioData(this.arrayBuffer)}catch(t){n=this.audioContext.decodeAudioData((t=>(console.log(t),t)))}return new Promise(((t,e)=>{try{t(n),this.decodedBuffer=n}catch(t){e(t)}}))}}createSource(t){let e=this.audioCtx.createBufferSource();return e.buffer=t,e}};const Au=class{constructor(t){this.input=new Ni(.8),this.limiter=new xo(-12),this.effectsChain=[],this.ctx=t,this.output=new Ni(1),this.dest=this.ctx.destination,window.isMp3&&this.chainEffect(this.limiter)}test(){var t=this.ctx.createOscillator();t.frequency.setValueAtTime(440,this.ctx.currentTime),t.connect(this.output),t.start()}setVolume(t){this.output.gain.setValueAtTime(t,this.ctx.getCurrentTime)}connectSource(t){try{return this.source=t,t.connect(this.input),!0}catch(t){return!1}}chorus(t=.1,e=20,n=.9){this.chorus=new uo(t,e,n).start(),this.chainEffect(this.chorus)}chainEffect(t){if(this.effectsChain.push(t),this.effectsChain.length>1){const t=this.effectsChain[0],e=this.effectsChain[this.effectsChain.length-1];this.input.disconnect(),e&&e.disconnect(),this.input.connect(t);for(let t=0;t<this.effectsChain.length-1;t++)this.effectsChain[t].connect(this.effectsChain[t+1]);e.toDestination()}else this.input.connect(this.effectsChain[0]).connect(this.dest)}removeEffect(t){this.output.disconnect(t),this.output.connect(this.dest)}lowpassFilter(t,e){this.filter=new Br(t,"lowpass",-24,e),this.chainEffect(this.filter)}delay(t=100,e=.5){this.masterDelay=new Gi(t,e),this.chainEffect(this.masterDelay)}async reverb(t,e=.3,n=4,s=1){t?(this.masterReverb=new po({preDelay:e,decay:n,wet:s}),await this.masterReverb.generate(),this.chainEffect(this.masterReverb)):this.masterReverb&&this.removeEffect(this.masterReverb)}disconnect(){this.dest.disconnect()}};const Ou=class{constructor(t){this.randomValues=[...Array(20)].map((()=>Math.floor(12*Math.random()))),this.ctx=t,this.uiSynth=new Jr({polyphony:1,voice:Ur,maxPolyphony:3}),this.uiSynth.set({envelope:{attack:0,decay:.1,release:.5},harmonicity:2,volume:2}),this.idx=0,this.master=new Ni(.1),this.uiSynth.connect(this.master),this.uiSynth.unsync()}play(t){this.idx++,this.uiSynth.set({harmonicity:this.randomValues[this.idx%this.randomValues.length]}),this.uiSynth.set({modulationIndex:this.randomValues[this.idx%this.randomValues.length]});try{t.forEach((t=>{var e,n;this.uiSynth.triggerAttackRelease((e=t,new Si(fi(),e,n)).harmonize([0,3,7,11,13]),0)}))}catch(t){this.uiSynth.releaseAll()}}};async function Eu(t,e,n="audio/mpeg-3"){return fetch(t).then((t=>t.arrayBuffer())).then((t=>e.decodeAudioData(t))).catch((t=>console.log(t)))}async function Ru(t,e){return new Promise((async(t,n)=>{try{i.e(823).then(i.bind(i,823)).then((async n=>{const s=await fetch(n.default,{mimeType:"audio/aac"}),i=await s.arrayBuffer(),r=await Wn(e._context._nativeContext,i);console.log(r),t(r)}))}catch(t){n(t)}}))}function Du(t,e){let n;return function(...s){n&&clearTimeout(n),n=setTimeout((()=>{t(...s)}),e)}}function Mu(t,e,n,s,i){return(t-e)*(i-s)/(n-e)+s}function Iu(t,e){return new Promise((async(n,s)=>{let i;"number"!=typeof e&&e<=0&&s("Samplerate is not a number"),t||s("Input buffer is undefined"),i=typeof t.sampleRate===Number?t.sampleRate/e:44100/e;let r=t.length*i,o=new ds(t.numberOfChannels,r,e),a=o.createBufferSource();const c=o.createGain();c.gain.value=function(t){for(var e=t.getChannelData(0),n=Math.floor(.05*t.sampleRate),s=[],i=0,r=0;r<e.length;r++)i+=e[r]**2,r%n==0&&(i=Math.sqrt(i/n),s.push(i),i=0);s.sort((function(t,e){return t-e}));var o=1/s[Math.floor(.95*s.length)];return o=Math.max(o,.02),(o=Math.min(o,100))/10}(t),console.log(c.gain.value),a.buffer=t,a.connect(c),c.connect(o.destination),a.start(0);try{n(await o.startRendering())}catch(t){s(t)}}))}function Pu(t){return t[Math.floor(Math.random()*t.length)]}function Vu(t){window.logging&&console.log(`%cSound: ${t}`,"color:#233E82; font-family:'Arial';color:white; font-weight: 500; background:black;")}function Nu(t){return!!t.getChannelData&&(console.log(t.getChannelData(0).length),t.getChannelData(0).length<65536&&(Math.max(...t.getChannelData(0))>0||void 0))}fi().rawContext.suspend(),window.debounce=Du;const qu=window.innerWidth<600;let Lu,ju;window.safari=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),window.safari&&function(t){t=new Audio,Vu(soundtrackAudioCtx),window.webkitAudioContext&&setContext(new webkitAudioContext(audioOpts)),window.OfflineAudioContext=window.webkitOfflineAudioContext,i.e(785).then(i.bind(i,785)).then((t=>{window.MediaRecorder=t.default})),window.addEventListener("touchstart",(()=>{t.autoplay=!0,t.muted=!1})),Vu("loaded MediaRecorder polyfill for safari")}(ju);let Fu=navigator.userAgent.includes("iPhone"),Bu=navigator.mediaCapabilities.decodingInfo({type:"file",audio:{contentType:"audio/mp3"}}).then((function(t){return t.supported})),Uu=!1,zu=qu?1:3,Wu=0,Gu=null;window.recordingLimitReached=!1,window.recording=!1,window.isMuted=!0,window.logging=!1;let Hu=new oi({latencyHint:"playback",updateInterval:1,lookAhead:1,bufferSize:4096,state:"suspended"}),Xu=0,$u=11025;Hu.name="Playback Context";const Yu=async()=>{void 0===Lu&&i.e(865).then(i.bind(i,945)).then((t=>{Lu=t.default,ju.load(),ju.src=Lu,ju.loop=!0,ju.addEventListener("loadedmetadata",(()=>{sl.classList="",sl.classList.add("fa-volume-off"),ju.muted=!1,sl.classList.add("fa","fa-volume-off"),cl(),window.synthsLoaded=!0})),ju.addEventListener("onended",(()=>{ju.currentTime=0}))}))};let Zu;mi(Hu);let Qu=[];window.synthsLoaded=!1;const Ju=new Ou(Hu);let Ku=new Su(Hu);let tl=new Cu(1e3,Hu),el=qu?1:3,nl=qu?2:3;const sl=document.querySelector("#mute"),il=document.querySelector("#play");let rl;il.addEventListener("click",(()=>{(async()=>{Vu("attempting to start audio"),await Hu.rawContext.resume(),await _i(),window.isSoundStarted=!0,Vu("Audio context is: "+Hu.rawContext.state),Vu("Asking for microphone permissions"),await tl.getPermissions()})(),il.style.display="none",sl.style.display="inline-block"})),sl.onclick=async()=>{Xu++,window.isMuted=!window.window.isMuted,(window.safari||Fu)&&(ju.muted=window.isMuted,Hu.muted=window.isMuted,1===Xu&&(Ju.master.toDestination(),Hu.resume(),ju.play())),ml(window.isMuted),window.synthsLoaded&&(window.isMuted?dl():1===Xu?ul():fl())};const ol=async(t=null)=>{const e=await Bu;if(t){if(t&&Nu(t)>0){const e=await Iu(t,$u);Qu.forEach((n=>{n.buffer.copyToChannel(e.getChannelData(0),0,0),n.setLoopStart(0),n.randomInterpolate(),t=null}))}}else Qu.forEach((async t=>{let n,s;if(await Ku.getRandomSample(),e){let e;n=await Eu(Ku.audioFile,Hu),Vu(n),Nu(n)>0?(e=n,Vu("clip is not silent, continuing")):(await Ku.getRandomSample(),n=await Eu(Ku.audioFile,Hu),e=n);try{const t=await Iu(e,$u);s=removeZeroValues(t.getChannelData(0))}catch(t){Vu("reverting to original buffer"),s=n.getChannelData(0)}t.buffer.copyToChannel(s,0,0)}else Vu("can't reload buffers on this browser");t.randomInterpolate(),Vu("reloaded buffers")}))};let al=0;window.addEventListener("radius_reached",(()=>{al++;const t=Du(ol,1e3);al%20==0&&t()}));const cl=()=>{window.addEventListener("pixel_added",(t=>{const{pixelX:e,pixelY:n}=t.data;Vu("pixel added"),!window.isMuted&&Ju.play([e,window.height-n])}))};window.addEventListener("down",(async()=>{Uu||(Uu=await tl.getPermissions(),Vu(`user has ${Uu?"":"not"} allowed recording.`)),!window.isMuted&&Uu&&(Wu++,Wu>zu&&(window.recordingLimitReached=!0),window.recordingLimitReached?Vu("user recording limit reached"):(async()=>{new Promise((async(t,e)=>{if(window.MediaRecorder&&Uu)try{Vu("started user recording #"+Wu),window.recording=!0,await tl.recordChunks(),t(!0)}catch(t){Vu(t),e(!1)}else window.recording=!1,ju.play(),Vu("media recording is not supported in this browser")}))})())})),window.addEventListener("released",(()=>{window.isMuted||(window.recordingLimitReached||setTimeout((()=>{(async()=>{if(tl.recording&&Uu){const t=await tl.stopRecording();try{Gu=await tl.loadToBuffer(t)}catch(t){Vu(t)}ol(Gu),Ku.uploadSample(tl.audioBlob),Vu("stopped user recording #"+Wu),window.recording=!1}else window.recording=!1})()}),100),Vu("mouse is released"))}));window.meter=new _o;const ul=async()=>{window.isMuted||(await _i(),await Hu.resume(),Zu=new Au(Hu),Zu.connectSource(Ju.master),Qu.forEach((async(t,e)=>{await t.isGrainLoaded(t.grains[t.grains.length-1]),Vu(t),t.isStopped||(!qu&&t.grains.forEach((t=>t.volume.value=1)),t.grainOutput.gain.value=1/el,t.filter.type="lowpass",t.filter.frequency.value=880*(e+1),t.setDetune(220*(e+1)-440*el),t.setPitchShift(-12/(e+1)),t.filter.frequency.value<500?t.filter.Q.value=2:t.filter.Q.value=.5,t.randomInterpolate(),t.play(Hu.currentTime+.05*e),t.output.disconnect(t.dest),Zu.connectSource(t.output))})),(()=>{rl=new vr({frequency:40,harmonicity:.5,detune:0}),rl.filter=new Br,rl.connect(rl.filter);const t=new or({type:"pink",volume:-14});t.connect(rl.filter),Zu.connectSource(rl.filter),rl.volume.value=-48,rl.volume.targetRampTo(-24,10),rl.filter.frequency.value=60,rl.filter.gain.value=10,t.start("+1"),rl.start("+1")})(),Zu.lowpassFilter(5e3,1),window.isMp3&&Zu.chorus(.01,300,.9),!qu&&window.isMp3&&Zu.reverb(!0,.3,4,.7),ll(),hl(),window.masterBus=Zu),"closed"===Hu.state&&(Vu("audio context is closed by user gesture, restarting"),await Hu.rawContext.resume())},ll=()=>{try{Qu[0].transport.scheduleRepeat((t=>{pl()}),10)}catch(t){Vu(t)}},hl=()=>{Qu[0].transport&&Qu[0].transport.scheduleRepeat((t=>{rl.detune.rampTo(Mu(Math.random(),0,1,-100,100),30),rl.harmonicity.rampTo(Mu(Math.random(),0,1,.5,2),30)}),30)},pl=()=>{try{if(ps&&ps.particles){let{radius:t,maxradius:e}=ps.particles[ps.particles.length-1];Qu.forEach(((n,s)=>{n.setDetune(Mu(t,0,e,-1e3,.05));let i=(s+1)*Mu(t,0,e,440,880);!qu&&n.filter.frequency.rampTo(i,10)})),rl.filter.frequency.rampTo(Mu(~~t,0,~~e,50,200),10)}}catch(t){console.warn("particle system not defined, threw error"+t)}},dl=()=>{"running"===Hu.state&&Hu.rawContext.suspend()},fl=()=>{Hu.rawContext.resume()},ml=t=>{t?(sl.classList.add("fa-volume-off"),sl.classList.remove("fa-volume-up")):(sl.classList.remove("fa-volume-off"),sl.classList.add("fa-volume-up"))};(async()=>{if(Bu=await Bu,Bu||(Ku.suffix="aac",el=1,nl=1),Fu)Yu();else try{window.isMp3=Bu,await Hu.rawContext.resume(),await(async()=>new Promise((async(t,e)=>{await Ku.listAll();const n=await Bu;n||(el=1,nl=1),Vu(`mp3 is ${n?"":"not "}supported in this browser`);for(let t=0;t<el;t++){let e,s,i;if(await Ku.getRandomSample(),n?(e=await Eu(await Pu(Ku.files.items).getDownloadURL(),Hu),e&&Nu(e)>0?(s=e,Vu("clip is not silent, continuing")):(Vu("clip is silent: reloading"),e=await Eu(await Pu(Ku.files.items).getDownloadURL(),Hu),Vu(e),s=e)):(e=await Ru(Ku.audioFile,Hu),s=e),s){if(window.OfflineAudioContext)try{i=await Iu(s,$u),i=removeZeroValues(i)}catch(t){i=s}else i=s;Qu.push(new ko(i,Hu,nl)),window.synths=Qu,Vu("Loaded GrainSynth "+(t+1))}}window.synthsLoaded=!0,sl.classList=[],sl.classList.add("fa","fa-volume-off"),sl.disabled=!1,Vu("Voices loaded"),t(!0)})))(),cl()}catch(t){Yu()}})()})()})();